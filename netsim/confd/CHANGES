ConfD-7.7.1 [January 21, 2022]
==============================
Security:

  - java-api: Security fix. This vulnerability affects ConfD releases 7.3
    and later.

    (ENG-28001)

Enhancements:

  - cli: The turboparser now supports the confd.conf option
    enableLoadMergeLeafList. If this option is turned on, the turboparser
    will not remove keys from leaf-lists prior to adding new keys. Thus, the
    old and new data will merged.

    (ENG-22954)

  - cs_trans: Skip evaluating "when" expression for a leaf without a default
    value when a parent node is created, since the leaf does not have a
    value yet.

    (ENG-28019)

  - java-api: log4j has been upgraded to version 2.17.1

    (ENG-28036, CSCwa54664, CSCwa54674)

  - observability: The "confd --debug-dump <File>" command now supports
    additional options:
    (1) --collect-timeout <seconds> to provide the desired timeout when
    system collects internal data. The default timeout is 10 seconds.
    (2) --compress to compress the debug dump to File.gz.
    Additionally, if a timeout is reached, ConfD will inform the client with
    the following message:
    *** Failed to collect <type>: timeout

    (ENG-27926, RT:47738, PS-42861, SR:692398999)

Corrections:

  - confd: The turbo parser can now handle leafs marked as deprecated within
    choices by not assuming they are candidates for data processing.

    (ENG-27153, RT:47184, PS-42304)

  - confd: Fixed incorrect change-set handling that would sometimes lead to
    schema violations in the write-ahead log. This caused data nodes to
    appear in the tree with the wrong schema or new nodes being created
    during delete operations.

    (ENG-26915, RT:47668, RT:47442, RT:45996, PS-42790, PS-42563, PS-41113)

  - confd: Filtering progress trace events based only on context or user did
    not work correctly.

    (ENG-26901, RT:46498, PS-41612, CSCvy73354, SR:691550999)

  - candidate: Fixed wrongly removing inactive attribute when committing
    candidate configuration.

    (ENG-27710)

  - cdb: Corrected set_case() callback in operational datastore when
    applying nested 'choice' statements.

    (ENG-24931)

  - cdb-capi: A close event from a CDB subscriber socket while processing
    cdb_oper write requests is now handled properly instead of restarting
    ConfD.

    (ENG-27531, RT:47665, PS-42787, CSCwa00963)

  - cdb-capi: cdb_get_txid() wrongly returned 'Unknown CDB operation' on a
    CDB session which was established at the prepare stage for a read-write
    transaction. The CDB has been updated and will now correctly return the
    transaction ID.

    (ENG-25840, RT:45363, PS-40477, CSCvx61089)

  - cli: Corrected the mechanism that triggers the reallocation of the
    operational mode transaction after a CLI command executes and the
    `reallocateOperTrans` flag is set to true. Unneeded double reallocation
    of the operational mode transaction was eliminated.

    (ENG-27839, RT:48063, PS-43178, CSCwa34528)

  - cli: ConfD would exit abnormally during upgrade procedure under the
    condition that a CLI config session happened to be in a submode during
    the commit, the candidate database is enabled, and running database
    access is set as 'writable-through-candidate'.

    (ENG-27803, RT:48021, PS-43136, CSCwa33159)

  - cli: When traversing the command line to execute, the candidate node
    matching algorithm used prefixes even when it was not required. This
    resulted in syntax errors when the command did not include a prefix, and
    has been corrected.

    (ENG-27723, RT:47882, PS-42994, CSCwa21504)

  - cli: It's now possible to remove the `no-confirm` parameter of the
    config/configure command through clispec modifications of operational
    mode.
    Each parameter of the config/configure to be deleted needs to be
    provided in a separate delete element, so to delete `no-confirm` of the
    config command on C-style CLIs only `<delete src="config no-confirm" />`
    is accepted.

    (ENG-19052, RT:35577, RT:33651, PS-30651, PS-28994)

  - cs_trans: Fixed "when" expression not evaluating if it depends on a leaf
    with a default value, the leaf is removed, then set to the old value
    again in the same transaction.

    (ENG-27931)

  - cs_trans: Corrected a fatal "bad dependency" error occurring with a
    "must" expression on a leaf-list that refers to a list node ancestor.

    (ENG-27917, RT:48094, PS-43209, CSCwa40711)

  - cs_trans: In a nested choice node, the subscription notification for the
    default leaf under nested default case was missing when deleting the
    non-default leaf in the same choice. Now, the subscription notification
    will be present for the default leaf under nested default case when
    deleting the non-default leaf in the same choice.

    (ENG-27123, RT:47119, PS-42238, CSCvz42203)

  - ha: Removed a race condition when pending rollback files where aborted
    and deleted just before HA tried to distribute the file to the
    secondaries. The race condition resulted in an enoent - file not found
    error.

    (ENG-27882)

  - netconf: If the NETCONF Event Notifications capability is not enabled,
    ConfD will not setup event streams that are configured in the confd.conf
    file. The NETCONF Event Notifications capability can be enabled via
    confdConfig/netconf/capabilities/notification/enabled.

    (ENG-27754)

  - netconf: Filter from NETCONF notification modify-subscription operation
    was not propagated into the monitor structure /sn:subscriptions. Now the
    filter is properly stored for a modify-subscription request and can be
    read from /sn:subscriptions afterwards.

    (ENG-27610, RT:47752, PS-42875, CSCwa09847, SR:692301317)

  - netconf: An ongoing NETCONF notification establish-subscription, that
    was abruptly terminated by killing the user session, sometimes resulted
    in a zombie subscription being left in the monitor model
    /sn:subscriptions in the CDB. A following attempt of an
    establish-subscription would fail due to clash with the leftover zombie
    subscription.
    To avoid zombie subscriptions in /sn:subscriptions, an internal data
    provider (DP) now handles client reads from /sn:subscriptions. The DP
    also protects /sn:subscriptions from being written to by clients, as
    only dynamic subscriptions are supported.

    (ENG-27115, RT:46541, PS-41655, CSCvz39935)

  - netconf: Add status for the running database in netconf-state, as well
    as the corresponding set_running_status and get_running_status commands
    for the confd_cmd utility.
    Change of the status is logged in the developer log.

    (ENG-26042, RT:45616, PS-40734, CSCvx84625)

  - restconf: When using Yang-Patch with JSON payloads, the order in which
    list keys are presented is now truly irrelevant.

    (ENG-27423, RT:47554, PS-42675, CSCvz86603, SR:692230863)

  - toolchain: The turbo parser will not delete pre-existing data when
    parsing a line where the data nodes might be tested but later turns out
    to not be applicable for the current line.

    (ENG-27279, RT:47355, PS-42476, CSCvz66055)

  - upgrade: The upgrade process incorrectly handled an operational node
    with 'tailf:persistent true' statement being changed to
    'tailf:persistent false' and, therefore, a system restart did not clear
    the node's value in the datastore. The upgrade process has been fixed
    and the node will be removed after system restart.

    (ENG-27180, RT:45088, PS-40201, CSCvz52132)

  - upgrade: Corrected upgrade of leaf-lists with enumeration type.

    (ENG-26209, RT:45813, PS-40928, CSCvy00034)

  - xpath: The validation code could not find a leaf-list when referred to
    from a leafref. The filter code used for validation has been changed to
    fix this.

    (ENG-27907, RT:48106, RT:48107, PS-43221, PS-43222, CSCwa39014)

ConfD-7.7 [December 15, 2021]
=============================

Removals:

  - python-api: Changed minimum supported Python version from 3.5 to 3.7.

    (ENG-24808)

Security:

  - java-api: Security fix. This vulnerability affects ConfD releases 7.3
    and later, if Java-API is used.
    ConfD's Java api does not use log4j's Mapped Diagnostic Context (MDC).
    If your code does use it, you might be exposed to CVE-2021-45046.

    (ENG-27982, RT:48182, PS-43299, CSCwa48390)

Non-backwards compatible enhancements:

  - confd: Progress trace now includes trace-id (where available) when
    /confdConfig/traceId is set to 'true'. See confd.conf(5) man page on how
    to enable traceId.

    (ENG-23948)

  - ha: A node that joins a HA cluster as a secondary node will no longer
    trigger state replication of snapshot DB and configurational datastore
    if the state is the same on primary and secondary. This may cause
    different nodes temporarily to have different last transaction ids on
    snapshot and configuration datastore which is a non-compatible change.
    This optimization avoids having unnecessary replication after nodes
    upgrade on the HA cluster.

    (ENG-27411)

  - logging: The format of one log in devel.log is as following
    <severity> <timestamp> <hostname> <app_name>[<proc_id>]: <message>
    In which, the <proc-id> is the Erlang emulator PID, which is not very
    useful when debugging. The <proc-id> has been changed to Erlang process
    PIDs.

    (ENG-27237)

Non-backwards compatible corrections:

  - confd: Reading the path /netconf-state/streams/stream/subscriber now
    shows both subscriber id and session id. This changes the subscriber
    list key from "session-id" to "id".

    (ENG-25453, RT:44776, PS-39887, CSCvw88298)

  - cli: It was possible to execute an action even though NACM read access
    was denied for the non-presence container ancestors to the action. This
    has been fixed so that when executing an action, or auto-completing the
    path to an action, read access is now required for all ancestors to the
    action regardless of their types.

    (ENG-27067, RT:44466, PS-39574, CSCvz32166, SR:690147395)

  - yanger: The compiler will return an error when a tailf:link's target is
    under a tailf:mount-point or yangmnt:mount-point. Previously there would
    be an error at run-time. The issue will now be caught by yanger at
    compile time.

    (ENG-27571, RT:47678, PS-42800, CSCwa06951, SR:692198252)

Enhancements:

  - confd: Prepared the low-level memory management in CDB and changeset
    storage for increased parallelism. Enable potential future core
    improvements.

    (ENG-27258)

  - cdb: Improved performance of startup, compaction, and cdb upgrade times
    through disk I/O access optimizations. If upgrading to ConfD-7.7 from an
    older version, it is recommended to have cdb files compacted before on
    the older version of the product. The command 'confd --cdb-compact
    Directory' can be used for compaction.

    (ENG-27104)

  - cdb: CDB API and MAAPI are extended to delete metadata attributes on
    operational config data in CDB oper. For example using MAAPI/CDB
    set_attr() with the NOEXISTS no value indicator.

    (ENG-25730)

  - cli: Added turboparser support for tailf:key-default extension on list
    keys.

    (ENG-25941)

  - cli: By using a look-ahead feature before setting a leaf the "Turbo
    Parser" can now better foresee if a token really should be used for the
    current leaf or not. If not the "Turbo Parser" will retry the same token
    but for a different location in the data tree. The "Turbo Parser" can
    now handle ambiguous situations better.

    (ENG-25917)

  - cli: Add a new CLI YANG extension named "tailf:cli-short-no". When
    deleting a list with "tailf:cli-suppress-mode" extension or deleting a
    presence container without "tailf:cli-add-mode" extension, which has
    multiple levels of sub-nodes, the show configuration output normally
    would be deletion of all the sub-nodes under the list or the presence
    container. This extension "tailf:cli-short-no" will alter the show
    configuration output to be deletion of the list or the presence
    container itself.

    (ENG-25191, RT:44079, PS-39183)

  - cs_trans: Increased performance for "when" expression evaluation. There
    will be a notable performance improvement for big lists with "when"
    expressions pointing to other big lists. This applies to the following
    example:
    list a {
        key name;
        leaf name { type string; }
        leaf a_leaf {
            when "/b[name=current()]/sort = ";
            type string;
        }
    }
    list b {
        key name;
        leaf name { type string; }
        leaf sort { type string; }
    }

    (ENG-25232)

  - documentation: Added documentation for Trace-Id under The Netconf Server
    Chapter in ConfD User guide.

    (ENG-27369, RT:47393, PS-42514)

  - documentation: Updated the user guide with additional information on how
    to prevent and handle issues where the host system runs out-of-file
    descriptors.

    (ENG-27228)

  - examples: The examples.confd/dp/generic_perf example was updated to
    handle a restart-before-a-persisted-confirming-commit use-case when
    "revertByCommit" has been enabled in confd.conf. The data provider
    application daemon must connect to ConfD at start phase 0 (as the ConfD
    UG describes) to handle a potential candidate persisted confirmed commit
    rollback between start phase 0 and 1.

    (ENG-27394, RT:47464, PS-42585, CSCvz83361)

  - examples: Updated the examples.confd/dp/generic_perf example with
    set_case() callback handling.

    (ENG-27371)

  - examples: Added a Python example for NETCONF notifications and merged
    the RFC 5722 and RFC 8639 examples into one example.

    (ENG-27158)

  - netconf: The documentation for yang-push has been extended to include
    the limitation that on-change subscription will not give notifications
    for changes made through the CDB-API (see section "YANG-push" in the
    ConfD User Guide chapter "The NETCONF Server").

    (ENG-24461)

  - observability: Progress trace CSV output now use microsecond precision
    in the timestamp and duration field.

    (ENG-25261)

  - python-api: Maagic node construction now defer construction of the child
    nodes until access. On nodes with many children this can improve access
    time considerably.

    (ENG-27299)

  - restconf: The 'Authorization' HTTP header is now checked for a OAuth2
    Bearer token; which will be passed on to the existing external
    authentication mechanism.

    (ENG-22229, RT:38936, PS-34008, SR:687451234)

  - security: The FIPS tests for ConfD are now verified towards  CiscoSSL
    7.2 release ciscossl-1.1.1l.7.2.289 at is based on OpenSSL 1.1.1l

    (ENG-27155)

  - snmp-gateway: ConfD's SNMP gateway no longer opens a port of an address
    family that is not used for communicating with agents.

    (ENG-27661, RT:47838, PS-42952, CSCwa15363)

  - toolchain: Reading CPU topology slows down startup when starting many
    parallel instances of confdc on systems with large amount of cores.
    The emulator flag +ssrct is added which can be used to skip reading CPU
    topology to improve performance in such a scenario.

    (ENG-26765, RT:46163, PS-41281)

  - web-server: When using confd_dyncfg, updates to the /tls tree are now
    handled the same as updates to the /confdConfig tree i.e. dynamically.

    (ENG-23240, RT:40421, PS-35503, CSCvt03296)

Corrections:

  - confd: Fix a performance issue in the handling of framing in the NETCONF
    protocol.

    (ENG-27470, RT:47515, PS-42636, CSCwa16249, SR:692169628)

  - confd: The implementation for public key usage is moved from
    $CONFD_DIR/lib/confd/lib/webui/ to $CONFD_DIR/lib/confd/lib/core/. This
    as it is, as of release 7.4, a dependency of other sub systems then the
    WEBUI.

    (ENG-27462, RT:47621, PS-42742, CSCvz92000)

  - confd: Improved the stability of the SSH connection towards the CLI by
    removing a race condition that could make the connection drop.

    (ENG-27426, RT:47564, PS-42685, CSCvz86903)

  - confd: The C code binaries compiled for ARM64 and PowerPC64 were missing
    the ELF program header GNU_STACK with RW flag set, i.e. the binaries for
    these two architectures were inadvertently not marked as not requiring
    executable stack. For ARM64 the GNU_STACK header has been missing since
    a compiler change in ConfD-7.4 release, for PowerPC64 it has always been
    missing. This has been fixed - all C code binaries now have the
    GNU_STACK header with the RW flag set.

    (ENG-27332, RT:47455, PS-42576, CSCvz76645)

  - confd: Leafrefs which refer to leafs within their own structure are
    optimized for db access. The optimization doesn't work if the leafref is
    external, i.e., contains non-local prefixes, so the fix is to avoid
    doing the optimization for these leafrefs.
    Such external leafrefs now work because the optimization is not done.

    (ENG-26531)

  - c-api: Fixed a bug in cleanup procedure for a disconnecting daemon that
    had multiple concurrent subscriptions to push on-change callbacks.

    (ENG-27393)

  - c-api: When all the elements within a container are deleted the CLI has
    been fixed so that any other deleted node which should have been printed
    before these due to the tailf:cli-diff-delete-before extension actually
    happen.

    (ENG-26958, RT:46621, PS-41736, CSCvy84616)

  - c-api: Full source code for the confd_cli command is included into the
    released bundle, so it is possible to update and rebuild the command
    binary.

    (ENG-26577, RT:46197, RT:46393, PS-41315, PS-41512, CSCvy36332)

  - c-api: Do not allow to use cdb_set_elem() or cdb_set_elem2() to set the
    value of a list key. The action shall result in the
    'CONFD_ERR_NOT_WRITABLE' error code, and the 'A list key is not
    writable' error string.

    (ENG-26118, RT:45749, RT:46959, RT:47025, PS-40864, PS-42078, PS-42144,
    CSCvx95656)

  - cdb: Fixed two issues that caused a memory leak in the system.
    1. Some internal processes, that are started when reading running db at
    prepare phase through South Bound APIs, were not terminated, causing
    increased memory consumption.
    2. At prepare phase, if a CDB subscriber aborts an ongoing-transaction,
    that has modifications on operational data, by using
    cdb_sub_abort_trans(), some parts of state data were not garbage
    collected.

    (ENG-27653, RT:47713, PS-42836, CSCwa14532)

  - cdb: Correct a regression that lead to reading the operational datastore
    during prepare phase returning the wrong value.

    (ENG-27365, RT:47503, PS-42624, CSCvz81135)

  - cdb: Accessing a leaf that had both a when expression and a default
    value during upgrade crashed, halting the upgrade and start of ConfD.
    This has now been fixed.

    (ENG-27341, RT:47387, PS-42508, CSCvz78619)

  - cdb: Corrected leaf-list ordering when using 'tailf:sort-order'
    statement.

    (ENG-27307, RT:47425, PS-42546, CSCvz71243)

  - cdb: Operations like get_object, get_objects, get_values require read
    lock acquisition even for CDB_LOCK_REQUEST and CDB_LOCK_PARTIAL modes
    which may happen when cdb_agent already have a nb-read lock. The nb-read
    lock is now released if it was taken and try to grab read lock
    instantly.

    (ENG-27161)

  - cdb: If there is "ordered-by user" list under "choice"/"case" statement,
    querying that list in the CDB_PRE_COMMIT_RUNNING database at commit
    phase returned incorrect value.
    Now, the database has been corrected and shall return correct value.

    (ENG-27149, RT:47109, PS-42228, CSCvz47561)

  - cdb: There was an inconsistency between CDB and cs_trans engines which
    caused an internal error if external subscriber invokes
    cdb:get_modifications() in prepare phase of the transaction. The
    inconsistency has been removed now.

    (ENG-27134, RT:47094, PS-42213, CSCvz43221)

  - cdb-capi: A lockless session with CDB_LOCK_REQUEST and CDB_LOCK_WAIT
    flags, which was established at prepare phase and doing
    cdb_get_values(), cdb_get_object(), or cdb_get_objects(), had an issue
    when being used. The use-case has been fixed and the lockless session
    now completes its operation successfully.

    (ENG-27840, RT:47834, PS-42948, CSCwa34746)

  - cdb-capi: A CDB-CAPI session that reads data at phase0, and where the
    action requires "when" expression evaluation, caused CONFD_EOF. The
    use-case has been fixed and the reading action will now return
    correctly.

    (ENG-27795, RT:47950, PS-43064, CSCwa31437)

  - cdb-subscription: Corrected cdb_get_modifications() notifications of
    transaction that containing both changes in config data and state data.

    (ENG-27497)

  - cdb-subscription: Correct cdb_get_modifications() when creating or
    deleting presence container.

    (ENG-27386)

  - cdb-subscription: Added missing notifications of cdb_oper_subscribe()
    when creating or deleting config node, which is the ancestor of
    operational nodes.
    Fixed hanging transaction when doing cdb_diff_iterate() in
    cdb_oper_modifications()

    (ENG-25488, RT:31994, RT:44500, PS-27856, PS-39609, CSCvw97177)

  - cli: Corrected the "show" of configuration changes of leaf lists
    annotated with "tailf:cli-list-syntax" to prevent that an error message
    is logged for non string types, e.g. ipv4 addresses and integers.

    (ENG-27202, RT:47256, PS-42377, CSCvz57241)

  - cli: Fix the piped command 'display json' to separate top data nodes
    with comma when displaying JSON-data output.

    (ENG-27201, RT:47209, PS-42329, CSCvz56887)

  - cli: Buffer sizes for internal IPC and CLI SSH server are set to smaller
    values, reducing memory consumption. Rate limiting is fixed so that CLI
    SSH server stops accepting more data if CLI backend is overloaded.

    (ENG-27031, RT:43808, PS-38916, CSCvz19012)

  - cli: When using Turboparser it was possible to enter invalid
    configuration by skipping a non-optional container child of a container
    annotated with tailf:cli-sequence-commands and tailf:cli-compact-syntax,
    and entering the node right after that child container. Now the
    non-optional container cannot be skipped.

    (ENG-26595)

  - cli: Help string is displayed upon completion for containers with
    tailf:cli-suppress-no extension, having a child leaf of type empty.

    (ENG-20709, RT:36665, RT:36529, PS-31745, PS-31609)

  - cli: When 'confdConfig/cli/actionCallNoListInstance' is set to
    'create-instance' and there is no
    support to transactions, 'confdConfig/cli/transactions' is set to false
    or on an I-style CLI,
    the context needed to invoke the action will be created and written
    in the database.

    (ENG-18546, RT:32913, PS-28479)

  - cs_trans: Fixed incorrect "when" expression evaluation on default leafs.

    (ENG-27805)

  - cs_trans: When deleting config data containing config list and the
    config list containing state data, the state data was not deleted in the
    operational datastore. The behaviour has been corrected so now the state
    data will be deleted.

    (ENG-27763, RT:47925, PS-43037, CSCwa26071)

  - cs_trans: Corrected the min-elements constraints for leaf-lists with
    "when" expressions.

    (ENG-27652)

  - cs_trans: Calling an action from within a transaction hook resulted in a
    deadlock when the action needed data from the original transaction -
    which was blocked on the hook. ConfD now supports getting data from the
    original transaction.

    (ENG-27003, RT:46719, PS-41836, CSCvy97164)

  - cs_trans: Fixed incorrectly set case when writing to nonexistent node
    that belongs to a nested choice statement.

    (ENG-26308)

  - documentation: Man page for confd(1) has been updated to correctly
    describe SMP option.

    (ENG-27364, RT:47505, PS-42626, CSCvz81124)

  - documentation: Addressed issues with broken reference links "???" in the
    documentation

    (ENG-27032, RT:46906, PS-42023, CSCvz20243)

  - documentation: Using confd_load with turbo parser for save config
    returns an error message 'confd_load: format C-style CLI using turbo
    parser is only applicable for load config'

    (ENG-26945, RT:46577, PS-41691, CSCvy81801)

  - ha: An HA role transition during a confirmed commit will no longer
    terminate the node, but instead abort the commit and continue with the
    HA transition.

    (ENG-27727)

  - ha: Fixed HA deadlock that occurred when transitioning from none to
    active, and there was a transaction attempting to distribute rollbacks.

    (ENG-27578)

  - ha: A regression that was introduced in ENG-26374 caused the primary
    node to crash when distributing change-set to secondary nodes.

    (ENG-27129)

  - ha: When using the 'json2' return format, internal support for returning
    the number of list instances was missing.

    (ENG-26980)

  - ha: A standby node with volatile CDB sometimes failed to revert a commit
    that was not confirmed on the active node in time. The commit is now
    always rolled back on the standby node if no commit confirm command has
    been issued before the timeout expires.

    (ENG-26719)

  - ha: Corrected the distributed change-set from the primary node to
    secondary nodes.
    Corrected the notification of subscriber to operational datastore on
    secondary nodes.

    (ENG-26374, RT:45765, PS-40880, CSCvy17408)

  - java-api: Fixed an issue with IPv6 address handling when receiving
    SnmpaNotification.

    (ENG-27320, RT:47195, PS-42315, CSCvz74017)

  - json-rpc: The "get_leafref_values" method lacked support for reading
    action/rpc leafref values with "must" expressions present.  This can now
    be done via an action/rpc transaction started with the parameter
    action_path set.

    (ENG-27445, RT:47390, PS-42511, CSCvz88997)

  - json-rpc: Optimisation of the memory usage when using the JSON-RPC
    method 'subscribe_poll_leaf'.

    (ENG-27406, RT:47251, RT:47208, PS-42372, PS-42328, CSCvz84694)

  - json-rpc: Some access log entries for dynamically generated content had
    content length incorrectly set to 0. Such access log entries are now set
    to the actually generated content length.

    (ENG-27110, RT:47047, PS-42166, CSCvz38804, SR:691975456)

  - json-rpc: Previously, multiple *identical* Set-Cookie HTTP headers could
    be returned.

    (ENG-27073, RT:47029, PS-42148, CSCvz33670)

  - json-rpc: The JSON-RPC operation show-config for operational data on a
    newly created device did not respond that the device was 'southbound
    locked'. It now responds with 'Device <device name> is southbound
    locked'.

    (ENG-26636)

  - maapi: Removed a confd_load error when the program was used to save
    configuration with a config false child in a config true tree. The error
    was: 'confd_load: maapi_save_config_result(sock, id) failed: internal
    error (18): internal'

    (ENG-27390, RT:47527, PS-42648, CSCvz82356)

  - netconf: ConfD SSH servers will now correctly respect the WantReply
    field in SSH protocol's "subsystem" requests. This should not affect
    configurations or the end users.

    (ENG-27262, RT:47316, PS-42437, CSCvz62749)

  - netconf: If there is a default leaf with a "when" expression evaluating
    to false, the leaf belonging to an external data provider, creating its
    closest ancestor caused an error. The error did only occur in
    transactions using the "delayed when" mode and has been resolved.

    (ENG-27136, RT:47082, PS-42201, CSCvz44280)

  - netconf: A user session that performed an establish-subscription did not
    introduce an exception to the confd.conf parameter idleTimeout for
    NETCONF, resulting in the session being timed out according to the value
    of idleTimeout. Now the idleTimeout for NETCONF will no longer trigger
    as long as there exists an establish-subscription in the user session.

    (ENG-26802)

  - netconf: NETCONF get-config now includes list instance keys when a
    subtree filter selects a list instance but not its keys.

    (ENG-22626)

  - observability: Erlang/OTP-22 and newer versions had removed list of
    messages when getting process information, which caused 'confd
    --debug-dump' to stop and not include all necessary system information.
    The debug-dump command is now corrected and shall include the list of
    process messages, if that process has pending messages.

    (ENG-27166, RT:46796, PS-41914)

  - python-api: Cross compilation of ConfD did not produce a working 'confd'
    module. The 'confd' module did not work as expected as the generated
    __init__.py file was missing. Cross compilation now ensures that the
    __init__.py is included and imports of 'confd' work as expected.

    (ENG-27459)

  - restconf: A faulty check was triggered when trying to validate that the
    URL of a PUT request was corresponding to the actual payload.

    (ENG-27627, RT:47818, PS-42939, CSCwa12490)

  - restconf: The fix for ENG-25894 introduced a regression for RESTCONF
    action JSON output where identityrefs and instance-identifiers were not
    quoted properly. This regression is now fixed and quotation is correct.

    (ENG-27366, RT:47516, RT:47958, PS-42637, PS-43072)

  - security: The SSH CLI server offered public key authentication even
    while the config file specified "none" as SSH public key method. Now the
    CLI server will not offer public key auth method when the setting is
    "none".

    (ENG-25748, RT:45309, PS-40422, CSCvx48406)

  - snmp-agent: When flooding the system with SNMP 'set-request' messages,
    memory growth of the system internal 'note-store' is now avoided.

    (ENG-27324, RT:47046, PS-42165, CSCvz75273)

  - toolchain: It is now possible to rebuild PyAPI3 using cross-compiler.

    (ENG-27116, RT:46243, PS-41361, CSCvz40176)

  - toolchain: The file ietf-datastores.fxs is not shipped in the loadpath
    anymore since it is a built-in fxs file. When compiling SNMP MIBs it is
    correctly handled as a built-in fxs by confdc.

    (ENG-27052, RT:46979, PS-42098, CSCvz29935)

  - xpath: Improve performance of XPath queries when current() is used to
    match values in large leaf lists.

    (ENG-26540)

  - xpath: If the XPath filter in NETCONF subscription contains a
    choice/case node, the XPath expression was always evaluated to false,
    and the notification was always filtered out. The XPath engine has been
    corrected to evaluate such XPath expressions.

    (ENG-22016, RT:38698, PS-33771, CSCvr08857)

ConfD-7.6 [September 9, 2021]
=============================

Deprecated:

  - confd: The ConfD build toolchain will be updated for ConfD-8.0,
    scheduled for release during spring 2022. This impacts the oldest
    version of glibc supported for use on Linux. As of the ConfD-8.0
    release, the minimum version of glibc supported for Linux will be
    glibc-2.24 for all ConfD CPU architectures. The runtime requirements
    for the upcoming ConfD-7.7 will remain unchanged.

    (ENG-26972)

  - confd: Deprecate the MAAPI_SHARED_NO_BACKPOINTER MAAPI flag in the C API
    and the SHARED_NO_BACKPOINTER MAAPI flag in the Python API.
    New usages of the flags are discouraged, the flag will be removed in an
    upcoming release.

    (ENG-26127)

  - python-api: Python-3.5 has been deprecated and will be removed in
    ConfD-7.7. You should upgrade your Python environment and make sure
    everything works with Python-3.7 or higher.

    (ENG-24807)

Non-backwards compatible enhancements:

  - confd: The ConfD installers are now cryptographically signed, and
    delivered as self-unpacking archives which include the installer and
    the signature. In the archive there is a README.signature where you
    can find information on the other files in the archive. To unpack the
    archive and verify the signature, use e.g. the command

     $ sh confd-7.6.linux.x86_64.signed.bin

    See the ConfD User Guide for further details.

    (ENG-25765)

  - confd: If a user performing rollback lacks access rights to some or all
    data, the action was previously aborted with an "access denied" error.
    To improve usability, the rollback action now discards changes for which
    the user has insufficient access rights. A message with the following
    format is written to the developer log:
      devel-aaa User: <user>[<group>] rejected data access path <path> op
    <op>, change is discarded
    If the rollback is performed from the CLI the following message will
    appear in the console:
      Warning: Some changes could not be applied due to NACM rules
    prohibiting access.
    For the JSON-RPC methods "install_rollback" and "load_rollback" the
    following message will be returned in the warnings array:
      Some changes could not be applied due to NACM rules prohibiting
    access.

    (ENG-25237, RT:41672, PS-36758, CSCvw57771)

  - confd: ConfD has different behavior during schema upgrade, which
    contains instance-identifier nodes with stale data.
    For in-service upgrade, the schema upgrade aborted and the old system
    was restored.
    For out-of-service upgrade, ConfD logged bad dependencies in confd.log
    and the schema upgrade succeeded.
    Now, the schema upgrade will always succeed and implicitly delete
    instance-identifier nodes with stale data.

    (ENG-22943)

  - cli: If a user lacking access right tries to delete a subtree, a warning
    message was printed in the console as following:
      Warning: Some elements could not be removed.
    In order to be consistent with rollback scenario, the warning message
    has been changed to:
      Warning: Some elements could not be removed due to NACM rules
    prohibiting access.
    The warning message is also updated accordingly for JSON-RPC northbound
    interface.

    (ENG-25533)

Non-backwards compatible corrections:

  - confd: Validate string input as UTF-8 encoded YANG string
    Exceptions, i.e. not validated:
    * confd.conf
    * data providers
    * cli prompt leafs, i.e. /confdConfig/cli/prompt1 and friends.
    * encrypted string types
    Add /confdConfig/validateUtf8/enabled for compatibility and upgrades.
    Add "confd --cdb-debug-dump cdb-dir validate_utf8" option for checking
    CDB contents for invalid UTF-8 encoded YANG string data. Correcting CDB
    contents has to be done manually.

    (ENG-24758, RT:43631, PS-38748, CSCvv82025)

  - confd: The value of union type nodes are re-evaluated during upgrade.
    This enables the possibility to change these nodes' value types after
    upgrade, even though the schema was not changed.

    (ENG-24494, RT:43078, RT:44081, PS-38192, PS-39185, CSCvv27768,
    SR:688845201)

  - aaa: Removed an internal error that occurred when deleting an
    np-container with a container and leaf as children.
    This also corrects problems with deleting a default leaf under a
    p-container and problems with deleting a list.

    (ENG-25454)

  - aaa: Allow deletion of descendant nodes when they are implicitly deleted
    as a side effect of an allowed operation.
    Rules on non-presence container should apply for its descendants.

    (ENG-24793, RT:43711, PS-38828, CSCvv89172)

  - java-api: There was a race-condition leading to data being interleaved
    in the same socket by Maapi and MaapiInputStream objects and it led to
    clients failing to decode the response or indefinitely waiting for data.

    (ENG-26562, RT:45448, PS-40563, CSCvy34675, SR:690961451)

  - json-rpc: JSON-RPC would delay the evaluation of "when" expressions
    until the validation phase, which means that when config is set the
    "when" expressions are not evaluated and the request succeeds even when
    the config goes against a "when" expression. The "when" expression does
    not fail until a validation is done later. This is in contrast to how
    the CLI works. Since JSON-RPC is supposed to work as the CLI, the
    behavior in JSON-RPC has been changed so that "when" expressions are
    evaluated in the same way as in the CLI, so the validation of "when"
    expressions is no longer delayed by default. Note that this change of
    behavior for JSON-RPC will mean that in situations where before a "when"
    expression failed in the validation phase, either causing an error when
    performing a validation or just leading to a silent delete depending on
    the 'when_error_mode' option, it will now instead fail with an error
    when trying to set the config.
    In addition, this fix removes the 'when_error_mode' functionality. This
    is a parameter for validate_commit and validate_trans in JSON-RPC that
    decides if a failing "when" expression should fail silently or throw an
    error when validate_commit and validate_trans are performed. Since the
    validation of "when" expressions now happens when setting the value this
    parameter is no longer valid.

    (ENG-25862, RT:45467, PS-40583, CSCvx64666)

  - restconf: In rare cases RESTCONF subscriptions, where the subscriber
    terminates without tearing down the connection correctly, could lead to
    ports and internal processes not closing/terminating as they should. The
    two config settings '/confdConfig/webui/transport/keepalive' and
    '/confdConfig/webui/transport/keepaliveTimeout' have been added to
    handle this. Setting keepalive to true will ask the host OS to detect
    future lingering ports and instruct the server to periodically send
    comment messages (":keepalive test") over the subscription channels. The
    'keepaliveTimeout' can be used to specify the frequency of the messages.
    Note that subscribers must be able to handled these new messages!

    (ENG-25623, RT:43256, PS-38372, CSCvx21813)

  - web-server: Previously an OPTIONS * request would respond with 200 OK
    and an Allow header with a static list of HTTP methods. Such a request
    now responds with a 400 Bad Request without an Allow header.

    (ENG-22346)

Enhancements:

  - confd: The performance of outputting XPath evaluation to a trace log has
    been considerably improved.

    (ENG-26661)

  - confd: The number of close system calls has been optimized for some
    operating systems.

    (ENG-26130, RT:45752, PS-40867, CSCvx96615)

  - confd: The system will log an error if it can not delete a rollback
    file. The format of the error log is shown as below,
    Failed to delete rollback file <filename>: <reason>

    (ENG-25636)

  - confd: Added /netconf-state/sessions/session/transaction/lock to report
    when a read-write transaction has requested and acquired the transaction
    lock.
    Added enum 'read-write' and obsoleted the enum 'read_write' in
    /netconf-state/sessions/session/transaction/mode. The 'read-write' enum
    will now be reported instead of the 'read_write' enum.

    (ENG-24088, RT:42348, PS-37450, CSCvx37739, SR:689092085)

  - confd: When using an external SSH daemon for NETCONF SSH Call Home, the
    support for passing an opaque string has been added. This is done by
    using the new MAAPI function maapi_netconf_ssh_call_home_opaque.

    (ENG-23350, RT:40792, PS-35888)

  - confd: CDB oper has been extended to support operational config nodes in
    order to comply with the operation-state datastore defined in RFC 8342
    Network Management Datastore Architecture (NMDA).
    The tailf:operational extension can be used as a substatement to
    tailf:cdb-oper to indicate that operational data should be read from CDB
    oper.
    CDB API and MAAPI are updated to manage operational config data in CDB
    oper. Two new functions have been added to support attributes for
    operational config data in CDB oper - cdb_get_attrs() and
    cdb_set_attr().

    (ENG-23109)

  - confd: Leafref handling, that would rewrite XPath expression, when the
    leafref path contains subpath, in which the list's key is a leafref,
    points to the target node inside the same instance, was optimized.

    (ENG-21146, RT:35156, PS-30227)

  - aaa: Non-ascii characters are now allowed in account names and passwords
    at login when connecting to CONFD using SSH.

    (ENG-25174)

  - c-api: Improve networking and data management when bulk replies are used
    by applications and ConfD performs traversals on lists with items that
    have leaf references to the same list.

    (ENG-26666, RT:46202, RT:45764, PS-41320, PS-40879, CSCvy46865)

  - cli: Improved the memory usage of the CLI for situations where rate of
    'maapi_sys_messages' is high.

    (ENG-25738, RT:45277, PS-40390, CSCvx45627)

  - cli: Support for passing a CHMOD path through the MAAPI API
    (maapi_load_config_cmds) has been added to the CLI Turbo Parser.

    (ENG-25358, RT:45275, PS-40388)

  - cli: The performance when displaying C-style configuration diffs (e.g.
    show configuration) involving the deletion of leafrefs has been
    improved.

    (ENG-25180, RT:44256, PS-39362)

  - cli: The CLI Turbo Parser now supports parsing and storing attributes
    (comments).

    (ENG-24241, RT:42700, PS-37816, CSCvu77402)

  - cli: Even though the 'tailf_yang_cli_extensions' documentation clearly
    states that 'tailf:cli-boolean-no' cannot be used in
    'tailf:compact-syntax' nodes, we now support this combination in the CLI
    Turbo Parser.

    (ENG-24228, RT:42673, PS-37789, CSCvu75733)

  - cli: 'tailf:cli-reset-container' has previously been partially
    implemented in the CLI Turbo Parser. Now the implementation has been
    completed.

    (ENG-23492, RT:43511, PS-38628)

  - cli: The way the turbo parser handles backslashes has been harmonized
    with the way 'confd_cli' handles backslashes. Most importantly, the CLI
    Turbo Parser will now save escaped backslashes in between quotes.

    (ENG-22971)

  - cli: The "show rollback changes" command has been improved to output in
    Juniper style when it is in Juniper style CLI.

    (ENG-282, RT:41611, RT:41868, PS-36696, PS-36962)

  - cs_trans: When a leaf-list has a "when" expression or "when"
    dependencies, the system evaluated the "when" expression for each
    modified leaf-list entry. Now the "when" expression is evaluated once.

    (ENG-26543)

  - cs_trans: ENG-24474 degraded performance during the validation phase for
    transactions running in "delayed when" mode, for example, set by
    'maapi_set_delayed_when()'.

    (ENG-25783)

  - documentation: Documentation on High Availability and Subagent
    functionality was revised.

    (ENG-24597)

  - examples: The linuxcfg example now support NMDA with the latest
    revisions of IETF YANG models and data provider application updates.

    (ENG-27107)

  - examples: Updated the NMDA hardware management example make use of the
    new "storing 'config true' NMDA operational state data in CDB
    operational datastore" feature.

    (ENG-26170)

  - examples: Added support for nested choices plus additional YANG corner
    cases to the examples.confd/dp/generic_perf example.

    (ENG-26131)

  - examples: Added a hardware management example for storing config "true"
    NMDA operational-state data in the CDB operational datastore under
    examples.confd/nmda/05-hardware-management.

    (ENG-26123)

  - examples: New ConfD example - syslog notifications subscriber.

    (ENG-24998)

  - json-rpc: The JSON-RPC "load" call can now also be used with action
    transactions.

    (ENG-25688)

  - logging: Enhance logging for operational data schema upgrades.

    (ENG-25943, RT:45558, PS-40675)

  - netconf: The concept of trace id is introduced in ConfD. Trace id can be
    used to correlate a NETCONF response to the corresponding edit-config,
    edit-data or copy-config request. If enabled, the trace id is generated
    by NETCONF server for received edit-config, edit-data and copy-config
    RPCs and set as an attribute in rpc-reply messages. Trace id is used in
    corresponding NETCONF log and trace records and also passed as a commit
    parameter, thus it can be retrieved by a call to the MAAPI function
    maapi_ncs_get_trans_params.

    (ENG-24783, RT:42713, PS-37829, CSCvv94783)

  - netconf: XML RPC replies from Juniper devices are now allowed to contain
    both data AND ok. Note that this change introduces a deviation from RFC
    6241 (4.4).

    (ENG-24714, RT:41430, RT:44484, PS-36503, PS-39592)

  - netconf: The configuration option "keepalive" has been added to the TCP
    transport for NETCONF.

    (ENG-24045, RT:42375, PS-37485, CSCvu52320)

  - nmda: When the cdb-oper statement augmented into a callpoint that is
    extended with the tailf:operational substatement, loading of FXS files
    did not detect that cdb-oper is not legal under a callpoint. It is now
    not permitted to augment an operational callpoint with cdb-oper.

    (ENG-27054)

  - restconf: It is now possible to set rollback label and rollback comment
    in RESTCONF and NETCONF when invoking action "apply-rollback-file".
    The leafs "label" and "comment" have been added to tailf-rollback.yang
    to the "apply-rollback-file" action input, so when invoking this action
    in RESTCONF or NETCONF one can give a label and comment as input
    together with the ID of the rollback file to apply the rollback. This
    will lead to the label and comment being added to the rollback file.

    (ENG-22886, RT:40131, PS-35210, CSCvs72102, SR:688066696)

  - toolchain: Updated regular expression library excerpt from libxml2-2.9.8
    to libxml2-2.9.12.

    (ENG-26808)

  - toolchain: The confdc option --allow-interop-issues can now be used
    together with --emit-h and emit-hrl options. When generating headers
    from YANG files, if a config true node contains an XPath expression that
    refers to config false data, confdc prints an error. When the compiler
    flag --allow-interop-issues is used, confdc reports this issue as a
    warning instead.

    (ENG-25729, RT:45008, PS-40121)

  - toolchain: The compiler confdc has a new option --allow-interop-issues.
    By default, if a config true node contains an XPath expression that
    refers to config false data, confdc prints an error. When the compiler
    flag --allow-interop-issues is used, confdc reports this as a warning
    instead. The flag can only be used when compiling YANG files.
    Note that this is not recommended as it violates RFC7950 section 6.4.1;
    a constraint on a config true node contains an XPath expression may not
    refer to a config false node.

    (ENG-25538, RT:45008, PS-40121)

  - toolchain: The compiler confdc has been changed to not allow emitting of
    custom versions of system builtin YANG namespaces. The reason is that it
    is not possible to change system builtin YANG modules, therefore it
    should not be possible to emit code from such custom versions of system
    builtin YANG modules either, since it will pose a risk to cause
    inconsistencies.
    As a convenience, it is still possible to emit source code (C, Erlang,
    Python, Java, MIB), from actual builtin YANG modules. In order to allow
    this, a new flag called '--builtin' has been added. To see which system
    builtin YANG modules can be used to emit, please use the new flag
    '--list-builtins'.

    (ENG-24844, RT:43894, PS-39000, CSCvv95148)

  - web-server: The '/resources' URL for the webui has now been disabled by
    default. Set the parameter '/confdConfig/webui/resources/enabled' to
    'true' to enabled it.

    (ENG-24612)

Corrections:

  - confd: Re-enable `aes256-cbc` encryption algorithm for SSH.

    (ENG-27060, RT:46969, PS-42088, CSCvz30796)

  - confd: Re-enable cipher suites: TLS_RSA_WITH_AES128_CBC_SHA,
    TLS_RSA_WITH_AES256_CBC_SHA, TLS_RSA_WITH_AES_128_CBC_SHA256 and
    TLS_RSA_WITH_AES256_SHA256.

    (ENG-27002, RT:46676, PS-41793, CSCvy96859)

  - confd: Added mandatory nodes, and existing nodes that didn't have
    instance data, but became mandatory would now cause a validation error
    if present in the active case.

    (ENG-26965)

  - confd: Delete the oldest progress trace entry instead of the most recent
    when exceeding the progress trace's maximum size.

    (ENG-26954, RT:46504, PS-41618, CSCvy83549, SR:691377841)

  - confd: The order of user-ordered leaf-lists is now preserved when
    calculating reverse diff-set during a sync-to.

    (ENG-26825, RT:46352, PS-41471, CSCvy66434)

  - confd: An unexpected behavior occurred when a choice did not change from
    default even though it was explicitly set. This resulted in a validation
    failure at commit but has now been corrected so the choice does change
    value to the explicitly set one, and the validation can proceed.

    (ENG-26783, RT:46378, PS-41497, CSCvy60045, SR:691511452)

  - confd: Items set in in the /progress/trace/debug leaf-list now takes
    effect for the configured progress trace.

    (ENG-26446)

  - confd: A significant performance degradation when creating a diff in CLI
    format has been fixed.

    (ENG-26264, RT:45769, PS-40884, CSCvy04497, SR:691107363)

  - confd: A large amount of Immediate-Query request via the RESTCONF Query
    API could cause the memory to grow unnecessarily large.

    (ENG-25906, RT:45514, RT:45424, PS-40630, PS-40538, CSCvx70377,
    SR:690948532)

  - confd: The filter tree generated for large leafref is now limited only
    by the memory of the server.

    (ENG-25778, RT:45649, RT:44891, PS-40767, PS-40003, CSCvx54246)

  - confd: ConfD Basic fails to start, with an error, if its configuration
    tries to enable RESTCONF, WebUI, or SNMP.

    (ENG-25718)

  - confd: ConfD did not rename rollback files based on
    /confdConf/rollback/rollbackNumbering if rollbackNumbering was changed
    and the system restarted. Now ConfD will check and rename all rollback
    files accordingly upon restart.

    (ENG-25605)

  - confd: The MAAPI save_config call produced XML elements with the wrong
    namespace when the MAAPI_CONFIG_NO_PARENTS flag was used.

    (ENG-25580, RT:44890, RT:44935, PS-40002, PS-40047, CSCvx13767,
    SR:690649704)

  - confd: ConfD did not delete old rollback files based on
    /confdConf/rollback/historySize if historySize was reduced and the
    system restarted. Now ConfD will check and reduce the number of rollback
    files upon restart.

    (ENG-25477, RT:45071, RT:44807, PS-40184, PS-39919, CSCvw92968,
    SR:690533459)

  - confd: ConfD and confdc no longer hangs at startup if 1024 file
    descriptors are open when the commands are invoked.

    (ENG-25475, RT:44747, PS-39857, CSCvw96027)

  - confd: maapi_set_values can now be used to set keyless (config false)
    lists.

    (ENG-25276)

  - confd: When the Rollback File mechanism was enabled, the number of
    Rollback Files affected the response time for RESTCONF request (due to
    the construction of the ETag HTTP response header). The implementation
    has now been changed to make the response times unaffected by the number
    of Rollback Files.

    (ENG-25269, RT:44807, RT:44137, RT:45268, PS-39919, PS-39241, PS-40381,
    CSCvw62366, SR:690110245)

  - confd: When setting leaf-list containing 'tailf:cli-list-syntax'
    extension, the system generated incorrect rollback data which lead to
    the 'rollback configuration' only deleting one leaf-list entry. Now
    the system has been updated to generate rollback data correctly.

    (ENG-25247)

  - confd: Correcting the Time Zone calculation that did not handle cases
    properly when Local- and Universal time ended up on different days.

    (ENG-25171, RT:44335, PS-39442, CSCvw61112)

  - confd: When changing a node (N1) that another node (N2) is
    when-dependent upon, effectively making N2 non-existent, the resulting
    rollback file did not include the changes to N2 if the change to N1 was
    done through one of the northbound interfaces (except RESTCONF) or a
    MAAPI transaction started in delayed-when mode.

    (ENG-24474, RT:43074, PS-38188, CSCvv21888, SR:689537608)

  - confd: Configured progress trace files are now reopened on reception of
    reopen_logs command.

    (ENG-23205)

  - confd: Action/RPC input parameters of type empty which are also
    mandatory did not get passed along to the action callback.

    (ENG-22987, RT:40278, PS-35357, CSCvs66485)

  - confd: If /kickers/data-kicker/kick-node changed its value during
    upgrade, ConfD ignored the changed config. The system has been updated
    so that such changes will be applied when upgrade is completed.

    (ENG-21577, RT:37548, PS-32625)

  - aaa: Corrected NACM check when using RESTCONF/NETCONF or load operation
    in CLI/JSON-RPC to deleting configuration.

    (ENG-25627, RT:45059, PS-40172, CSCvx23657)

  - aaa: A regression caused an unrelated NACM rule to prevent a list
    element from being deleted because of an error occurring while
    processing this rule. The change that made this failure happen has now
    been reverted.

    (ENG-25364, RT:44541, PS-39651, CSCvw75133)

  - c-api: Fix an issue that caused failures when subscribing on NETCONF
    Event Notifications while Authorization Callbacks are enabled.

    (ENG-26680, RT:46296, PS-41416, CSCvy49397)

  - c-api: Do not allow to use cdb_set_elem() or cdb_set_elem2() to set
    value of list key. The action shall result 'CONFD_ERR_NOT_WRITABLE'
    error code, and 'A list key is not writable' error string.

    (ENG-26118, RT:45749, RT:46959, RT:47025, PS-40864, PS-42078, PS-42144,
    CSCvx95656)

  - cdb: The value of
    /confd-state/internal/cdb/datastore/pending-subscription-sync/time-remaining
    was always set to infinity for operational datastore. The value of this
    leaf has been corrected to show the remaining time in seconds before
    clients which does not respond will have its socket closed.

    (ENG-26916, RT:46429, PS-41544, CSCvy75316)

  - cdb: It was possible for invalid operational data to be persisted in CDB
    after a schema change. Such invalid data, if any, will now be deleted
    during CDB upgrade.

    (ENG-25888, RT:45457, PS-40573, CSCvx68272, SR:690855993)

  - cdb: Fix error handling of lock acquisition in HA and CDB

    (ENG-25874)

  - cdb: Fixed an issue where old augments into built-in user modules
    remained after an upgrade, which was resulting in incorrect data models
    and causing faulty behaviour.

    (ENG-25596, RT:44658, PS-39769, CSCvx16595)

  - cdb: A schema upgrade in phase0 where a leaf-list with min-elements > 0
    was added, populating that leaf-list using MAAPI would cause an internal
    error. This is now corrected and will work as expected.

    (ENG-25523, RT:44928, PS-40040, CSCvx04254)

  - cdb: ConfD performed unnecessary "when" expression evaluations and set
    hook invocations. This happened when resetting the value to its current
    value.
    Now the value change is verified before evaluating the "when" expression
    and running the set hook.

    (ENG-25515, RT:44786, RT:44400, PS-39897, PS-39507, CSCvx02960,
    SR:690219367)

  - cdb: When using functions from the CDB API to format a keypath using
    "%h" (hkeypath) and the keypath was pointing to an augmented node, the
    call failed with a "bad tag value" error. This was a regression
    introduced in ENG-22839.

    (ENG-25479, RT:44811, PS-39923, CSCvw94125)

  - cdb: Introduced new flag - 'CDB_GET_MODS_WANT_ANCESTOR_DELETE' for
    'cdb_get_modifications()'. If set, subscriber to child now get
    notification of parent structure deletion.

    (ENG-25478, RT:44288, PS-39394, CSCvw93729)

  - cdb: Incorrectly handled parameters internally in CDB could in some
    cases result in ConfD terminating.

    (ENG-24469, RT:42742, PS-37858, CSCvv20389)

  - cdb: When a service subscribed on a standby node, and the standby first
    connected to active node, the system did not generate notifications for
    nodes with "when" expressions evaluating to true. The system has been
    updated to correctly generate notifications for such nodes.

    (ENG-19091, RT:33879, PS-29130)

  - cli: The handling of pipe targets of the show command was corrected to
    prevent an internal error on C-Style CLIs.

    (ENG-27029)

  - cli: The diff of CLI private configuration sessions in the curly bracket
    format  was corrected for situations that the access to the running
    datastore is `writable-through-candidate` and the candidate datastore
    has changes that are not yet in the running datastore.

    (ENG-27004)

  - cli: Removed access denied error of the show command when the pipe
    target tab is used.

    (ENG-26990, RT:46540, PS-41654, CSCvy92541)

  - cli: The JSON-data output now displays leaf-lists as arrays instead of a
    strings.

    (ENG-26514, RT:45998, PS-41115, CSCvy28080, SR:691315031)

  - cli: The terminal window size limits are now enforced. It also increases
    the maximum allowed terminal window width to 1024.

    (ENG-26434, RT:46035, PS-41152, CSCvy22148)

  - cli: The "| display restconf" CLI command now includes /data/ in the
    URL.

    (ENG-26388, RT:46007, PS-41124, CSCvy19911)

  - cli: Do not display nodes with 'tailf:no-keyword' extension when using
    the 'display set' pipe command in J-Style CLI and also do display nodes
    without the extension.

    (ENG-26380, RT:45877, PS-40994, CSCvy18115, SR:691166344)

  - cli: The configuration diff (as displayed by 'show configuration') after
    re-ordering the instances of an 'ordered-by user' list along with other
    config modifications would in some cases render invalid diff output.

    (ENG-26303, RT:45931, PS-41048, CSCvy09562)

  - cli: It was possible for the CLI Turbo Parser to get stuck in a submode
    that was a 'presence container' or a 'tailf:cli-add-mode' node.

    (ENG-26096)

  - cli: Looking at operational-data (such as live-status information)
    crashed due to missing initial CLI session information.

    (ENG-26000)

  - cli: The CLI Turbo Parser now accepts containers annotated with
    'tailf:cli-add-mode' together with empty tokens as a new submode.

    (ENG-25961)

  - cli: CLI incorrectly processed symlinks, in particular when a symlink
    was part of the value for '--cwd' / '-c' option passed to confd_cli,
    thus making it possible to set the working directory to an invalid
    value. Now all symlinks are internally resolved to real paths by CLI.

    (ENG-25959)

  - cli: The C-style configuration diff, for example, 'show configuration',
    after adding leaf annotated with 'tailf:cli-prefix-leaf' while modifying
    a sibling leaf annotated with 'tailf:cli-remove-before-change' is now
    rectified.

    (ENG-25955, RT:45581, PS-40698, CSCvx76165)

  - cli: The CLI does no longer ship the pre-compiled clispec file confd.ccl
    but instead include the J-style commands as true builtin commands to
    allow user-defined clispec override to take precedence.

    (ENG-25946, RT:45621, PS-40739, CSCvx75435)

  - cli: When a container violating the sequence of a
    'tailf:cli-sequence-commands' node was encountered, the CLI Turbo Parser
    would erroneously go on with the next node in the sequence instead of
    aborting the sequence. Now it aborts the sequence. If the parent node is
    also annotated with 'tailf:cli-sequence-commands', then the sequence of
    the parent is aborted too.

    (ENG-25939)

  - cli: Tags can now be set or cleared or deleted as on leaf-list data
    types using the CLI.

    (ENG-25881, RT:45255, PS-40368, CSCvx66888, SR:690795765)

  - cli: The C-style delta-diff after adding and removing elements from
    multiple leaf-lists annotated with tailf:cli-compact-syntax has been
    corrected.

    (ENG-25683)

  - cli: When a leaf is in a parent node *not* annotated with
    'tailf:cli-compact-syntax', take care not to delete the leaf, if it
    exists in the transaction, and also the current parsed token does not
    match the leaf's value.

    (ENG-25674)

  - cli: The handling of 'tailf:cli-prefix-key' annotated leafs has been
    improved in the case where these leafs are used in
    'tailf:cli-sequence-commands' annotated lists, and with a
    'tailf:cli-before-key' sub-statement. Also, leafs annotated with
    'tailf:cli-optional-in-sequence' are now causing the parent node to be
    retried, instead of skipping the parent node entirely.

    (ENG-25672)

  - cli: In the case where 'tailf:cli-allow-join-with-key' was used on a
    list, and that list also had a 'when' expression, the CLI Turbo Parser
    would erroneously skip validating the "when" expression. Now it
    validates "when" expressions before entering these submodes.

    (ENG-25671)

  - cli: When creating siblings of an empty leaf with extension
    'tailf:cli-hide-in-submode' under a parent list node with extensions
    'tailf:cli-sequence-commands' and 'tailf:cli-incomplete-command', the
    empty leaf would be wrongly appended to the list key although it was not
    set.

    (ENG-25647, RT:45129, PS-40242, CSCvx25828, SR:690649860)

  - cli: Presence containers have corrected and more valid JSON data output
    from the CLI when using the "display json" pipe command.

    (ENG-25616, RT:45043, PS-40156, CSCvx20838, SR:690403083)

  - cli: Entering the auto-wizard in the C-style CLI when configuring a
    leaf-list of the type union, containing both string and integer types,
    could fail and result in an internal error.

    (ENG-25591, RT:44990, PS-40103, CSCvx15152)

  - cli: The C-style configuration diff (e.g. show configuration) when
    deleting a leafref pointing to the parent list has been corrected in the
    case that the parent instance has been deleted.

    (ENG-25554, RT:44920, PS-40032, CSCvx08648)

  - cli: Fixed an issue in CLI Turbo Parser's tokenizer that caused quote
    signs in the middle of tokens to start recording a new token, ignoring
    the next space character.

    (ENG-25519, RT:44933, PS-40045)

  - cli: Showing an empty leaf in JSON format with the pipe command "display
    json" has been corrected.

    (ENG-25509, RT:44904, PS-40016, CSCvx01947, SR:690615369)

  - cli: The handling of operational data keyless lists was corrected to
    prevent an internal error when the display JSON target or the de-select
    target is used.

    (ENG-25501, RT:39494, PS-34572, CSCvw98947)

  - cli: Now NACM cmd rules are not checked for auto-rendered CLI commands
    when cStrictAAA is set to true.

    (ENG-25485, RT:44618, PS-39729, CSCvw96173)

  - cli: When piping data to xpath in the CLI, any information regarding
    presence containers would be ignored unless it contained more data
    beneath itself. This change makes sure the xpath information is
    displayed even if the presence container can be considered empty but
    existing.

    (ENG-25470, RT:44800, PS-39911, CSCvw92172, SR:690528176)

  - cli: When a choice with implicitly selected default option has an
    operational leaf as a descendant, and the leaf is handled by a data
    provider, "show" command on the leaf involved existence check without
    invoking the data provider resulting in incorrectly omitted leaf. Now
    the existence check is performed at a later stage of the "show" command
    execution, thus returning the correct result.

    (ENG-25456, RT:44746, PS-39856, CSCvw89236)

  - cli: When deleting a non-empty leaf with extension
    'tailf:cli-hide-in-submode' under a parent list node with extension
    'tailf:cli-incomplete-command', the leaf value did not appear with the
    list key.

    (ENG-25452, RT:44781, RT:44713, PS-39892, PS-39824, CSCvw88278)

  - cli: It is now possible to parse Unicode characters in the CLI Turbo
    Parser.

    (ENG-25359)

  - cli: Make the access "file" parameter check work for absolute paths when
    restrictedFileAccess is set to true.

    (ENG-25342, RT:44580, PS-39690, CSCvw72507)

  - cli: This fix adapts the path of 'tailf:dependency' statements, when
    they appear as children to top level 'when' statements in augmentations.
    Previously, these 'tailf:dependency' statement paths would point to each
    augmented node (since the 'when' expression is augmented to each node),
    now they will point to the augmentation's target node (or the closest
    data node ancestor). This is now adhering to part 7.21.5. of RFC 7950.

    (ENG-25329)

  - cli: When combining the 'tailf:cli-full-command' and
    'tailf:cli-drop-node-name' on a non-presence container which does not
    have 'tailf:cli-add-mode' the CLI will now fail with a syntax error in
    accordance with how the CLI completion code works. A warning is also
    raised during compilation of such a YANG module.

    (ENG-25253)

  - cli: When NACM rule forbids read access to certain ordered-by user list
    entries, it would generate incorrect rollback file content when moving
    an ordered-by user list entry due to it requires full access to all the
    ordered-by user list entries.

    (ENG-25240, RT:44437, PS-39544, CSCvw58352)

  - cli: An internal error occurred when invoking action with duplicate list
    keys.

    (ENG-25016, RT:43821, PS-38926, CSCvw19891, SR:689900906)

  - cli: Make sure the CLI triggers the 'tailf:cli-diff-delete-before' or
    'tailf:cli-diff-delete' extensions in combination with leaf-list and
    leafrefs during delete.

    (ENG-24989, RT:44086, PS-39190, CSCvw17520)

  - cli: The CLI now supports using more filters that can be passed down via
    the XPath engine to a data provider. One requirement is that a range
    expression is explicitly or implicitly used.

    (ENG-24968, RT:43427, PS-38543, CSCvw13445)

  - cli: When '/confdConfig/cli/enableLoadMergeLeafList' was set to true, it
    would break the 'load replace' operation on a leaf-list using a text
    format config file. Now 'load replace' operation will always replace the
    existing leaf-list values with the new leaf-list values loaded from a
    config file regardless of whether
    '/confdConfig/cli/enableLoadMergeLeafList' is set to true or false.

    (ENG-24806, RT:43849, PS-38956, CSCvv92061)

  - cli: No error should be produced when a presence container annotated
    with 'tailf:cli-full-no' is deleted. This is how it works in the
    'confd_cli', and now also in the CLI Turbo Parser.

    (ENG-24702, RT:43697, PS-38814, CSCvv73816)

  - cli: Correction of the auto rendering of enabled/disabled of leafs that
    have a "when" expression.

    (ENG-24587, RT:43003, PS-38117, CSCvv50455)

  - cli: The display target `xml` will now render results on CLI shared mode
    when the access to the running datastore is
    `writable-through-candidate`.

    (ENG-24585, RT:43465, PS-38582, CSCvv50121)

  - cli: Child leafs of presence containers with a mode and annotated with
    tailf:cli-show-no will now correctly display the diff in the I- and
    C-style CLIs.

    (ENG-24560, RT:43429, PS-38545, CSCvv45685)

  - cli: Prefix leafs that had the data type "enum" will now be set
    correctly in the CLI Turbo Parser.

    (ENG-24486, RT:43238, PS-38354, CSCvv25239)

  - cli: Expand command parameters correctly in CLI spec to allow for
    correct matches in NACM rules.

    (ENG-24464, RT:43095, PS-38209, CSCvv18191)

  - cli: The CLI Turbo Parser has been optimized by checking if the leaf
    cannot be correctly parsed. The parser can then retry parsing the line
    without calling the transaction engine for this leaf.

    (ENG-24393, RT:43013, PS-38127, CSCvv03568)

  - cli: Broken range-expressions would not be correctly identified in the
    CLI Turbo Parser. Instead it parsed it as it saw fit which was faulty.
    This has been fixed by identifying a broken range-expression and
    returning an error.

    (ENG-24356, RT:42897, PS-38013, CSCvu95012)

  - cli: With this fix, parsing of a 'tailf:cli-sequence-commands' node
    being aborted will propagate to the parent node, if the parent node is
    also annotated with 'tailf:cli-sequence-commands'. This causes the
    parsing of the parent node to also be aborted.

    (ENG-24268, RT:42730, PS-37846, CSCvu80787)

  - cli: Wrong data node would be picked for some usage of the
    tailf:cli-allow-join-with-key extension in combination with the
    tailf:cli-sequence-commands extension. This has been fixed in the CLI
    Turbo Parser by better identifying when certain nodes should fail and
    which node to try against instead.

    (ENG-24222, RT:42656, PS-37772, CSCvu75027)

  - cli: Fixed 'tailf:delete-when-empty' related bug. For nodes annotated
    with 'tailf:delete-when-empty' having 'list' or 'container' children in
    turn having type 'empty' leafs, deletion of these leafs would not
    cascade back to the 'tailf:delete-when-empty' node. This caused the
    'tailf:delete-when-empty' node to remain in the open transaction even
    though it should have been deleted.

    (ENG-24199, RT:42616, PS-37731, CSCvu70865)

  - cli: The CLI will now override the default-db with the operational-db
    when issuing the "show operational-state" command.

    (ENG-23398)

  - cli: The CLI does not support using 'tailf:hidden' extension on key
    leafs. Instead the extension is ignored on those locations. This has
    been made clearer in the documentation.

    (ENG-21500, RT:43411, RT:43472, RT:35923, PS-38527, PS-38589, PS-31001,
    CSCvp95854)

  - cli: A leaf annotated with 'tailf:cli-trim-default' and set to its
    default value, either explicitly or implicitly, will now be trimmed when
    displaying configuration in the table format.

    (ENG-19878, RT:35186, PS-30257)

  - cs_trans: Load configuration failed at validation phase for nested
    "choice" statements, where the inner is mandatory choice containing
    dependency node of "when" expression,  even though the inner choice
    belonged to inactive case of outer choice. The transaction engine has
    been updated to ignore the inner choice in such scenario.

    (ENG-26318, RT:45952, PS-41069, CSCvy11622, SR:691249158)

  - cs_trans: A bug caused CDB API's 'cdb_get_modifications_cli()' function
    to return incomplete results when in the CDB_SUB_PREPARE phase.

    (ENG-26004, RT:45585, PS-40702, CSCvx80857)

  - cs_trans: If there is a default leaf with "must" expression under
    non-presence container with "when" expression, the default leaf was
    always deleted if the dependency node of the "when" expression was
    changed, causing the "when" expression on the non-presence container
    evaluating to true.

    (ENG-26001, RT:45646, PS-40764, CSCvx80850, SR:691068375)

  - cs_trans: When deleting a node referenced by multiple "leafrefs" and/or
    "must" expressions only one of the constrains would be considered in the
    validation, causing validation to pass when it should actually fail. Now
    all relevant "leafrefs" and "must" expressions will be considered in the
    validation.

    (ENG-25889, RT:45717, RT:45509, PS-40832, PS-40625, CSCvx68284)

  - cs_trans: When starting a new transaction towards CONFD_INTENDED, ConfD
    was passing the datastore name incorrectly to data providers. The
    correct datastore name CONFD_INTENDED is passed instead.

    (ENG-25715, RT:45200, PS-40313, CSCvx41244)

  - cs_trans: Fixed min/max-elements validation violation for list/leaf-list
    with min/max-elements under a deleted case, and the case is created in
    the same transaction.

    (ENG-25526, RT:44927, PS-40039, CSCvx05176)

  - cs_trans: Using a trans-in-trans, e.g. started by
    maapi_start_trans_in_trans(), to change configuration that makes an
    NP-container existent (through a when dependency) and that NP-container
    in turn contains a choice with a default case, would make the
    transaction crash with an internal error.

    (ENG-25511, RT:44905, PS-40017, CSCvx02853, SR:690616861)

  - documentation: The feature option in the confdc man page has been
    updated to clarify that if the feature option is used when compiling a
    YANG module, all features defined in all modules must be listed
    explicitly if they are supported.

    (ENG-25142, RT:44281, PS-39387, CSCvw44929)

  - documentation: A leaf that is a 'tailf:secondary-index' may not also
    have a 'tailf:callpoint'.

    (ENG-25101, RT:29023, PS-9358)

  - examples: Java example process on MacOS now stops correctly. Corrected
    example intro/java/11-hooks and intro/java/12-maapi where generated
    files overwrote existing source code on case insensitive filesystem
    (MacOS).

    (ENG-26592)

  - ha: If '/confdConfig/cdb/operational/replication' is set to 'never', the
    primary no longer distributes change-set to secondary nodes.

    (ENG-27119)

  - ha: Corrected the distributed change-set from primary node to secondary
    nodes.
    Corrected the notification of subscriber to operational datastore on
    secondary nodes.

    (ENG-26374, RT:45765, PS-40880, CSCvy17408)

  - ha: Local variables were called over an HA application even though they
    were not distributed in the HA cluster. This caused a deadlock when they
    were used during HA operations. Now local variables are separated from
    HA applications.

    (ENG-26310, RT:45679, RT:46305, RT:46156, PS-40794, PS-41425, PS-41274,
    CSCvy10996)

  - ha: Transactions on the primary node would hang when a secondary node
    tried to join during the transaction commit.

    (ENG-25990, RT:45530, PS-40646, CSCvx79357)

  - ha: Previous locking order of HA applications caused a deadlock when
    sending notifications during HA operations. The lock ordering is
    corrected to prevent this deadlock.

    (ENG-25560, RT:43926, PS-39032, CSCvx09563)

  - java-api: When multiple AlarmSource instances were created, one new CDB
    subscription on the path /alarms/alarm-list/alarm was created for each
    AlarmSource instance. Now multiple AlarmSource instances share the same
    CDB subscription to the alarms list.

    (ENG-25901, RT:44968, PS-40080, CSCvx69972)

  - java-api: The toString() method in ConfBinary produced wrong string
    representations for the YANG types like tailf:hex-list and
    tailf:octet-list.

    (ENG-24223, RT:42481, PS-37594, CSCvy91098, SR:689200181)

  - json-rpc: Due to an earlier change, YANG modules explicitly exported to
    'webui' (using the --export compiler flag or the tailf:export extension
    in the module) were not accessible over jsonrpc.

    (ENG-26716, RT:46182, PS-41300, CSCvy51674)

  - json-rpc: If some existing config includes empty leafs and that config
    is replaced by new config where the empty leafs have been removed, the
    empty leafs should be deleted since the new config does not include
    those empty leafs. However, when using JSON-RPC method 'load' with mode
    'replace' to replace the config the empty leafs would still be there.

    (ENG-26085, RT:45688, PS-40803, CSCvx88495, SR:690897173)

  - json-rpc: If confd.conf(5) is loaded with any SSL parts in it, ConfD
    will not close existing SSL connections.

    (ENG-25484, RT:44396, PS-39503, CSCvw95920)

  - json-rpc: Trans-in-trans via JSON-RPC is now working.

    (ENG-25212, RT:30899, PS-27133)

  - json-rpc: JSON-RPC allowed a user to start a config exclusive
    transaction even though one already exists, which is not allowed. Now
    you instead get a "Database is locked" error when trying to do this.
    In some situations when an error occurred while starting a config
    exclusive transaction the lock was not released, so starting another
    config exclusive transaction afterwards it would fail with "Database is
    locked" error. Now the lock is released in all situations where an error
    occurs when starting a config exclusive transaction.

    (ENG-24620, RT:43531, PS-38648, CSCvv56916)

  - json-rpc: When a JSON-RPC session timed out, the
    CONFD_SESSION_TERMINATION reason was incorrectly set to "normal". Now
    instead you get the correct reason "timeout" when a timeout occurs.

    (ENG-23040, RT:40372, PS-35452, CSCvs72025)

  - json-rpc: XPaths which deref into an absolute path will now be
    normalized to remove any remaining parent steps that follows the deref
    statement. For example, the leafref path
    'deref(../some-leaf)/../../bar/baz', with the expanded deref
    '/foo:foo/fizz/buzz', will now be correctly compiled to
    '/foo:foo/bar/baz' instead of '/foo:foo/fizz/../bar/baz'.

    (ENG-22029, RT:41387, RT:44003, PS-36457, PS-39107)

  - kickers: If /kickers/data-kicker/action-name is non-existent, then the
    error will be logged in the devel.log

    (ENG-21037, RT:36862, PS-31944, CSCvp12427)

  - logging: Re-opening of error logs no longer leaves unlinked open files.

    (ENG-25740, RT:45286, PS-40399, CSCvx46430)

  - netconf: The 'periodic' parameter in operation modify-subscription did
    not take proper effect resulting in that notifications were still sent
    in the same periods as was set in the initial establish-subscription.
    Now modify-subscription handle the 'periodic' parameters properly and
    thus the periods of sent notification are updated accordingly.

    (ENG-26782, RT:46348, PS-41467, CSCvy60021, SR:691362140)

  - netconf: An issue in YANG-Push that led to failures to generate XML
    results for operational data of augmented nodes.

    (ENG-26737, RT:46303, PS-41423, CSCvy53567)

  - netconf: In some circumstances where several levels of 'choice' and
    'case' are used in the YANG module, an incorrect namespace was used.
    This fix makes it so that the correct namespace is used, leading to the
    expected response from an edit-config operation.

    (ENG-25614, RT:45082, PS-40195, CSCvx20041)

  - netconf: A rare case where the TCP handler would not react to a closing
    socket has been identified and is now reacted to, allowing the handler
    to terminate.

    (ENG-25572, RT:42375, RT:44236, RT:44988, PS-37485, PS-39342, PS-40101,
    CSCvx13338)

  - netconf: NETCONF sessions crashed when generating content for YANG-Push
    notifications.

    (ENG-25426)

  - netconf: During introduction of new SSH server code a socket option was
    left out, which caused a decrease in the connection acceptance rate.
    This has been fixed by reintroducing the option.

    (ENG-24796)

  - netconf: NETCONF validate config returned OK even when it broke the
    max-element constraint. Now you instead get the expected "too many
    elements" error.

    (ENG-24358, RT:42858, PS-37974, CSCvu95279)

  - netconf: An action was allowed to be executed despite an existing deny
    read access NACM rule. A check for the action having read authorization
    was missing. A check has now been added and a matching deny read access
    NACM rule will reject the invocation of the action as expected.

    (ENG-23851, RT:43031, RT:42066, PS-38145, PS-37168, CSCvu18469)

  - netconf: ConfD refuses to create requests with wd:default="true" for non
    default value leaf-list data, in accordance with RFC 6243: "If the
    'default' attribute is present and set to 'true' or '1', the data node
    within the NETCONF message MUST contain a value in this case, which MUST
    be equal to the schema default value. If not, the server MUST return an
    <rpc-error> response with an 'invalid-value' error-tag."

    (ENG-23815)

  - netconf: Previously the XML payload with default attribute was rejected
    when it contained "0" or "false". Now if the server supports
    'report-all-tagged' mode, the XML payload with default attribute allows
    all data types 'boolean' according to RFC 6243.

    (ENG-23758)

  - netconf: A performance difference was seen between inline and URL
    copy-config operation requests. The URL case did some superfluous
    deletes which now have been removed. Also, the URL referred to a file
    and the file read buffer has been doubled in size.

    (ENG-21860, RT:38116, PS-33191, CSCvq79753)

  - python-api: The Python maagic API now allows creation of entries in
    persistent keyless oper (config false) lists. It was previously only
    possible on in-memory lists, such as those used for action_input /
    action_output.

    (ENG-24983, RT:44022, PS-39126, CSCvw19722)

  - restconf: Add "error-app-tag" information for error RESTCONF response.
    Correct value for "error-tag" in the error RESTCONF response according
    to appendix-A in RFC-6241 and RFC-8040.

    (ENG-26924, RT:46211, PS-41329, CSCvy76436, SR:691088314)

  - restconf: If the input parameter for an action was a list and the list
    keys were not in schema order the action resulted in an error stating
    that one of the keys is a 'missing element'. This correction makes the
    order of the keys insignificant and the action can be invoked as
    expected.

    (ENG-26773, RT:46360, PS-41479, CSCvy58524, SR:691535543)

  - restconf: Huge queries towards the RESTCONF Query API could cause a race
    condition that led to a process being killed before it had completely
    finished processing the query, which led to an internal error.

    (ENG-26527, RT:46811, RT:45942, PS-41929, PS-41059, CSCvy29808,
    SR:691180091)

  - restconf: A request towards an instance which does not exist did not
    emit an error payload, only an HTTP 404 status code. Now a corresponding
    error payload is emitted when instances are not found.
    Error payloads were also not emitted for missing API resource, DELETE of
    non-existent data, or non-existent list instance in action input. Now
    error payloads are emitted for these cases as well.

    (ENG-26369, RT:45997, PS-41114, CSCvy49809, SR:691047424)

  - restconf: Only HEAD, GET and OPTIONS methods are allowed for operational
    data.

    (ENG-25861, RT:45199, PS-40312, CSCvx64652)

  - restconf: For a list in JSON format, an error occurred when list keys
    were placed in another order than found in the YANG module. This
    correction makes it possible to place the keys in any order of choice.

    (ENG-25816, RT:45422, PS-40536, CSCvx59543, SR:690910969)

  - restconf: A 'yang-patch' request for a non-exist resources will throw
    '404 NOT FOUND' error.

    (ENG-25675, RT:45102, PS-40215, CSCvx32190, SR:690636927)

  - restconf: Before, a RESTCONF request with a JSON payload containing a
    node with a name starting with an underscore would cause an internal
    error. This is from the legacy REST implementation where names starting
    with underscore were treated like attributes. This old behavior has now
    been changed to allow node names starting with an underscore.

    (ENG-25610, RT:44255, RT:44999, PS-39361, PS-40112, CSCvx19034)

  - restconf: The depth parameter now follows RFC-8040, meaning that the
    requested data node has a depth level of "1". If the "fields" parameter
    (Section 4.8.3) is used to select descendant data nodes, then these
    nodes and all of their ancestor nodes have a "depth" value
    of "1".

    (ENG-25222)

  - restconf: RESTCONF requests which does not contain a supported
    'event-stream' media type in the 'Accept' header will return '406 Not
    Acceptable'.

    (ENG-24398)

  - restconf: RESTCONF POST requests now correctly handles empty JSON
    payloads.

    (ENG-22324)

  - rollback: Rolling back multiple files that contains discarded-changes
    due to NACM rules prohibiting access, no longer result in an internal
    error.

    (ENG-26833)

  - security: SSH "diffie-hellman-group18-sha512" key exchange algorithm has
    been removed from server offers. SSH "curve25519-sha256",
    "ecdh-sha2-nistp256", "ecdh-sha2-nistp384", "ecdh-sha2-nistp521" key
    exchange algorithms are added. SSH "aes128-gcm@openssh.com",
    "chacha20-poly1305@openssh.com" encryption algorithms are added.

    (ENG-25774)

  - snmp-agent: DateAndTime SNMP objects that are assigned without a
    timezone given will have the local timezone.

    (ENG-22770, RT:39922, PS-34999, CSCvs29275)

  - toolchain: The utility confd_cmd no longer outputs tmp files if TEST_DIR
    is set.

    (ENG-26987, RT:46702, PS-41819, CSCvy91586)

  - toolchain: A list with a validation callback that had a deviation,
    caused the callback to be called twice.

    (ENG-25726, RT:45243, PS-40356, CSCvx43823)

  - toolchain: According to RFC 7950, statements in a deviation should be
    evaluated where they occur in the deviating module. Previously yanger
    and confdc have been less strict in enforcing this. This means that any
    prefixes or typedef names used in deviating statements must be found in
    that same module.
    If unknown names or prefixes are encountered, a warning will be issued.

    (ENG-25448, RT:44679, PS-39790, CSCvw87723)

  - toolchain: Previously the 'confd_cmd' sub-command 'dump_schema NODE'
    erroneously printed out succeeding siblings to NODE.
    Now only the specified node and its children are printed.

    (ENG-25445, RT:44716, PS-39827, CSCvw86665)

  - toolchain: Some customer modules are excluded from the optimization for
    leafref handling that was introduced with ENG-21146.

    (ENG-25129, RT:44289, PS-39395, CSCvw39503)

  - toolchain: 'confdc' will pre-evaluate an xpath expression to determine
    if it is a static 'true' or 'false'.

    (ENG-23908, RT:45764, PS-40879)

  - upgrade: An 'out-of-service' upgrade no longer removes
    '/kickers/data-kicker/kick-node'.

    (ENG-26533, RT:46124, PS-41241, CSCvy30896, SR:691391465)

  - upgrade: Improved performance of schema upgrade.

    (ENG-25964, RT:45594, PS-40711, CSCvx79647, SR:691043336)

  - upgrade: If the client triggered to upgrade in 'read-only' mode (by
    using 'maapi_set_readonly_mode()'), the system would abort due to an
    internal error. Now the system gently returns an error message in that
    case.

    (ENG-25956, RT:45615, PS-40733, CSCvx76580, SR:690962977)

  - web-server: If an HTTP/1.1 RESTCONF client does not send a
    'Connection:close' header, it would result in NSO keeping a socket open
    which eventually lead to an internal error entry being logged in the
    error log.

    (ENG-25741, RT:45288, PS-40401, CSCvx46503, SR:690819658)

  - xpath: If XPath has predicate containing relative child with prefix, and
    the relative child is a modifying list node, then the system crashed
    with an internal error when evaluating such XPath expression. Now, the
    system has been updated to handle that XPath correctly.

    (ENG-26912, RT:46518, PS-41632, CSCvy74884)

  - xpath: XPath engine is now able to optimize queries on lists when the
    predicate is using varbinds.

    (ENG-26429)

  - xpath: The system failed to convert XPaths pointing to leaf-list entries
    with values containing whitespaces. For example, the XPath
    /leaf-list[.='foo bar'] has been updated to convert that XPath
    correctly, i.e /leaf-list{"foo bar"}, and not to an invalid leaf-list
    entry, i.e /leaf-list{foo, bar}.

    (ENG-26039, RT:45700, PS-40815, CSCvx84375)

  - xpath: Fixed an internal error when evaluating a XPath filter across a
    mounted-point.

    (ENG-26037, RT:45631, PS-40749, CSCvx84255, SR:691060045)

  - xpath: The XPath engine didn't respect "when" expressions when it was
    traversing the schema tree. This could lead to unnecessary read
    operations, with greater impact for users of external data providers.
    The XPath engine has been updated to evaluate "when" expressions before
    traversing subtrees to eliminate unnecessary calls to the data provider.

    (ENG-24568, RT:43311, PS-38427, CSCvv46804)

  - xpath: The performance of XPath queries was inadvertently reduced with
    the introduction of progress tracing in ENG-17693. The performance is
    now restored to the level before progress tracing was introduced.

    (ENG-24406, RT:42793, PS-37909, CSCvv44474)

  - xpath: Evaluating an XPath expression containing current() function on a
    leaf-list gave incorrect result, for example "current()[1] = 'value';".
    The system has been updated to give correct result when evaluating such
    XPath expressions.

    (ENG-22365, RT:39303, PS-34378, CSCvr72407)


ConfD-7.5 [January 21, 2021]
============================

Deprecated:

  - cli: The 'confd.conf' parameter
    '/confdConfig/cli/turboParser/reportNoExists' has been deprecated. Also
    the default value has changed from 'false' to 'true' to harmonize with
    how the ConfD CLI works.

    (ENG-24619, RT:43540, PS-38657, CSCvv56723)

  - python-api: Python 3.5 has been deprecated and will be removed in ConfD
    7.7. You should upgrade your Python environment and make sure everything
    works with Python 3.7 or higher.

    (ENG-24807)

Removals:

  - python-api: Changed minimum supported Python version from 3.4 to 3.5.
    With this release Python 3.5 support is deprecated as no more Python 3.5
    releases will be made.

    (ENG-21624)

  - toolchain: The deprecated tailf:symlink statement has been removed.

    (ENG-24522)

Non-backwards compatible enhancements:

  - confd: Encrypted strings that is of type
    tailf:aes-256-cfb-128-encrypted-string starting with "$", are now
    accepted as input.
    This reverts the earlier change that rejected such input, as this caused
    issues with how some devices handles strings.

    (ENG-24718)

  - confd: The YANG types inet:ipv6-address, inet:ipv6-prefix and
    tailf:ipv6-address-and-prefix-length will render IPv4-mapped IPv6
    addresses in mixed notation - ie., ::ffff:102:304 will be rendered as
    ::ffff:1.2.3.4

    (ENG-24390, RT:42786, PS-37902, CSCvw28183, SR:689310215)

  - cdb: When individual entries upgrade successfully, but results in an
    invalid list, all list entries will be deleted. This can happen, e.g.,
    when an upgrade removes a leaf from the key, resulting in several
    entries having the same key.

    (ENG-24495)

  - cdb: Loading of FXS files now detect duplicate modules sharing the same
    namespace and aborts loading. Loading consistency has been further
    improved by loading files within a single load directory in lexical
    order.

    (ENG-23989, RT:42289, RT:28070, PS-37388, PS-8946, CSCvu43088)

Non-backwards compatible corrections:

  - confd: Encrypted strings that are of types
    tailf:aes-256-cfb-128-encrypted-string,
    tailf:aes-cfb-128-encrypted-string and tailf:des3-cbc-encrypted-string
    starting with "$", are now accepted as input.
    This reverts the earlier change that rejected such input, as this caused
    issues with how some devices handles strings.

    (ENG-24075, RT:42704, PS-37820)

  - ha: Removed audit log entry for terminated sessions with system context.
    The log entry was added for sessions which exited without calling
    end_session.

    (ENG-24878, RT:43212, PS-38327, CSCvv99917)

  - json-rpc: Multiple calls, sent in an array to the JSON-RPC, are now made
    in the order they are written in the array (not in backward order). The
    change in behavior can be observed when creating new items last in an
    ordered-by user list, and in logs.

    (ENG-23763, RT:41885, PS-36979, CSCvu03471, SR:688938362)

  - rest-api: In certain circumstances the removal of indentation spaces
    were neglected. Now each increment of indentation spaces have a
    corresponding decrement.

    (ENG-25113, ENG-25115)

  - restconf: In certain circumstances it was possible that elements were
    dropped for the XML output format. Now elements are not dropped and are
    emitted as expected.

    (ENG-21816, ENG-25112, RT:38276, PS-33345, SR:687136729)

  - restconf: The RESTCONF server required identityref value and objectref
    value to be prefixed by namespace prefix in the request URI. That is not
    in compliant to section 3.5.3.1 of RFC8040. Now, the RESTCONF server has
    been updated to only accept identityref value and objectref value that
    prefixed by module name.

    (ENG-24274, RT:42632, PS-37748, CSCvu81052)

  - restconf: For streaming replies an error was added as part of the
    stream, resulting in a syntactically incorrect XML/JSON. Now if an error
    occurs the stream will be abruptly closed without sending any
    terminating empty chunk.

    (ENG-22683, RT:42457, RT:39778, PS-37569, PS-34854, CSCvs42623,
    SR:687934134)

  - restconf: A RESTCONF request missing the 'Host' header now responds with
    a 400 Bad Request, not a 500 Internal Server Error.

    (ENG-22349)

  - toolchain: In order to comply with both RFC 6020 and RFC 7950, confdc
    now returns an error instead of a warning if a constraint on a config
    true node contains an XPath expression that refers to a config false
    node.

    (ENG-24521)

  - toolchain: When confdc was called with --emit-mib without a --top
    argument it crashed, now the name of the module is used as the default
    value for top.

    (ENG-16794, RT:29700, RT:30171, PS-9688, PS-9920)

  - toolchain: A leaf with tailf:snmp-delete-value will have the range
    extended with that value conforming with the documentation.

    (ENG-16385, RT:28150, PS-8983)

  - toolchain: When converting an SNMP MIB with DEFVAL, the YANG model did
    not contain a corresponding default value. Some conversions are still
    not supported since YANG is more strict in types allowed.

    (ENG-16348, RT:21967, PS-7004)

Enhancements:

  - confd: The evaluation of 'when' expressions during the calculation of
    C-style configuration diffs (e.g. 'show configuration') has been
    optimized, which should result in a faster diff-calculation for some
    use-cases where the expression is independent of the context node.

    (ENG-24365, RT:42899, PS-38015, CSCvu96970, SR:689441701)

  - confd: ConfD error log is now reopened on reception of reopen_logs
    command.

    (ENG-23441)

  - confd: It is now possible to configure explicit source IP addresses for
    NETCONF call home and for NETCONF copy-config RPC leading to uploads of
    XML using sftp or ftp URL.
    These are all separately configurable:
    /confdConfig/netconf/capabilities/url/ftp/sourceAddress
    /confdConfig/netconf/capabilities/url/sftp/sourceAddress
    /confdConfig/netconf/transport/sshCallHomeSourceAddress


    (ENG-21467, RT:37552, PS-32629)

  - confd: Add a filter to data kickers for excluding either configuration
    (config true) or operational data (config false) from triggering the
    kicker. When the filter is applied to a data kicker the changes
    underneath the monitored node will be filtered so that the excluded data
    will not trigger the kicker.

    (ENG-17135)

  - confd: When the configuration file is reloaded, the changes that have
    taken place are logged to the daemon log.

    (ENG-16589)

  - cdb: Reduce the time it takes for ConfD to reclaim memory after
    performing cdb-backup.

    (ENG-23633, RT:41573, PS-36658, CSCvt73379)

  - cli: Replace internal error with more specific and clear error message
    in the case of loading XML formatted config file containing invalid
    operation.

    (ENG-24841, RT:43875, PS-38980, CSCvv94739)

  - cli: Turbo parser: Implemented 'tailf:cli-max-words'. This also fixes an
    internal error occurring when 'tailf:cli-max-words' CLI config was
    parsed.

    (ENG-24614)

  - cli: Turbo: The 'confd.conf' parameter
    '/confdConfig/cli/allowCaseInsensitiveEnums' has been implemented in the
    Turbo parser.

    (ENG-24384, RT:42996, PS-38110, CSCvv01843)

  - cli: Turbo parser: Nodes parsed during 'tailf:cli-sequence-commands'
    mode which fail, are now accepted if their parent node is annotated with
    'tailf:cli-optional-in-sequence'.

    (ENG-24302)

  - cli: Turbo parser: Implemented MAAPI_CONFIG_CONTINUE_ON_ERROR.

    (ENG-24265, RT:42726, PS-37842)

  - cli: Turbo parser: The parser can now detect and create leafs with
    'tailf:cli-drop-node-name' and 'type empty' during
    'tailf:cli-sequence-commands' mode. This means those leafs are created
    without any token being consumed.

    (ENG-24226, RT:42671, PS-37787, CSCvu75688)

  - cli: The comment parsing in the Turbo parser has been modified such that
    an exclamation mark now needs to appear as the first non whitespace
    character on a line in order to be counted as a comment.

    (ENG-24169, RT:42565, PS-37679, CSCvu67240)

  - cli: Turbo parser: Implemented 'tailf:cli-incomplete-no '.

    (ENG-24081, RT:42471, PS-37584, CSCvu56182)

  - cli: Turbo: Added syntax error reporting.

    (ENG-24020, RT:42394, PS-37504, CSCvu48041)

  - cli: The setting /confdConf/cli/preserveSemicolon has been introduced to
    enable the ability to preserve semicolon as an ordinary char instead of
    using the semicolon as a keyword to separate CLI statements in the I-
    and C-style CLI.

    (ENG-23572)

  - cli: Performance has been improved when displaying J-style configuration
    diffs for those cases where the change set was small compared to the
    schema.

    (ENG-23135, RT:40536, PS-35615, CSCvs86383, SR:688304979)

  - cli: The CLI can perform filtering of data when displaying JSON-data
    output

    (ENG-22436, RT:41166, RT:39419, RT:41166, PS-36241, PS-34496, PS-36231,
    CSCvr84175)

  - cs_trans: A better garbage-collect change-set before validation phase.
    This helps ConfD to not invoke validation on unchanged nodes.

    (ENG-23285, RT:40807, PS-35903, CSCvt08018)

  - documentation: Updated Python API documentation pages to a new format
    and corrected inconsistencies with actual Python code.

    (ENG-24865)

  - documentation: The User Guide has been updated with the new section on
    filtering in CLI

    (ENG-24321)

  - documentation: Add new section to the YANG chapter on caveats using
    union together with ConfD.

    (ENG-23923, RT:42145, PS-37246, CSCvu30511, SR:689022946)

  - examples: Added python version of simple validation example.

    (ENG-24589)

  - examples: Added a generic data provider example under
    examples.confd/dp/generic_perf targeting optimal wall-clock time
    performance.

    (ENG-22440)

  - java-api: The following methods have been added to
    com.tailf.maapi.Maapi:
    CLIAccounting
    CLICmdToPath
    CLIDiffCmd
    CLIPathCmd
    copyPath
    deleteAll
    disconnectSockets
    getAuthorizationInfo
    getUserSessionIdentification
    getUserSessionOpaque
    reopenLogs
    setNextUserSessionId
    validateToken
    The method Maapi.copy_tree has been deprecated. Use copyTree instead.

    (ENG-23653, RT:41655, PS-36741, CSCvt76465, SR:688483043)

  - json-rpc: get_leafref_values now takes in a 'starts_with' and a 'limit'
    parameter. 'starts_with' can be set to filter out values that do not
    start with a specific prefix. 'limit' can be set to limit the number of
    returned values.

    (ENG-24346)

  - json-rpc: The JSON-RPC method validate_trans and validate_commit now has
    an extra parameter when_error_mode:
      * Valid values: silent_delete, error
      * Default value: silent_delete
    When the parameter when_error_mode is set to error, the validation can
    fail if there is any configured node that has a when-expression
    evaluating to false, or if there is any configured node having a parent
    containing a when-expression evaluating to false.

    (ENG-23980, RT:42284, PS-37383, CSCvu40956, SR:688950166)

  - netconf: SSH client code upgraded for multiple services: CLI, Netconf,
    SCP and SFTP. Code for Call Home is kept at the previous SSH version and
    will be upgraded in an upcoming release.

    (ENG-24583, RT:43714, PS-38831)

  - netconf: Added experimental support for subscription to
    push-change-update notifications on operational datastore in YANG-Push
    (RFC 8641). Experimental means that some of the newly added API, code
    and behaviour may change in the future. For detailed information see
    relevant sections in ConfD User Guide.

    (ENG-23018)

  - python-api: New functions in the Python API, _confd.cdb.cs_node_cd() and
    _confd.maapi.cs_node_cd() that provide mount point safe versions of the
    _confd.cs_node_cd() function.

    (ENG-24266, RT:42714, PS-37830, CSCvu80609)

  - restconf: The configuration option "keepalive" has been added to webui
    transports. This, in conjunction with configuration of the TCP keep
    alive feature of the OS, allows CLOSE_WAIT connections to be detected
    and removed by the OS.

    (ENG-24011, RT:43256, RT:42283, PS-38372, PS-37382, CSCvu46989,
    SR:689141769)

  - restconf: Added /confdConfig/restconf/showHidden (default: false).
    Setting this to 'true' unhides hidden nodes accessed via RESTCONF.

    (ENG-18844, RT:33373, RT:38583, PS-28824, PS-33655)

  - snmp-agent: ConfD terminated when attempting to send SNMP notifications
    when the ConfD system clock was incorrect and developerLogLevel was set
    to "trace". Now ConfD will not terminate and the sending failure will be
    logged in the developer log.

    (ENG-21707, RT:37933, PS-33007, CSCvq40857)

Corrections:

  - confd: Progress trace event types in NETCONF and RESTCONF APIs has been
    corrected.

    (ENG-25328)

  - confd: Stop progress events are now outputted when validation fails for
    a transaction.

    (ENG-25233)

  - confd: Progress trace spans without matching stop events have been
    fixed.

    (ENG-25172)

  - confd: Calling the maapi function MAAPI_ROLL_CONFIG will now get
    configuration data using tailf:alt-name extension if it is present.

    (ENG-25066, RT:44184, PS-39290, CSCvw28398, SR:690146886)

  - confd: in rare cases ConfD could get stuck on startup when the
    notification replay store only consisted of two files and one was empty
    (without header).

    (ENG-24879, RT:44270, RT:43926, RT:42636, PS-39376, PS-39032, PS-37752,
    CSCvw00534)

  - confd: Fixed a crash that occurred when deleting a list entry where the
    key was of type identityref.

    (ENG-24851, RT:43898, PS-39004, CSCvv95859, SR:689887682)

  - confd: Sometimes FIPS mode failed to activate when enabled. This has
    been corrected.

    (ENG-24767, RT:43734, PS-38851, CSCvv83726)

  - confd: Initial validation of a must expression depending on a leaf with
    its default value in effect residing under a newly created list instance
    would fail. This issue was caused by the new list filter feature
    introduced in ConfD 7.1.

    (ENG-24705, RT:43670, PS-38787, CSCvv74316)

  - confd: Creating several subscriptions after each other with 'replay'
    enabled could cause a deadlock. The critical section is now removed by
    refactoring and the deadlock cannot occur.

    (ENG-24693, RT:43410, PS-38526, CSCvv71073, SR:689726811)

  - confd: Clients were unable to start new transactions when the
    transaction id limit INT32_MAX (2147483647) had been reached. Now ConfD
    will restart with the lowest free number.

    (ENG-24557, RT:42991, PS-38105, CSCvv44589)

  - confd: ConfD no longer crashes when '/' is used in a dependency path or
    keypath for a policy script.

    (ENG-24543, RT:42986, PS-38100, CSCvv41837, SR:689411186)

  - confd: Support setting the instance-identifier node pointing to a
    leaf-list entry as defined in Section 9.13.4, RFC 7950.

    (ENG-24485, RT:43356, RT:43552, RT:43185, PS-38472, PS-38669, PS-38300,
    CSCvv24960)

  - confd: Increased possible output size for all external AAA programs;
    externalauth, externalvalidation and externalchallenge.
    The old limit was 4000 bytes, the new limit is 16000 bytes.

    (ENG-24257, RT:42650, PS-37766, CSCvu79807, SR:689299770)

  - confd: The length of the allowed XML processing instructions can now be
    configured via /confdConfig/parserLimits/maxProcessingInstructionLength.
    The default length is 32kB.

    (ENG-24192, RT:43023, RT:43089, RT:42731, RT:42871, PS-38137, PS-38203,
    PS-37847, PS-37987)

  - confd: When combining tailf:cli-flatten-container extension, choice-case
    and empty leafs the turboparser wouldn't always register that the leaf
    was connected to the whole line. This has been corrected by letting the
    tailf:cli-flatten-container decide when the line is complete or not.

    (ENG-24184, RT:42596, PS-37708, CSCvu69416)

  - confd: Added support for empty leaves inside a case/choice. Allow
    multiple leaves to be set with a single set of command line tokens
    without requiring compact-syntax extension.

    (ENG-24156, RT:42562, PS-37676, CSCvu65672)

  - confd: Syslog messages are now truncated to 16384 bytes (max size of
    syslog messages over TCP)

    (ENG-24109, RT:42130, PS-37232, CSCvu60254)

  - confd: ConfD no longer print progress trace events in the CLI when an
    action is interrupted.

    (ENG-24042)

  - confd: If a set hook was invoked from an action that was attached to an
    existing transaction, the hook would fail. Now the set hook works as
    expected.

    (ENG-22995, RT:43261, RT:40219, RT:40305, PS-38377, PS-35298, PS-35385,
    SR:688122264)

  - confd: The algorithm that generates unique integer values for YANG
    identifiers has been modified to generate a different value for
    "lldp-remote-chassis-id-subtype" and "graceful-restart-restart-time" to
    avoid conflicts.

    (ENG-22304, RT:39292, PS-34367)

  - aaa: Corrected MAAPI save-config to only need read access right.
    The MAAPI_CONFIG_READ_WRITE_ACCESS_ONLY bit flag has been introduced for
    backwards compatible.

    (ENG-20498, ENG-24105, RT:36177, RT:42466, PS-31255, PS-37579, CSCvu59830)

  - aaa: If there existed two NACM delete rules with the same path, where
    the first rule had a 'permit' action and the second rule had a 'deny'
    action; the result was wrongly: deny.

    (ENG-23883, RT:43213, RT:42033, PS-38328, PS-37133, CSCvu23903)

  - cdb: Corrected the order of list entries in pre_commit_running datastore
    when there are modifying- and deleting list entries and the list is
    ordered-by-user.

    (ENG-25035, RT:44153, PS-39257, CSCvw25262)

  - cdb: confd --cdb-debug-dump in XML format no longer generate invalid
    output for nodes after a leaf-list where the nodes after was output in
    the parent container.

    (ENG-24680, RT:43524, PS-38641, CSCvv68589)

  - cdb: cdb_vget_values() updated to not return default values for leaves
    under previously inactive cases.

    (ENG-24576, RT:43353, PS-38469, CSCvv48363)

  - cdb: During a schema upgrade transaction, if there is also a ConfD
    upgrade from a version lower than 7.1 to a version equal to or higher
    than 7.1, using the CDB API to read from the database with the old
    schema could cause a EOF error to be returned and the relevant socket to
    be closed. The problem was due to a non-backward compatible change
    introduced on when-statement internal encoding. Now the old encoding is
    handled correctly.

    (ENG-24478, RT:43186, RT:43125, PS-38301, PS-38239, CSCvv23169)

  - cdb: Erroneously calling next_index() on a node which is not of type
    list or leaf-list caused ConfD to close the connection to the client.
    Now ConfD will return the error "next_index() not allowed on given node
    type" and keep the connection intact.

    (ENG-24460, RT:43125, PS-38239, CSCvv17280, CSCvv23168)

  - cdb: The protocol operation <kill-session> now waits for transactions
    and candidate commit to finish before returning success. If clean up
    takes more than 4 seconds an error will be returned and clean up
    continue in the background. Before this change <kill-session> could
    return ok before resources had been cleaned up which in turn could lead
    to errors on following requests.

    (ENG-24429, RT:43076, PS-38190, CSCvv12194)

  - cdb: Extra protection is introduced to protect database from corruption
    when tailf:cdb-oper erroneously is used under a non-persistent node.

    (ENG-24421)

  - cdb: Corrected the order of an ordered-by-user list or leaf-list in
    PRE_COMMIT_RUNNING database. Also corrected missing data under deleted
    ordered-by-user list instance caused by ENG-22494.

    (ENG-24348, RT:41740, PS-36831)

  - cdb: Corrected an upgrade scenario when ConfD allowed mandatory choice
    without any child node to be committed.
    The upgrade transaction now fails and reports missing mandatory choice.

    (ENG-24301, RT:42756, PS-37872, CSCvu83990)

  - cdb: cdb_get_modifications() could crash when run on secondary nodes due
    to missing changeset details from the primary node. Secondary nodes now
    operate on a separate transaction based on the changes.

    (ENG-24157, RT:42557, PS-37671, CSCvu66121)

  - cdb: The upgrade transaction has been updated with delayed_when mode.
    This means all when-expressions are treated as evaluating to true and
    ConfD evaluates all when-expressions once entering phase1.

    (ENG-24119, RT:42458, PS-37570, CSCvu61240, SR:689183100)

  - cdb: In case there are multiple subscribers to the same NP-container,
    list key or node with default value, then if the first subscriber is
    interrupted or unsubscribed, all other subscribers would no longer
    receive any notifications. The CDB subscription has been updated to fix
    this case. Now, an interrupted subscriber does not affect other
    subscribers.

    (ENG-23961, RT:42279, PS-37378, CSCvu38946)

  - cdb: ConfD migration from 6.4 or older to 6.7 or newer now handles enum
    value changes in leaf-lists.

    (ENG-23853, RT:41919, PS-37014, CSCvu19427)

  - cdb: CDB is now updated in the COMMIT phase before any subscribers are
    invoked. This leads to faster aborts and non-committed changes not being
    visible.

    (ENG-20088, RT:39232, RT:34940, RT:36281, PS-34306, PS-30008, PS-31360)

  - cdb: A list containing several keys could lose instances at an upgrade
    if the key order was changed. Fix now asserts no instances are lost
    during upgrade.

    (ENG-18879, RT:33448, PS-28898)

  - cli: Actions with input parameters that are lists with sibling leaves
    will now prioritize TAB-completion to the key-leaf prior to any other
    leaves.

    (ENG-25207, RT:43855, PS-38960, CSCvw53629, SR:689920040)

  - cli: Turbo parser: Cases in choices in nodes annotated with
    'tailf:cli-sequence-commands' are now filtered to avoid failing at
    hidden child nodes.

    (ENG-25151, RT:44332, PS-39439)

  - cli: A system message is designed to be delayed until the user
    terminates any ongoing command. If ConfD receives too many system
    messages during an ongoing command, the corresponding CLI process may
    choke and slow down throughput which, in turn, causes memory to grow
    over time. A system message is now sent to the corresponding CLI process
    only if there are less than 1000 unacknowledged system messages in the
    queue. The message is discarded otherwise. If the system relies on
    messages still being delivered,  then priority messages might be a more
    suitable solution.

    (ENG-25064, RT:43385, PS-38501, CSCvw28108)

  - cli: Executing command "show | compare" on a leaf-list in Juniper style
    caused an internal error.

    (ENG-24736, RT:39702, RT:43618, PS-34777, PS-38735, CSCvv78649)

  - cli: Having multiple target-trigger sub-statements (such as
    tailf:cli-when-target-set) in a single diff-dependency from the
    tailf:cli-diff-after/tailf:cli-diff-before group of diff-dependencies
    would cause all but one of the target-triggers to be disregarded during
    the calculation of C-style configuration diffs.

    (ENG-24627, RT:43518, PS-38635, CSCvv58132)

  - cli: Executing "show" command caused an internal error when it was piped
    to "context-match" command or when both confd.conf parameter
    '/confdConfig/cli/tableLabel' and
    '/confdConfig/cli/showTableLabelsIfMultiple' were set to "true".

    (ENG-24624, RT:43749, RT:43448, PS-38866, PS-38565, CSCvv57705)

  - cli: The /confdConf/cli/completionShowMax setting limits how many values
    that are displayed at completion of leaf-refs. Unfortunately it did also
    limit which values that were allowed to be set when prompted for a
    value, but it is now corrected.

    (ENG-24517, RT:43017, PS-38131, CSCvv33661, SR:689316157)

  - cli: When deleting siblings of an empty leaf with extension
    'tailf:cli-hide-in-submode' under a parent list node with extensions
    'tailf:cli-sequence-commands' and 'tailf:cli-incomplete-command', the
    empty leaf did not appear with the list key.

    (ENG-24515, RT:43160, PS-38274, CSCvv33620, SR:689544716)

  - cli: When the CLI is using its auto-wizard and starts prompting for
    input the input value was not always logged in the audit-log. If it was
    logged it was not always suppressing the value in case it should have.
    Now we assert values are suppressed and identifying where the CLI was
    missing out on producing audit-log entries.

    (ENG-24509, RT:43273, PS-38389, CSCvv31098)

  - cli: Looking at the 'show configuration' output in the CLI after
    changing case from a container with 'tailf:cli-add-mode' annotation,
    would incorrectly list the container as deleted. This is incorrect and
    now only the new case is shown.

    (ENG-24455, RT:43067, PS-38181, CSCvv16433, SR:689467291)

  - cli: Turbo parser: Resolved issue causing the parser to accept non
    matching child 'container'/'list' if it was not annotated with
    tailf:cli-sequence-commands, but its parent was.

    (ENG-24446, RT:43107, PS-38221, CSCvv13717)

  - cli: When CLI calculated diff configuration, it wrongly emitted deletion
    commands towards unmodified sibling data nodes before it created the new
    data node in the case that the parent was a non-flat mode-less presence
    container.

    (ENG-24444, RT:42005, PS-37105)

  - cli: Running a filtering show command would not display any matches if
    the filter contained a wildcard as part of the key value and the key was
    of the type identityref.

    (ENG-24387, RT:42669, PS-37785, CSCvv02126)

  - cli: Turbo parser: Corrected a case where a type 'empty' leaf, with a
    default value (that was not explicitly configured) caused the deletion
    behaviour to be different from that of the regular ConfD CLI.

    (ENG-24385, RT:43000, PS-38114, CSCvv01876)

  - cli: tab-completing a path for the C-style 'no' command, where path
    contained a wildcard and one of the children to the current node was a
    leaf named 'enable', would in some cases cause an internal error.

    (ENG-24326, RT:42823, PS-37939, CSCvu89180)

  - cli: The C-style operational command 'show running-config' where the
    show filter consisted of multi-level nested lists (where each list had
    multiple keys) would not produce the correct result if the filter
    contained partial keys at the beginning of the the filter.

    (ENG-24306, RT:40748, PS-35844, CSCvu84795)

  - cli: Turbo: The support for 'tailf:cli-incomplete-command' and
    'tailf:cli-full-command' has been improved. This includes a bugfix for
    the case where a list with 'tailf:cli-drop-node-name',
    'tailf:cli-incomplete-command', 'tailf:cli-sequence-commands' and
    'tailf:cli-compact-syntax' would previously be accepted even though the
    config entered was supposed to violate 'tailf:cli-incomplete-command'.

    (ENG-24298, RT:42775, PS-37891, CSCvu83787)

  - cli: Turbo parser: When a node was annotated with
    'tailf:cli-compact-syntax' and had a 'leaf-list' child with 'ordered-by
    user', the order of that 'leaf-list' would be reversed. This is changed
    so that the order is parsed as given in the configuration.

    (ENG-24294)

  - cli: When an incomplete CLI command invoked an action, the action input
    parameter would invoke an external data provider with an invalid path
    which resulted in an internal error.

    (ENG-24283)

  - cli: Turbo parser: Added support for deletion of list keys with
    'tailf:cli-range-list-syntax'.

    (ENG-24254, CSCvu80076)

  - cli: Turbo parser: Failed parsing of type 'empty' leafs in non
    'tailf:cli-sequence-commands' nodes would not trigger retry of the next
    possible match in the same context. Instead, the context above would be
    used. After this change, the same context as the failed type 'empty'
    leaf is used.

    (ENG-24227, RT:42672, PS-37788, CSCvu75706)

  - cli: When using the J-Style CLI and tab-completing a delete command on a
    leaf node the CLI would also present the leaf value which wasn't
    necessary for performing the delete. This has been fixed by not
    including the leaf value for the delete command tab-completion.

    (ENG-24200, RT:42435, PS-37545, CSCvu71247)

  - cli: Fixed an internal error when using 'load override' XML file on a
    subtree containing operational nodes.

    (ENG-24198)

  - cli: Turbo parser: A 'tailf:cli-prefix-key' annotated 'leaf' in a
    'choice' in a 'list' would not be accepted even though it should be.
    This would cause the choice to be seen as invalid. Now, instead, the
    'tailf:cli-prefix-key' leaf is accepted.

    (ENG-24187, RT:42599, PS-37711, CSCvu69494)

  - cli: Turbo parser: Fixed parsing issue related to leafs in nodes
    annotated with 'tailf:cli-sequence-commands' and
    'tailf:cli-flatten-container'.

    (ENG-24186, RT:42598, PS-37710, CSCvu69483)

  - cli: The order of show configuration output was wrong when list key has
    'tailf:cli-diff-delete-before' extension. The first list entry has
    correct order but it is out of order from the second list entry.

    (ENG-24175, RT:42573, PS-37685, CSCvu68072)

  - cli: Show configuration of a leaf named 'enabled' used a semicolon
    instead of a colon as separator which would result in syntax error when
    restoring the saved configuration.

    (ENG-24142, RT:41998, PS-37096, CSCvu64260)

  - cli: Presence containers with children can now be set even if all the
    children aren't modified using the turbo parser.

    (ENG-24141, RT:42553, PS-37667, CSCvu63786)

  - cli: Combining NACM restriction rules on a callpoint could result in an
    internal error and crash inside the CLI when using the describe command.
    This has been fixed by displaying the "Access denied" information for
    appropriate data node.

    (ENG-24108, RT:42469, PS-37582, CSCvu60209)

  - cli: Running a filtering 'show' command where the path was to a list and
    the filter was a presence container, the command would display the
    entire contents in the instances matching the filter instead of only
    displaying the contents in the presence container for each matching
    instance.

    (ENG-24099, RT:42455, RT:40489, PS-37567, PS-35571, CSCvu58287)

  - cli: Improved the Turbo parser so that it now honors
    'tailf:cli-incomplete-command' when put on a list key leaf.

    (ENG-24096, RT:42490, PS-37604, CSCvu57882)

  - cli: Fixed a regression introduced in ConfD 7.1. When displaying an
    empty table in the J-style CLI the expected output is "No entries
    found." not "% No such element exists."

    (ENG-24082, RT:42456, PS-37568, CSCvu56569)

  - cli: Turbo parser: Nodes whose parents were annotated with
    'tailf:cli-delete-when-empty' were sometimes not deleted, this issue has
    been fixed.

    (ENG-24080, RT:42472, PS-37585, CSCvu56184)

  - cli: The Turbo parser has been strengthened to be able to handle non
    ASCII character input without crashing.

    (ENG-24078, RT:42474, PS-37587, CSCvu56173)

  - cli: Show configuration data caused internal error when it was piped to
    "context-match" command.

    (ENG-24032, RT:42404, PS-37514, CSCvu49840)

  - cli: Show configuration data on a leaf named 'enabled' caused internal
    error when it pipes to "display set" command.

    (ENG-24010, RT:42382, PS-37492, CSCvu46853)

  - cli: When filtering data for XML output in the CLI the displayed data
    would not show in case 'tailf:display-when' extension was active. This
    extension should not be applicable when doing this and the fix concerns
    ignoring the extension in case XML output is used.

    (ENG-23995, RT:42315, PS-37414, CSCvu44437)

  - cli: Show configuration data with 'tailf:cli-diff-dependency' on a
    denied node by NACM rule caused internal error.

    (ENG-23767, RT:41911, PS-37005, CSCvu04053)

  - cli: The combination of the YANG extensions
    'tailf:cli-multi-line-prompt' and 'tailf:cli-preformatted' caused the
    entered value to be reverted in the transaction. That is the persistent
    effect of 'tailf:cli-multi-line-prompt' was lost.

    (ENG-23720, RT:43709, PS-38826)

  - cli: Completion could miss certain values when combining leaf-list and
    leafrefs.

    (ENG-23582, RT:41978, RT:42931, RT:38951, PS-37075, PS-38047, PS-34023,
    CSCvt63567, SR:687494628)

  - cli: When traversing command line to execute, the candidate remapped
    with prefix was matched even when it was not required. This resulted in
    that CLI enters wrong command tree and configures wrong data node.

    (ENG-23495, RT:41329, PS-36397, CSCvt43289)

  - cli: When using range expressions and empty leafs the CLI could
    automatically try and create these leafs if they had the
    'tailf:cli-drop-node-name' extension set. This has been fixed by
    verifying that possible data nodes candidates are filtered by checking
    if the extensions were actually present.

    (ENG-23365)

  - cli: Mixing empty leafs and containers with the same name as other nodes
    tailf:alt-name extension could make the CLI confused about which data
    node to prioritize. Fixed by filtering out nodes with proper naming
    ahead of tailf:alt-names.

    (ENG-23218)

  - cli: The list instance with child nodes was not copied to the target
    when executing command 'copy cfg' to copy a configuration subtree.

    (ENG-22843, RT:40056, PS-35135, CSCvs43609, SR:688001297)

  - cli: When combining 'tailf:non-strict-leafref' extension with typedef
    unions the CLI would sometimes fail to evaluate the correct data type
    which could result in the wrong data being presented during
    TAB-completion and other scenarios. This has been fixed by checking if
    this is 'tailf:non-strict-leafref' and then getting the real type def.

    (ENG-22455, RT:39463, RT:41368, PS-34541, PS-36437, CSCvr87410,
    SR:687640782)

  - cli: A glitch could occur in the CLI when filtering display of JSON data
    in combination with empty containers. The fix ensures that empty
    containers are not emitted when displaying JSON data.

    (ENG-16559, RT:29736, PS-9706)

  - cs_trans: Fixed an internal error when invoke an action containing at
    least one mandatory typeless action param.

    (ENG-25099, RT:44267, PS-39373, CSCvw35967)

  - cs_trans: Default leafs under a default case is re-validated when
    implicitly setting the default case by deleting the current case.

    (ENG-24855)

  - cs_trans: When validation points were used when 'candidate' and
    'writable-through-candidate' were enabled, edit-config of leafrefs could
    fail with rpc-error bad-keyref. This now works as expected.

    (ENG-24428, RT:42744, PS-37860)

  - cs_trans: The transaction engine crashed if there is transaction
    conflict where the first transaction was modifying children of an
    instance, while the second transaction set attribute on that instance
    and committed.
    The transaction engine has been updated to handle those cases.

    (ENG-24255, RT:42427, RT:42942, RT:42439, RT:42362, RT:42480, PS-37537,
    PS-38058, PS-37549, PS-37471, PS-37593, CSCvu79152)

  - cs_trans: Corrected the delete behaviour for CLI and JSON-RPC.
      * Taken read access into consideration.
      * Fixed wrong delete result when delete empty list node.
      * Fixed wrong delete result when deny-delete node has been removed
    implicitly by when-expression effect.

    (ENG-24238, RT:42535, PS-37649, CSCvu77202)

  - cs_trans: maapi_exists() could return incorrect result on leafs with a
    default value in an explicitly set case. The optimization responsible
    causing this behavior is no longer used for default leafs not yet set.

    (ENG-24164, RT:43885, RT:42313, PS-38991, PS-37412)

  - cs_trans: Fixed bad query result when using maapi_exists() on a
    mandatory node with when-false. The transaction engine has been updated
    to evaluate the when-expression on mandatory nodes for the correct
    result.

    (ENG-23896, RT:42313, RT:42135, RT:43885, PS-37412, PS-37237, PS-38991,
    CSCvu25221)

  - cs_trans: Deleting augmented configuration under a case could cause an
    internal error to occur.

    (ENG-23826, RT:42017, PS-37115, CSCvu14159)

  - cs_trans: A node with multiple when-expressions inside a list with fewer
    when-expressions could lead to internal error when touching a dependent
    node.

    (ENG-23810, RT:41850, PS-36944, CSCvu10824)

  - cs_trans: Fix an issue where the system wrongly invoked non-writable
    nodes during a case switch.

    (ENG-23808, RT:41422, PS-36494, CSCvu10462)

  - cs_trans: move/copy/rename APIs did only affect config-true data and
    config-false data was not considered. Now both config-true and
    config-false data are considered and handled properly when performing
    operations move/copy/rename.

    (ENG-23165, RT:40606, PS-35686, CSCvt37902)

  - cs_trans: Fixed an issue, when a previously active case becomes
    inactive, delete notifications would be present for default leafs under
    all cases. This would only happen for a persisted nested choice. Now
    delete notifications will only be present for default leafs under the
    previously active case.

    (ENG-22559, RT:39616, RT:41483, PS-34692, PS-36558, CSCvs02190)

  - cs_trans: If there is a non-empty list having a min-element under an
    active case of choice, and a switch to another case takes place, then
    min-element violation can be reported on that list node. Now no
    violation is reported for such deselected case of a choice.

    (ENG-21759, RT:38126, PS-33201, CSCvq56433, SR:687080950)

  - cs_trans: Transactions that started on Primary no longer are allowed to
    commit during transition from role Primary to None. Extra measures are
    introduced to ensure that it will not happen on transition from
    None/Primary to Secondary, even if the transition has failed and node
    was left in state None.

    (ENG-21160, RT:37046, PS-32127)

  - cs_trans: Recreating configuration that includes nodes with default
    values inside default cases caused ConfD to generate faulty DEFAULT_SET
    operations for the default nodes. Such nodes are now excluded.

    (ENG-16442, RT:29558, PS-9618)

  - documentation: Added missing revision update regarding
    tailf-cli-extensions.yang

    (ENG-24400, RT:42943, PS-38059, CSCvv04892)

  - documentation: Corrected documentation for Python API functions
    _confd.maapi.save_config() and _confd.maapi.load_config().

    (ENG-24037, RT:42085, PS-37187, CSCvu50479)

  - documentation: Update documentation of maapi_cli_prompt_oneof() with
    mention of pressing enter key without entering any value will return the
    empty string.

    (ENG-22187, RT:38955, PS-34027, CSCvr38469)

  - erlang-api: Erlang embedded application's .app file change was ignored
    after 'confd --reload'. Now those files are considered properly.

    (ENG-24102)

  - java-api: Fixed toString() method for ConfIPv6, ConfIPv6Prefix and
    ConfIPv6AndPrefixLen as well as the constructor for
    ConfIPv6Prefix(InetAddress, int) and ConfIPv6AndPrefixLen(InetAddress,
    int) when representing IPv4-mapped IPv6 address.

    (ENG-24621, RT:43501, PS-38618, CSCvv57060, SR:689765500)

  - java-api: Values larger than Long.MAX_VALUE (2^63-1) for type uint64
    were not handled correctly in ConfXMLParam.

    (ENG-24030, RT:42278, PS-37377, CSCvu49628, SR:689091924)

  - json-rpc: Leafrefs pointing to other leafrefs in augmented namespaces
    now works.

    (ENG-24090, RT:42408, PS-37518, CSCvu57645, SR:689024696)

  - json-rpc: The JSON-RPC will no longer time out (idle) while processing a
    request, instead the idle timer will be restarted when the reply is
    returned.

    (ENG-23681, RT:41475, PS-36550, CSCvt86043, SR:688638500)

  - json-rpc: Calling the JSON-RPC methods get_trans_changes or
    get_trans_conflicts with an action transaction handle will no longer
    cause an internal error.

    (ENG-22537)

  - netconf: When using a NETCONF subtree filter based on a model unknown to
    the NETCONF server, unnecessary resources (memory/processing) was
    allocated. With this fix, such subtree filters are simply ignored.

    (ENG-25267)

  - netconf: Corrected NETCONF reply message to NETCONF client, and
    corrected NETCONF write message in NETCONF trace log, when fetching
    query data that containing ampersand (&) or left angle bracket (<)
    characters.

    (ENG-24322, RT:42788, PS-37904, CSCvu87919, SR:689378595)

  - netconf: The capability with-rollback-id did not apply to the RPC
    copy-config when using inline configuration or URLs. Specifying
    with-rollback-id in a copy-config RPC now include the generated rollback
    id in the response.

    (ENG-24206)

  - netconf: When an rpc had an access failure it did lead to the reuse of
    an internal transaction, and the subsequent rpc:s resulted in the same
    access failure. The correction assert a new transaction to be used, so
    the subsequent rpc now reply with its proper result.

    (ENG-23890, RT:44035, RT:42089, PS-39139, PS-37191, CSCvu24233)

  - netconf: When opening an SSH listening socket for NETCONF or CLI over
    SSH the VRF parameter was not taken into account properly. Now this is
    fixed. Note that starting from NSO 5.4/ConfD 7.4 the underlying SSH
    implementation was changed, so this ticket is only partially applicable.

    (ENG-23658)

  - netconf: Corrected delete so that it does not delete nodes with
    augmented child nodes that cannot be deleted because of access rights.

    (ENG-23481, RT:41277, PS-36343, CSCvt39680)

  - netconf: When using an XPath filter in a NETCONF 'get' or 'get-config'
    request, the response has been improved to not contain lists with no
    instances. Previously, in some cases, list names would be included in
    the NETCONF response even though the list had no instances.

    (ENG-22625)

  - netconf: Notification netconf-config-change was incorrectly sent to
    subscribers of stream NETCONF when 'config false' data were updated. Now
    only 'config true' data triggers sending of such notification.

    (ENG-22450, RT:39421, PS-34498, CSCvr86681)

  - netconf: When using netconf-subsystem, parsing large "TCP header"
    packets could fail and return <!-- Error: Bad TCP header -->. Large "TCP
    header" packets are now handled robustly and work correctly.

    (ENG-22050, RT:38749, PS-33822, CSCvr13208)

  - netconf: If a leaf-list was deleted, the operation reported to the
    client was erroneously set to 'replace'. The operation is now correctly
    reported as 'delete' to the client.

    (ENG-21993, RT:38670, PS-33742, CSCvr04240)

  - python-api: Python 3.9 no longer exports PyObject PyIOBase_Type, because
    of this _confd could not be imported. Now _confd.init no longer check
    that the "file" argument is of type io.IOBase.

    (ENG-25176)

  - python-api: Fixed memory corruption issues in the DP API.

    (ENG-24907)

  - python-api: Actions implemented using confd.dp.Action failed to execute
    when they were called by notification kickers. These actions now use a
    new transaction to read information about the action being invoked, if
    reading using the provided transaction fails.

    (ENG-24325, RT:42561, PS-37675, CSCvu89029)

  - python-api: _confd.maapi.cli_prompt() now return the value input by the
    end user instead of always returning None.

    (ENG-24004, RT:42303, PS-37402, CSCvu45765)

  - python-api: Correct a bug where calling _confd.cdb.diff_iterate() after
    moving an element in ordered-by user list with a key consisting of
    multiple leafs, the new position in the list only included the first
    leaf of the key. Now the new position is returned as a list including
    all leaf values of the key.

    (ENG-22754, RT:39821, PS-34898, CSCvs27802)

  - restconf: ConfD did not close the user session properly when it received
    a request containing bad 'Accept' header. Now it closes the user session
    in such a scenario.

    (ENG-24871, RT:43895, PS-39001, CSCvv99636, SR:689725163)

  - restconf: Reinstating the offset and limit query parameters. The
    'offset' query parameter can be used by the client to specify the number
    of list elements to skip before returning the requested set of list
    entries. The 'limit' query parameter can be used by the client to
    specify a limited set of list entries to
    be retrieved.

    (ENG-24511)

  - restconf: For a top-empty leaf, the wrong namespace was generated in the
    XML output.

    (ENG-24386, RT:42972, PS-38087, CSCvv02124, SR:689483955)

  - restconf: There were situations where RESTCONF queries containing fields
    and depth would result in bad JSON.

    (ENG-24364, RT:42903, PS-38019, CSCvu96965)

  - restconf: 'Internal error' was returned for an invalid JSON action POST
    request. Now 'Syntax error' is returned.

    (ENG-21659, RT:37820, PS-32893)

  - restconf: Conforming the handling of the query parameter 'fields' with
    RESTCONF RFC 8040. In order to build a proper path, the full node set
    needs to be supplied using the path and the "fields" query parameter.

    (ENG-20806, RT:43482, RT:36604, PS-38599, PS-31684, CSCvo74470)

  - snmp-agent: If /confdConfig/logs/developerLogLevel was set to "trace"
    and an attempt was made to send an SNMP notification without a name and
    snmpTrapOID properly set among the varbinds, the attempt would fail
    silently. Now, sending a notification like this will succeed.

    (ENG-20191, RT:35564, RT:35790, PS-30639, PS-30867)

  - snmp-agent: The --fail-on-warnings flag added to the --mib2yang calls.

    (ENG-16790, RT:25631, PS-25568)

  - toolchain: confdc silently ignored tailf:annotate-module targeting an
    unknown module; it displays a warning now.

    (ENG-24873)

  - toolchain: Fixed a bug in yanger fxs plugin that emitted wrong hash tags
    for augmented notification nodes and caused failures during cdb
    upgrades.

    (ENG-24418)

  - toolchain: Fix yanger to run post expand hooks for leafref nodes even if
    the node is defined in a submodule when compiling a YANG version 1.1
    module.

    (ENG-24068, RT:42423, PS-37533, CSCvu54591)

  - toolchain: Fixed a yanger fxs plugin bug that affected handling of when
    statements with a nested deref() function in the XPath argument.

    (ENG-23921, RT:42191, PS-37287, CSCvu30360)

  - toolchain: confdc did not handle max-status correctly when pruning
    augmented data models. This has been fixed.

    (ENG-23809, RT:41989, PS-37087, CSCvu10712)

  - toolchain: Fixed confdc so that it reports the proper error message when
    a leafref points to another leafref that has an invalid path.

    (ENG-23621, RT:41596, PS-36682, CSCvt70535)

  - toolchain: For really large YANG models, the Yanger-Swagger plugin
    failed to produce any JSON output due to memory exhaustion. Now handling
    large YANG modules is vastly improved.
    Additionally, a fix was made to handle included YANG submodules so that
    the correct module prefix is now used in the generated HTTP request
    paths.

    (ENG-22380, RT:44114, RT:39278, RT:43366, PS-39219, PS-34353, PS-38482,
    CSCvr74402)

  - toolchain: When loading a YANG file, ConfD failed to validate an
    annotated node that was implemented by a subagent due to a missing flag.
    The required flag is now set during the compilation.

    (ENG-18900, RT:32982, PS-28633)

  - web-server: ENG-24577 introduced an issue, where URLs containing a
    query-string would return "405 Not Allowed" because of a strict match
    against static files. The query-string will now be ignored and only the
    location part of the URL will be used to find matching files.

    (ENG-24626)

  - web-server: When uploading via an HTTP POST to a CGI script, where the
    client either terminated prematurely or was stuck, the CGI script was
    not terminated. Now, the pipe toward the CGI script will be closed
    making it possible for the CGI script to terminate properly.

    (ENG-23765, RT:41482, PS-36557, CSCvu03764)

  - webui-one: The webui will now prevent an action from running if the
    parameters do not pass validation.

    (ENG-24799, RT:43843, PS-38948, CSCvv90264)

  - webui-one: Choosing a case on a choice inside an action using JSON-RPC
    that already has a selected case, will now correctly activate the new
    case.

    (ENG-24181, RT:42534, PS-37648, CSCvu68992, SR:689043253)

  - xpath: Prevent circular dependency when clearing delayed_when flag if
    using 'tailf:override-auto-dependencies' to force a when-expression to
    depends on itself. Introduced XPath cache for get_delem() and exists()
    callbacks at validation phase.

    (ENG-24755, RT:43496, PS-38613, CSCvv81733)

  - xpath: When an imported prefix is used in a top-level 'tailf:annotate'
    together with 'tailf:annotate-module' in the same annotation module, a
    circular dependency error is reported. In this case, the annotation
    module needs to be split up into two modules, one module for
    'tailf:annotate' and another for 'tailf:annotate-module'. Prior to this
    change, annotation imports were wrongly updated with target modules from
    'tailf:annotate'. Annotation imports are now populated with modules only
    from 'tailf:annotate-module'.

    (ENG-24588, RT:43441, PS-38557, CSCvv50480)

  - xpath: Corrected XPath count() on leaf-list to prefer using
    num_instances() callback.

    (ENG-24498, RT:43133, PS-38247, CSCvv28437)


ConfD-7.4 [August 17, 2020]
===========================

Deprecated:

  - cli: /confdConfig/cli/commitRetryTimeout has been deprecated and will be
    removed in ConfD-7.6. Use /confdConfig/commitRetryTimeout instead to
    control this behavior consistently for all northbound interfaces.

    (ENG-21263, RT:37093, PS-32175, None)

  - examples: Deprecated WEB-UI examples have been removed.

    (ENG-24028)

  - python-api: Python 3.4 has been deprecated and will be removed in ConfD
    7.5. You should upgrade your Python environment and make sure everything
    works with Python 3.5 or higher.

    (ENG-22280)

Removals:

  - python-api: It is no longer possible to use Python 2.7 with ConfD. As a
    bare minimum Python 3.4 must be used, but we strongly advice to use at
    least Python 3.5.

    (ENG-22284)

  - rest-api: The REST API has been removed.
    NOTE: Older confd.conf files has to remove the REST specific
    parts in order to function.

    (ENG-20522)

Non-backwards compatible enhancements:

  - confd: ConfD now requires glibc/eglibc version 2.16 or higher on most
    Linux-based targets. The exceptions are ConfD for Linux/ARM64 and
    Linux/PowerPC64, where glibc/eglibc version 2.19 or higher is required.
    Using ConfD with glibc/eglibc of older versions than described above may
    work in some cases, however, that may change without notice in any future
    ConfD release, and such usage is not supported.

  - confd: ConfD builds for Linux-based targets are now dynamically linked
    with libcrypto from OpenSSL-1.1.1, and thus require that this version is
    installed in the system. If it is desired to use another version of
    OpenSSL, please refer to the section "Using a different version of
    OpenSSL and optionally activating FIPS" in the "Advanced Topics" chapter
    of the User Guide.

  - confd: Now ConfD is always using the SMP (Symmetric Multiprocessing) VM.
    The non-SMP emulator does not exist anymore. This implies that ConfD not
    can be run on platforms without thread support. The default is to only
    use one thread. It is however possible to use as many threads as the
    system has logical processors. See the confd -smp option.
    Support for TLS 1.3 has been added.

    (ENG-21704)

  - confd: The /confdConfig/aaa/rest container in confd.conf is renamed to
    /confdConfig/aaa/restconf.

    (ENG-24069)

  - cli: The combination of tailf:cli-prefix-key and
    tailf:cli-hide-in-submode extensions on a leaf now causes a warning from
    the YANG compiler (or an error, if --fail-on-warnings or -E options are
    given to the compiler).

    (ENG-21876)

Non-backwards compatible corrections:

  - confd: An identityref that has the same namespace with context namespace
    will be encoded without prefix.

    (ENG-24116)

  - confd: It was discovered that the yang data type inet:ip-address from
    ietf-inet-types yang module could translate ipv6-data that wasn't using
    a 'zone index' into data that would do so. This has been changed so the
    input results in the same output. Also a restriction against usage of
    'zone index' for ipv6 for the yang data type  inet:ip-address; has been
    added. This already existed for the data type inet:ipv6-address.
    See here for more info about the <zone id> part:
    https://tools.ietf.org/html/rfc4007#section-11.2

    (ENG-23497, RT:40757, PS-35853, CSCvt43666)

  - confd: Removed option 'always' in /confdConfig/aaa/auditUserName.

    (ENG-22598)

  - confd: The tailf:cli-hide-in-submode extension can no longer be used on
    mandatory leaf nodes that are of type empty.

    (ENG-19664, RT:34831, PS-29899, SR:684983271)

  - confd: A 'load override' with an input that in effect deleted
    configuration the user was not allowed to delete, was incorrectly
    allowed. Now the complete changes are checked against the NACM rules
    before it is applied and refused if the rules deny it.

    (ENG-18119, RT:32287, RT:38940, RT:27938, PS-28069, PS-34012, PS-8900)

  - aaa: * SSH servers now use OTP 22 SSH and new Crypto library from OTP 22
    * SSH rekeying interval option is not supported, we agreed to keep the
    default values as they are looking good
    * We now have support for multi factor authentication for the CLI over
    SSH. This is implemented via the 'keyboard-interactive' SSH mode
    * SSH identification string has changed to the default in OTP SSH server
    identification "SSH-2.0-Erlang/4.9"

    (ENG-23548)

  - aaa: The confd_load command has been updated so that it uses the group
    option when the cli context is used. This means that the command looks
    at the configured NACM rules for that group and behaves accordingly. If
    the NACM rules should be disregarded the system context should be used.

    (ENG-19282, RT:34399, PS-29455)

  - c-api: maapi_load_config_cmds API call now respects chroot parameter
    when loading configuration in XML or JSON format.

    (ENG-22804, RT:39935, PS-35013, CSCvs36210)

  - cli: Internal data structures used by differ engine have been modified
    to allow for better handling of cases when a config line should be
    modified after it is inserted into diff (e.g. during
    tailf:cli-no-value-on-delete extension processing).

    (ENG-22773, RT:38941, PS-34013)

  - cli: Performing a delete you can get now a warning if some element
    required to be removed is not available anymore. Or an error if the only
    element to be removed is not available.

    (ENG-17835, RT:31821, PS-27752)

  - cs_trans: The transaction engine has been updated to handle conflict
    scenarios better. For example, if a transaction was modifying children
    of an instance and another transaction deleted the same instance and
    committed, the first transaction did not handle the conflict correctly
    which would lead to invalid data in CDB if the transaction
    was committed.

    (ENG-22841, RT:39559, PS-34635, CSCvs43530)

  - json-rpc: Multiple calls, sent in an array to the JSONRPC, are now made
    in the order they are written in the array (not in backward order). The
    change in behaviour can be observed when creating new items last in an
    ordered-by user list, and in logs.

    (ENG-23763, RT:41885, PS-36979, CSCvu03471, SR:688938362)

  - json-rpc: The server now limits the size of unauthenticated messages
    accepted over JSON-RPC. The parameter
    '/confdConfig/webui/transport/unauthenticatedMessageLimit' can be set to
    the number of bytes to allow or to 'nolimit'. The default is 65535. This
    changes the previous behaviour which can be restored using 'nolimit'.

    (ENG-22499, RT:39551, PS-34627, CSCvr95022)

  - netconf: NETCONF now limits the accepted XML processing instruction
    target length.

    (ENG-22472, RT:39480, PS-34558, CSCvr89757)

  - netconf: If a deny-create rule exists on a leaf in a list, a create on
    the list instance is now denied if it would cause a create on that leaf.
    This also applies if the deny-create was set on a leaf-list.

    (ENG-20419, RT:41594, RT:38940, RT:30335, RT:34670, RT:35946, PS-36679,
    PS-34012, PS-10000, PS-29736, PS-31024)

  - restconf: RESTCONF error data was not according to RFC. XML
    instance-identifiers was formatted with module prefix instead of xmlns +
    prefix. JSON output did not include module prefix on top level elements.

    (ENG-23652)

  - restconf: Check the complete changeset against the NACM rules before
    applying an operation. This fix also takes care of a problem with the
    USER variable in NACM rules, for example in denying delete of the user
    used in a request.

    (ENG-18530, RT:32902, RT:34280, PS-28483, PS-29374)

  - toolchain: The 'default' keyword on leaf-list was incorrectly allowed in
    YANG 1.0 files, and YANG 1.1 files only allowed a single default value
    to be refined. Using refine to set a default value in a YANG 1.0 file
    now generates an error message.

    (ENG-22570, RT:39598, PS-34674, CSCvs03576, SR:687854008)

  - toolchain: confdc now correctly handles the grammar for the 'deviate'
    statement.  Specifically, it now rejects attempts to deviate delete
    'mandatory', 'min-elements' and 'max-elements'.

    (ENG-21093, RT:36922, PS-32004)

Enhancements:

  - confd: The internal runtime representation of some data structures
    widely used throughout the system, including transactions, has been
    modified to consume less memory. The actual improvement depends on the
    number of data models loaded. Apart from a memory reduction, especially
    noticeable with many concurrent transactions, it also leads to a general
    performance improvement in certain parts of the system.

    (ENG-23639)

  - confd: ConfD now takes less time to stop (noticeable when idle).

    (ENG-23597)

  - confd: Build environment for PowerPC (non-SPE) is updated to use
    binutils-2.20.1 to fix the issue with debug section names (.debug_*)
    present in .dynsym section of executables.

    (ENG-23498, RT:41248, PS-36314)

  - confd: The leaves under /confdConfig/ssh/algorithms used to have an
    empty default value, meaning enable all supported algorithms. The
    default values are now specified to the recommended values which the
    user can override by either explicitly configure all supported
    algorithms or (continue to) set the leaves to an empty value. See the
    confd.conf(5) man page for more info.

    (ENG-23480, RT:41249, PS-36315, CSCvt39691, SR:688495265)

  - confd: Add WEBUI_LOG notifications as (CONFD_)NOTIF_WEBUI to the C API,
    Java API, Python API, and econfd.

    (ENG-23072)

  - confd: Added support to override Java log file name and location by
    configuring /confdConfig/javaVm/stdoutCapture in confd.conf.

    (ENG-22923, RT:40239, PS-35318, CSCvs72087, SR:688094624)

  - confd: Enable to display TLS protocol in CLI system message when commit
    is performed using NETCONF.

    (ENG-22793, RT:38821, PS-33892)

  - confd: If an empty transaction is applied, ConfD no longer executes the
    validation phase for this transaction.

    (ENG-22792)

  - confd: The format of configurable progress traces (CSV and log),
    progress trace through the CLI and devel.log as well as the notification
    API has changed. Also the notifications API (CONFD_NOTIF_COMMIT_PROGRESS
    and CONFD_NOTIF_PROGRESS stream) now exports all the fields present in
    the progress trace CSV file and the /progress/trace/event list.
    A field, 'annotation', giving metadata about the event (indicating
    error, explaining latency, shows result etc.) and a field 'datastore'
    have been added.
    While XPath tracing has been removed from progress verbosity level debug
    as a default it is now optional to include (as well as kicker and
    subscriber debug tracing) when configuring progress traces under
    /progress/trace.
    The devel.log now logs progress trace event for verbosity level normal
    when set at level info. At level trace, progress trace events for
    verbosity level debug are emitted.
    API methods are added for C, Java and Python to log progress spans
    (events with a duration) from user code.

    (ENG-22758, RT:36798, PS-31879)

  - confd: Optimized transaction performance when configuring a large set of
    kickers.

    (ENG-22668)

  - confd: ConfD implements the origin metadata annotation feature defined
    in RFC 8342 Network Management Datastore Architecture (NMDA). The
    feature marks all configuration nodes in operational with the new
    attribute "origin". Both NETCONF and RESTCONF protocol implementations
    are extended to support the origin feature as defined in RFC 8526 and
    RFC 8527 respectively.
    The NETCONF origin-filter and negated-origin-filter parameters can be
    passed down to data provider as a list filter expression, see "Using
    List Filters" in "Operational Data" in the User's Guide for details.

    For better performance, following new replies that contain value with
    attributes are implemented for the callbacks below.
    - get_elem: confd_data_reply_value_with_attrs()
    - get_next: confd_data_reply_next_key_with_attrs()
    - get_object: confd_data_reply_tag_value_attrs_array()
    - get_next_object: confd_data_reply_next_object_tag_value_attrs_array(
    - get_next_object (multiple objects):
    confd_data_reply_next_object_tag_value_attrs_arrays()
    The attributes have been stored in the object cache so that CAPI does
    not invoke get_attr() and use the attributes in the object cache
    instead, see the confd_lib_dp(3) manual page for details.

    (ENG-22602)

  - confd: Improve performance on tree traversal for deeply nested lists
    with large amount of elements.

    (ENG-22329, RT:38750, PS-33823)

  - confd: If ConfD gets stuck while terminating, it can now create a debug
    dump after being stuck for 60 seconds. To enable this mechanism, set the
    environment variable $CONFD_DEBUG_DUMP_NAME to a filename of your
    choice.

    (ENG-22141, RT:38589, PS-33661)

  - confd: The /confdConfig/aaa/auditUserName option 'truncated' can be used
    to only log first 60 characters of users who fail to authenticate over
    SSH or NETCONF. This can be used to reduce the load on the audit log.
    Attempts to connect to SSH with excessive authentication data (> 4kb)
    will now be dropped at the protocol level.
    Note that this early drop leads to that the attempts will not be logged
    in the server!

    (ENG-22035, RT:38712, PS-33785, CSCvr11505)

  - confd: Reduced memory footprint of capi object cache in some specific
    use cases where leaf-lists are stored.

    (ENG-21874, RT:38337, PS-33406, CSCvq81640)

  - confd: Optimize existence check for leafs with when-expression.
    Previously when-expressions were evaluated for all leafs. Now
    when-expressions are only evaluated for leafs when the default value is
    effective. This change does not apply to external data providers.

    (ENG-20771, RT:27383, PS-8692)

  - confd: Add support for retrieving id of the rollback file created during
    a transaction commit. The id returned can later be used to do selective
    rollback. See API documentation for details. C, Python, Java, and Erlang
    MAAPI interfaces supported. CLI, RESTCONF, NETCONF, and JSON-RPC
    supported.

    (ENG-20491)

  - confd: A new flag CDB_GET_MODS_INCLUDE_MOVES is available for use with
    cdb_get_modifications(). Combining CDB_GET_MODS_INCLUDE_LISTS with this
    flag will make it possible to receive information about where a list
    instance in an ordered-by user list is moved. See
    cdb_get_modifications(3) manual page for more information.

    (ENG-16185, RT:29618, PS-9651)

  - aaa: When authenticating for CLI access over SSH, NSO now supports
    iteratively issuing challenges for which the user needs to give the
    right responses to gain access.

    (ENG-22882)

  - aaa: Storing last-login information. Information about the last time at
    which a username was successfully used for authentication, the name of
    the authenticating host, the name or address of the location from which
    the user last received service, and the type of service used, will be
    written to the 'last-logins' operational container. Information is also
    stored to keep track of the number of failed login attempts since the
    last successful login, together with the information normally given for
    a successful attempt. This functionality requires the Operational
    Datastore to be enabled.

    (ENG-16721)

  - building: Fixed this compilation warning for libconfd:
    legacy/erl_marshal.c: In function 'erl_init_marshal':
    legacy/erl_marshal.c:110:5: warning: 'memset' used with length equal to
    number of elements without multiplication by element size
    [-Wmemset-elt-size]
        memset(cmp_array, 0, CMP_ARRAY_SIZE);

    (ENG-23130, RT:40549, PS-35628, CSCvs85493)

  - cli: By changing how the tear-down process was handled in the CLI it is
    now possible to get it completed much faster if the connection is a pure
    console connection. Prior to this fix a long wait state was allowed to
    make sure no connection was torn down prior to it being complete. These
    wait states where deemed unnecessary nowadays.

    (ENG-23581, RT:41492, PS-36567, CSCvt63338)

  - cli: The Turbo parser can now parse leaf-list nodes that have
    'tailf:cli-prefix-key' on them.

    (ENG-23547)

  - cli: Turbo parser: The CLI YANG extension 'tailf:cli-replace-all' has
    been implemented.

    (ENG-23502)

  - cli: Turbo parser: Added support for 'no' commands on 'leaf-list' and
    'list' nodes.

    (ENG-23455)

  - cli: A new pipe target "restconf" has been introduced in the CLI to
    display paths as restconf.

    (ENG-23388)

  - cli: The CLI extension 'tailf:cli-delete-when-empty' has been
    implemented in the CLI Turbo parser.

    (ENG-23007)

  - cli: The CLI has added support for the tailf:description extension to be
    fully supported. If the field exists and has been properly compiled into
    the yang model it will now be presented where applicable.

    (ENG-22951)

  - cli: The Turbo parser now honors 'tailf:hidden' by not parsing such
    nodes.

    (ENG-22947)

  - cli: The CLI Turbo Parser now implements 'MAAPI_CONFIG_NO_BACKQUOTE'.

    (ENG-22901)

  - cli: CLI Turbo parser - umbrella ticket for various improvements.
    * Wide improvements and bug fixes in 'tailf:cli-sequence-commands'
    parsing.
    * 'tailf:cli-add-mode' + 'tailf:cli-drop-node-name':
      Handle the case of an add-mode that should be jumped into at
      the end of a line of config, when there are no more tokens.
    * Fix infinite loop
    * Fix internal errors
    * Functionality to defer calls to cs_trans, in order to do them only
      when they are absolutely necessary.
    * Fix 'leaf-list' related issues.
    * Handle multiple matching 'tailf:cli-allow-join-with-key'
    * Fix transitioning between 'tailf:cli-sequence-commands' and non
      'tailf:cli-sequence-commands'

    (ENG-22897)

  - cli: Using the new flag CDB_GET_MODS_INCLUDE_MOVES with
    cdb_get_modifications_cli(), the resulting C-style CLI command string
    may include comments about where a list instance in an ordered-by user
    list is moved.

    (ENG-22808)

  - cli: The CLI now supports last-login information about successful and
    failed attempts from both the ordinary CLI- as well as SSH-CLI-sessions.
    This interoperates with any other interface that supports this new
    feature. This is connected to the feature described in ENG-16721.

    (ENG-22740)

  - cli: The CLI turbo parser has been improved so that it can return
    CONFD_ERR_NOEXISTS when it encounters unmodeled configuration. In order
    to enable reporting of CONFD_ERR_NOEXISTS, the 'confd.conf' parameter
    '/confdConfig/cli/turboParser/reportNoExists' needs to be set to 'true'.

    (ENG-22572)

  - cli: Improved performance when generating CLI output by reducing the
    number of get_case calls to the data provider. The improvement is mostly
    noticeable when the model has many children under choices.

    (ENG-21819, RT:38260, PS-33329, CSCvq83585)

  - cli: Optimizations has been done to speed up the calculation of
    tailf:cli-diff-before dependencies when displaying a C-style
    configuration diff.

    (ENG-21117)

  - cli: Command info texts were added to all the intermediate built-in
    commands which were missing.

    (ENG-19633)

  - cs_trans: Optimised the number of dependency check on key of list
    instance containing hook.

    (ENG-23981, RT:42206, PS-37302, CSCvu41092)

  - cs_trans: Reduced the amount of memory usage when deleting large numbers
    of leafref targets.

    (ENG-23555, RT:41772, RT:41299, RT:41300, PS-36863, PS-36366, PS-36367,
    CSCvt55297)

  - cs_trans: Improved performance when an instance is created that is the
    parent of an NP-container with a when-statement, and the when-expression
    evaluates to true.

    (ENG-23542, RT:41869, RT:41398, RT:41440, PS-36963, PS-36468, PS-36513)

  - cs_trans: Improved scalability of load replace using C-style CLI config.

    (ENG-22781, RT:37470, PS-32549)

  - cs_trans: Improved performance in the transaction engine by reducing the
    number of required when evaluations for leafs with default values under
    lists and presence containers. The reduction in evaluations does not
    take effect if the leaf has a hook, must expression or have validation
    dependencies.

    (ENG-22780, RT:39805, RT:40459, RT:39898, PS-34882, PS-35541, PS-34975)

  - cs_trans: The transaction engine has been update to speed up loading
    configuration as the following
    1. Optimising to not evaluate duplicated when-expressions.
    2. All when-expressions are evaluated at validation phase.
    3. Using when-cache at building commit log.

    (ENG-19932, RT:40608, RT:35147, PS-35688, PS-30218)

  - documentation: Expanded documentation on Subscribed Notifications for
    NETCONF (RFC 8639 and RFC 8640) to include compatibility with NETCONF
    Notifications (RFC 5277) and monitoring of established subscriptions.

    (ENG-23978)

  - documentation: Improve ConfD User Guide by adding noInput option to
    clispec example.

    (ENG-22484, RT:38927, PS-33999, CSCvs45139)

  - documentation: Add description about the appropriate usage of the "tab"
    pipe command to ConfD User Guide.

    (ENG-17661, RT:31531, PS-27544)

  - examples: Add monitoring of established subscriptions via the
    subscriptions container to the NETCONF Subscribed Notifications (RFC
    8639) example.

    (ENG-24145)

  - examples: new JSON-RPC example - webui

    (ENG-22706)

  - examples: Added an example showing how to instruct ConfD to deal with
    POSIX regular expression patterns used in OpenConfig models

    (ENG-22406)

  - examples: new example - pipe command with no executive part used as a
    show template flag to modify CLI output

    (ENG-22040)

  - java-api: Java clients will now connect to an IPC port with
    SHA-256-based authentication method when IPC access control is enabled.
    Older MD5-based clients are still supported for backwards compatibility.

    (ENG-23255, RT:40783, RT:41142, PS-35879, PS-36209, CSCvt37929)

  - java-api: When writing to MaapiOutputStream would fail, the resulting
    error message was logged, but there was no way to retrieve the error
    message in the code. Two methods, getErrorString() and getErrorCode(),
    have been added to retrieve the error message and the error code
    respectively.

    (ENG-23137, RT:40425, PS-35507)

  - json-rpc: JSON-RPC now supports 2-factor authentication. This is
    implemented via the new external challenge mechanism.

    (ENG-22880)

  - json-rpc: A new method "get_description" is now available, it can be
    used to get YANG description if the YANG file is compiled with the
    --include-doc option.
    See JSON-RPC documentation for a complete description.

    (ENG-22534)

  - netconf: Add support for the "subscriptions" container defined in RFC
    8639 Subscribed Notifications.
    There is basic support for monitoring subscriptions via
    /sn:subscriptions; it is possible to retrieve subscription-id, encoding,
    receiver, stop-time, and filters.

    (ENG-23012)

  - netconf: Added support for RFC8641 "Subscription to YANG Notifications
    for Datastore Updates", also known as YANG-Push.
    The "ietf-yang-push" YANG module is exported only to NETCONF and
    compiled with ietf-subscribed-notification features: encode-xml, replay,
    xpath, and subtree; and also with the ietf-yang-push feature on-change.
    Major items from RFC 8641 not supported are the following:
     - configured subscriptions
     - mechanism to suspend and resume subscriptions due to lack of
    computational resources, like cpu, memory etc.
     - RFC compliant errors for features not supported.
     - subscription on operational datastore is not  supported for on-change
    subscriptions.

    Yang-Push implementation supports the following:
    Receiver Authorization:
    API calls establish-subscription and modify-subscription will grant a
    selection filter even if the filter contains references to nodes which
    are non-existent or nodes to which the receiver has got no authorized
    access right to. See chapter Receiver Authorization in RFC 8641.

    Dynamic periodic subscription to a datastore:
    API call establish-subscription and modify-subscription (where
    applicable) supports the follow parameters,
     - datastore: running, operational
     - datastore-subtree-filter
     - datastore-xpath-filter
     - stop-time
     - encoding: xml
     - period
     - anchor-time
    Not supported parameters are,
     - selection-filter-ref
     - dscp
     - weighting
     - dependency
    API calls modify-subscription, delete-subscription and kill-subscription
    are supported.
    Dynamic periodic-subscription can be used to subscribe on running or
    operational datastores. By subscribing on operational datastore, data
    may be read from a data provider.
    A filter may select the model top, but is not recommended as this will
    cause a huge amount of notifications and data to be sent, reflecting
    every update in a datastore.

    Dynamic on-change subscription to a datastore:
    API call establish-subscription and modify-subscription (where
    applicable) supports the follow parameters,
     - datastore: running
     - datastore-subtree-filter
     - datastore-xpath-filter
     - stop-time
     - encoding: xml
     - dampening-period
     - sync-on-start
     - excluded-change
    Not supported parameters are,
     - datastore: operational
     - selection-filter-ref
     - dscp
     - weighting
     - dependency
    API calls modify-subscription*, resync-subscription, delete-subscription
    and kill-subscription are supported.
    *modify-subscription rpc handling does not support to change the
    update-trigger type from periodic to on-change or vice versa.
    A filter cannot select the model top and usage of such a filter results
    in an error being replied.

    Monitoring of subscriptions:
    There is basic support for monitoring subscriptions via the
    /subscriptions container. Currently it is possible to view dynamic
    subscriptions' attributes,
     - subscription-id
     - stream
     - encoding
     - receiver
     - stop-time,
     - datastore-xpath-filter
    Not supported attributes are,
     - datastore-subtree-filter
     - receiver/sent-event-records
     - receiver/excluded-event-records
     - receiver/state
     - periodic/period
     - periodic/anchor-time
     - on-change/dampening-period
     - on-change/sync-on-start
     - on-change/excluded-change
    A known issue is that it is possible to alter dynamic subscriptions in
    the /subscriptions container in the running datastore. However, this
    does not affect the actual subscription only the monitoring of it.
    Because of this, it is recommended to only allow admin write access to
    /subscriptions via NACM rules.

    (ENG-18441, RT:39669, RT:33788, RT:35398, RT:36758, RT:39872, PS-34745,
    PS-29067, PS-30472, PS-31838, PS-34949)

  - python-api: A compiled version of the Python API shared library is now
    included in the build for all targets supported by ConfD.

  - restconf: The RESTCONF documentation has been much improved.

    (ENG-20558)

  - restconf: It  is possible to specify separate transport section for
    RESTCONF in a fully backwards-compatible manner, see the confd.conf(5)
    manual page, RESTCONF section.

    (ENG-19015, RT:33759, PS-29058)

  - toolchain: confdc and yanger now includes the models 'ietf-restconf' and
    'ietf-yang-patch' in the default load path.

    (ENG-23753)

  - toolchain: The flag "--verbose" can now be passed to confdc for YANG
    compilation to print some info during the compilation process.

    (ENG-23181)

  - toolchain: The confdc  compiler now detects and optimizes some "when"
    expressions that always will evaluate to "true" or "false".  An example
    of such a "when" expression is:  'local-name(../../..) = "foo"'.

    (ENG-22652)

  - toolchain: confdc and yanger have new options --include-doc and
    --fxs-include-doc, respectively, which includes the descriptions from
    YANG source files in the fxs files.

    (ENG-22536)

  - toolchain: The development tool netconf-console has better support for
    subtree filtering.

    (ENG-22500, RT:39259, PS-34334)

  - web-server: In order to use TLSv1.3 the built-in testing TLS CA
    certificates and self-signed TLS certificates have been updated to use
    SHA-256 instead of SHA-1 signature algorithm. Note that these should
    only be used for development.

    (ENG-23744)

  - web-server: Add support for logging webui access log to syslog. This
    means all HTTP server based logs, i.e. webui, json-rpc, rest, restconf,
    can log to syslog. Note that some components have their own log in
    addition to the webui access log.

    (ENG-21059, RT:36935, PS-32017, SR:686449716)

Corrections:

  - confd: The default build rule for ietf-netconf-nmda.fxs in
    ${CONFD_DIR}/src/confd/yang has been overriden to include NETCONF NMDA
    features origin and with-defaults. So that if one decides to build yang
    modules in the release directory, ietf-netconf-nmda.yang compiles to the
    same file as the delivered ietf-netconf-nmda.fxs.

    (ENG-23933)

  - confd: ConfD's built-in SSH implementation was silently stripping
    illegal trailing characters from received identification strings. This
    has been changed - For compatibility and security reasons identification
    strings will be used as-is even if not RFC-compliant.

    (ENG-23743, RT:38983, PS-34055, CSCvt98942, SR:687514067)

  - confd: Leafs with default values incorrectly evaluated their must
    expressions even though ancestor when expressions evaluated to false.
    This error occurred when using candidate or delayed when including
    operations over NETCONF and RESTCONF.

    (ENG-23689, RT:40997, PS-36095, CSCvt89488)

  - confd: Yanger now reports an error if there is circular dependency
    between tailf:non-strict-leafref leafs. The error message has format as
    below
    <module.yang>:<line>: error: circular dependency for leafref path of
    leaf <node>

    (ENG-23656, RT:41661, PS-36747, CSCvt77385, SR:688482828)

  - confd: Due to a bug, in some cases rollback numbering could be reset on
    ConfD restart when rollbackNumbering is configured to be 'fixed' in
    confd.conf. This means that ConfD would in some cases start overwriting
    old rollback files after restart. This has been fixed.

    (ENG-23624)

  - confd: Fixed the 'delete failed for'-error that occurred when trying to
    delete a device. The problem applied for all API:s that use the
    'safe-delete' behavior. It only occurred for devices with a set-hook
    that delete configuration under the device being deleted.

    (ENG-23619, RT:41549, RT:42167, PS-36631, PS-37261, CSCvt70368)

  - confd: Closing a user session with an in progress candidate commit could
    under cause the system to crash. Synchronization has been added to avoid
    the user session to go away while the commit is in progress.

    (ENG-23529, RT:40539, PS-35618, CSCvt50204)

  - confd: During upgrade, when the type of a list key has changed in a part
    of YANG model that is config false, or has config false children, CDB
    will now attempt to upgrade the key by converting it to string and back
    to value. If the resulting value of the key leaf is valid, then CDB will
    move the stored config false data into the new structure.

    (ENG-23483, RT:41197, PS-36263)

  - confd: When using the NETCONF lock RPC with "wait-time" parameter, and
    the lock was already held by some other sessions. If the other session
    released the lock, ConfD invoked lock/unlock call-points of external
    data provider in bad order. The order of lock/unlock call-points has
    been corrected now.

    (ENG-23360, RT:40965, PS-36062, CSCvt17815)

  - confd: confd_load option -C was removed in version 7.3, however the
    usage text was not updated to reflect this change.

    (ENG-23334)

  - confd: Fixed an issue where all validation call-points of a node were
    invoked multiple times. ConfD now invokes validation call-points based
    on dependency, and only once.

    (ENG-23269, RT:40786, PS-35882, CSCvt06001)

  - confd: phase0 upgrade would fail with an internal error in the error
    log, if the CDB API was used to read an augmented leaf with a
    when-expression. The upgrade code has been changed to properly keep
    track of node name mappings for augmented leafs.

    (ENG-23261, RT:38033, PS-33108, CSCvt05669)

  - confd: Removed deps and tools from ncs-src and conf-api-src jars.

    (ENG-23217)

  - confd: Fixed an internal error in maapi_save_config() that occurred for
    MAAPI_CONFIG_NO_PARENTS when the subtree of the provided path had an
    augmented node.

    (ENG-23031, RT:40391, PS-35472, CSCvs71005)

  - confd: Fixed an issue where ConfD neglected the changed validation on
    keys when upgrading, which lead to invalid data in CDB after upgrading.

    (ENG-23024, RT:40344, PS-35424, CSCvs71982)

  - confd: If the monitor of an existing data kicker was modified, the
    kicker would monitor both the old and the new paths. This has been
    fixed.

    (ENG-22955, RT:40073, PS-35152, CSCvs62631)

  - confd: ENG-20771 introduced a regression isolated to existence check of
    operational data where it could return true even if the when expression
    evaluated to false. The when evaluation is no longer skipped for
    operational data since it can be written without validation.

    (ENG-22918, RT:40640, RT:40235, PS-35722, PS-35314, CSCvs57789)

  - confd: The builtin SFTP (SSH File Transfer Protocol) client connected
    with unsupported SSH host key algorithm. The host key algorithm
    ssh-ed25119 is unsupported in ConfD for OpenSSL < 1.1. I.e. the NETCONF
    <copy-config> operation with a target/source SFTP URL resulted in a
    crash in ConfD and the session was prematurely terminated. The builtin
    SFTP client will from now on only connect with the ssh-ed25519 host key
    algorithm if it is supported.

    (ENG-22909, RT:40217, PS-35296, CSCvs56253)

  - confd: Notification replay store logs where log files were missing could
    in very rare cases cause the log mechanism to stop working. This has
    been fixed.

    (ENG-22865, RT:40114, PS-35193, CSCvs48880)

  - confd: The id-values associated with each element in a data model are
    now localized to each namespace to avoid conflicts between the loaded
    data models.

    (ENG-22839)

  - confd: /progress/trace/event/duration and /progress/trace/event/timer
    leafs now contains the correct value.

    (ENG-22807)

  - confd: A list instance with a leafref pointing to it could be deleted if
    it was not the first instance deleted in that transaction.

    (ENG-22802, RT:41712, RT:39977, PS-36800, PS-35055, CSCvs35339)

  - confd: Display correct callback names in the output of confd --status
    and tailf-confd-monitoring data model. Previously only the callback
    names for data callbacks were correctly displayed.

    (ENG-22774)

  - confd: If the host that ConfD run on crashed abruptly from e.g. kernel
    panic, the replay store could in very rare cases be corrupted which lead
    to ConfD failing to come up. ConfD can now handle this case.

    (ENG-22734, RT:39814, PS-34891, CSCvs25387)

  - confd: When ssh-ed25519 was set as the only supported key algorithm
    without runtime support for it, ConfD would fail to generate a proper
    error message and terminate with Internal error.

    (ENG-22725)

  - confd: Correct an issue where session creation and termination for
    sessions with context=system was logged to the audit log.  Sessions with
    context=system are to be excluded.

    (ENG-22619, RT:39701, RT:39830, PS-34776, PS-34907, CSCvs08519)

  - confd: Reading a leaf using the CDB API during upgrade could fail if the
    old schema for the leaf had a default value and when expression. The
    when-evaluation now considers the old schema during upgrades.

    (ENG-22617, RT:38033, PS-33108, CSCvs08375)

  - confd: When an upgrade causes an instance-identifier with
    require-instance true to have stale data, ConfD now rejects the upgrade
    with the error message as below
    * Out-of-service upgrade
      Upgrade failed: Upgrade transaction failed to validate:
    <instance-identifier>: instance has stale data after upgrading:
    <stale-data>
    * In-service upgrade
      Required instance does not exist - <instance-identifier>: instance has
    stale data after upgrading: <stale-data>

    (ENG-22505, RT:39545, PS-34621, CSCvr95973, SR:687634930)

  - confd: If NP-container has when statement and mandatory leafs, and if
    the target node is modified causing when evaluation returns true, then
    ConfD did not consider old value of mandatory leaf in DB and asked for
    new value. Now ConfD reuses old value of mandatory leaf in DB.

    (ENG-22056, RT:39512, RT:40077, RT:38783, PS-34590, PS-35156, PS-33856,
    CSCvr15945, SR:687307392)

  - confd: Added support for dates beyond year 2038 in the Java API.

    (ENG-21933, RT:31475, RT:32015, RT:38255, RT:41018, PS-27493, PS-27869,
    PS-33324, PS-36116, CSCvq92574)

  - confd: With defaultHandlingMode set to 'trim', setting the default value
    of a leaf under a mandatory choice was rejected by ConfD. Now ConfD
    accepts setting the leaf to its default.

    (ENG-21608, RT:37462, PS-32541, CSCvq33366)

  - confd: Handling when-statements on choice/case properly.

    (ENG-21448, RT:37513, PS-32590, CSCvq12732)

  - c-api: maapi_get_next() no longer leaks memory when used with XPath
    filters.

    (ENG-23507, RT:41275, PS-36341, CSCvt46469)

  - c-api: When the Data Provider returned a default value indication
    (C_DEFAULT), it was not handled correct by the system.

    (ENG-23490, RT:41318, PS-36386, CSCvt41447)

  - c-api: If a daemon implementing an action died at a crucial moment in
    time the ConfD server could crash. Now the ConfD server handles this
    type of unexpected disconnections correctly.

    (ENG-22707, RT:39659, PS-34735, CSCvs22213)

  - cdb: In case there are multiple subscribers to the same NP-container,
    key of list or node has default value. If the first subscriber is
    interrupted, or unsubscribe, all other subscribers were no longer
    received any notification. The CDB subscription has been updated to fix
    that case. Now, interrupted subscriber does not effect to other
    subscribers.

    (ENG-23961, RT:42279, PS-37378, CSCvu38946)

  - cdb: cdb_get_elem failed to evaluate when expressions before returning
    default values if the when expression spanned both config true and
    config false data. cdb_get_elem now returns the default value instead of
    not found.

    (ENG-23818, RT:41857, PS-36951, CSCvu12483)

  - cdb: cdb_exists for config false did not evaluate when expressions
    before returning default values.

    (ENG-23745, RT:41857, PS-36951, CSCvt99196)

  - cdb: When a CLI user tried to abort a confirmed commit in configure
    exclusive mode, a message was displayed in the CLI stating that the
    abort failed. This caused the confirmed timer to timeout and the
    confirmed commit to be committed without creating a rollback file. This
    has been changed so that the lock taken through exclusive mode will be
    used with the abort so that the abort can succeed.

    (ENG-23262, RT:40796, PS-35892, CSCvt05767)

  - cdb: cdb_diff_iterate() using ITER_WANT_LEAF_LIST_AS_LEAF no longer
    crash during rollback of confirmed commit.

    (ENG-23100, RT:40457, PS-35539, CSCvs78275)

  - cdb: In a HA setup a subscriber to a slave node does not receive
    notifications for non-persistent operational data written to the master
    node (this is expected). If the slave node transitions to none or master
    the subscriber should receive notifications for such data written to
    that same node, but did not. Non-persistent operational data written to
    a node that has transitioned from slave to none or master is now
    notified to connected subscribers.

    (ENG-22658, RT:39672, PS-34748, CSCvs15299)

  - cdb: Calling maapi_get_next() using list filters against
    PRE_COMMIT_RUNNING data store caused the CDB application to terminate,
    hence ConfD terminated. Now maapi_get_next() using list filters works as
    expected against PRE_COMMIT_RUNNING

    (ENG-22633, RT:39470, PS-34548, CSCvs10894)

  - cdb: Upgrade of operational list data stored in CDB did not handle
    order-by changes. The upgrade process did not fail, however move
    operations on an upgraded system could cause the system to crash. The
    upgrade code has been extended to handle changes between order-by system
    and order-by user.

    (ENG-22519, RT:39537, PS-34613, CSCvr98199, SR:687811066)

  - cdb: Corrected a fault when upgrading a P-container to a NP-container.
    If the P-container did not exist in CDB, and it had a mandatory node,
    then upgrading that P-container to a NP-container was successful. This
    is wrong because the mandatory node was missing in CDB.

    (ENG-22466, RT:39389, PS-34466, CSCvr88850)

  - cdb: Removed superfluous MOP_DELETED when create and deactivate node in
    the same transaction.

    (ENG-18937, RT:33565, PS-28968)

  - cli: In some cases when processing leaf-lists with
    tailf:cli-drop-node-name extension CLI removed the node name but kept
    delimiting spaces intact, so in the resulting config line there were
    double spaces. Now the delimiters are also removed if not needed.

    (ENG-24159)

  - cli: Turbo parser: It is now possible to parse 'union' types including
    'enum' and integer types.

    (ENG-23941)

  - cli: When combining certain characters (example: #) in the CLI the
    output would sometimes get rendered with quotes even if it was
    unnecessary for the current context. This has been fixed by evaluating
    the current context and make sure that the characters are rendered in a
    more uniform way.

    (ENG-23910, RT:42179, PS-37275, CSCvu28868)

  - cli: CLI Turbo parser: Fixed the 'tailf:cli-break-sequence-commands'
    implementation.
    If 'tailf:cli-break-sequence-commands' is seen in a container/list,
    it should not break the current container/list's sequence,
    but the parent container/list's sequence.
    If seen on a leaf, then it should break the leaf's parent's sequence.

    (ENG-23886)

  - cli: The ConfD CLI allows a 'type empty, tailf:cli-drop-node-name' leaf
    to invalidate 'tailf:incomplete-command'. This change makes this
    behaviour the same in the CLI Turbo Parser.

    (ENG-23869)

  - cli: The C-style operational command 'show running-config' where the
    show filter consisted of multi-level nested lists (where each list had
    multiple keys) would not produce the correct result if the filter
    contained partial keys.

    (ENG-23807, RT:40748, PS-35844, CSCvu10339)

  - cli: Outputting data in Cisco CLI format resulted in internal error if
    access to a case was denied.

    (ENG-23783, RT:42083, RT:41926, PS-37185, PS-37021, CSCvu05475)

  - cli: Changed the CLI Turbo parser so that it will not attempt to parse
    YANG 'rpc' or 'action' nodes.

    (ENG-23674)

  - cli: When using range expressions in the CLI on data nodes with
    tailf:cli-range-list-syntax extension and setting useDoubleDotRanges
    confd.conf setting the CLI could get confused on what range-expression
    separator to use. Fixed by letting the tailf:cli-range-list-syntax
    extension override double-dot-ranges setting.

    (ENG-23576, RT:41507, PS-36583, CSCvt62511, SR:688581613)

  - cli: When executing a action from the CLI and omitting certain input
    params the CLI could crash. This has been fixed by allowing
    leaf-prompting on those input params and detecting missing input params.

    (ENG-23551, RT:41431, PS-36504, CSCvt54826)

  - cli: The 'show running-config | display xml' command caused CLI to reach
    for node attributes even when "enableAttributes" is set to false, thus
    causing performance degradation e.g. when a list with a lot of elements
    is displayed. This has been fixed.

    (ENG-23549, RT:41300, PS-36367, CSCvt54162)

  - cli: The CLI-turboparser didn't keep a log of what writes where actually
    performed. By registering this the parser could revert changes if they
    turned out to be faulty. This was a necessary feature for the
    tailf:cli-sequence-commands extension to work as intended where multiple
    data nodes might be correct before the whole context of the line is
    known.

    (ENG-23511)

  - cli: There was a mistake in the documentation regarding the typedef
    tailf:cli-template-string. Nested invocations was missing one
    $-character (dollar sign). This was corrected and a better error is now
    reported in case a faulty tailf:cli-template-string has been detected.

    (ENG-23499, RT:41334, PS-36402, CSCvt43689)

  - cli: Running the C-style command 'show configuration this' would result
    in an internal error.

    (ENG-23467, RT:41276, PS-36342, CSCvt36155)

  - cli: Turbo parser: Fixed several cases where configs in
    'tailf:cli-sequence-commands' nodes were accepted even though they were
    invalid.

    (ENG-23417)

  - cli: The C-style operational command 'show running-config' where the
    filter consisted of at least 3 levels deep nested lists (where the keys
    were omitted) would not produce the correct result.

    (ENG-23329, RT:40959, PS-36056)

  - cli: Various bugs in the CLI Turbo parser have been corrected.
    Most of them are related to 'tailf:cli-sequence-commands',
    'tailf:cli-optional-in-sequence' and
    'tailf:cli-break-sequence-commands'.

    (ENG-23236, RT:40790, PS-35886, CSCvt01990)

  - cli: Creation of empty leafs under an action input section did not work.
    This could lead to numerous problems, e.g. not being able to set other
    input values having a when-dependency on that empty leaf.

    (ENG-23214, RT:40731, PS-35827, CSCvs99036)

  - cli: Handling of lists in actions had implicit assumptions regarding
    user input, that can be incorrect. Now the implicit assumptions are
    replaced by explicit checks, thus preventing incorrect input: it is not
    possible to enter non-key leaves before keys in lists as action input,
    also cli-prefix-key extension cannot be used for lists as action inputs.

    (ENG-23150, RT:40576, PS-35656, CSCvs88270)

  - cli: The C/I-style command 'load merge/replace/override' now support
    'terminal' as the third argument (similar to the J-style CLI). This has
    been clarified in the documentation and in the auto-completion. An
    effect of this is that loading a file named 'terminal' will not be
    possible, since the user will be prompted for input from the terminal.

    (ENG-23107, RT:40515, RT:40593, PS-35594, PS-35673, CSCvs81719,
    SR:688312890)

  - cli: Fixed an internal error that happens when using the CLI to set the
    value of a leafref pointing to a tailf:non-strict-leafref.

    (ENG-23066, RT:38122, PS-33197, CSCvs74722)

  - cli: In a list or container annotated with 'tailf:cli-sequence-commands'
    that had empty leafs, the CLI Turbo parser could keep tokens and apply
    these tokens to several leafs, which was incorrect. This is fixed by
    only using a token once and then discard it.

    (ENG-23039)

  - cli: The C-style configuration diff (e.g. show configuration) as
    displayed after deleting a list-instance annotated with
    tailf:cli-diff-before would in some cases be incorrect when the
    list-instance itself had been removed. This has been fixed by making
    sure that local dependencies in a list-instance/presence container are
    disregarded if the list-instance/presence container itself is removed.

    (ENG-23033, RT:40295, PS-35375, CSCvs71290)

  - cli: The Turbo parser has been corrected, so that it will not get stuck
    in an infinite loop.

    (ENG-23009)

  - cli: The Turbo parser now honors 'tailf:pattern' in list keys. If it
    encounters a token that does not match the current list key's pattern,
    it will try retry the next match.

    (ENG-22990)

  - cli: Turbo parser - fixed a bug that made it impossible to parse nodes
    on top-level with when expressions.

    (ENG-22982)

  - cli: The CLI could leak internal processes when executing specific
    range-expressions. This has been fixed by making sure the spawned
    processes are closed.

    (ENG-22963, RT:40203, PS-35282, CSCvs63186)

  - cli: The turbo parser has been improved so that it will now report an
    error for leaves without any data.

    (ENG-22949)

  - cli: Various improvements in the Turbo parser. The handling of hide
    groups has been improved. Additionally, several bugs have been
    corrected.

    (ENG-22938, RT:40259, PS-35338, CSCvs61492)

  - cli: The CLI Turbo Parser could skip parsing leaf values, when
    'tailf:cli-drop-node-name' was used in combination with
    'tailf:cli-incomplete-command'. This has been corrected so that now the
    leaf value is parsed correctly.

    (ENG-22936)

  - cli: The 'when' dependency on a leaf-list was wrongly triggered on
    unchanged elements when using range or wildcard on the key of its parent
    list.

    (ENG-22928, RT:40154, PS-35233, CSCvs59979)

  - cli: The CLI Turbo Parser has been corrected so that it will not crash
    when encountering XPath expressions referencing the root path.

    (ENG-22903)

  - cli: A potential man-in-the-middle attack vector between the confd_cli
    and ConfD when using CONFD_IPC_ACCESS_FILE has been blocked.

    (ENG-22892, CSCvs52334)

  - cli: A potential buffer overwrite vulnerability in the confd_cli
    executable has been removed.

    (ENG-22890, CSCvs52326)

  - cli: Combining `maapi --cliset` in a clispec command and using the pipe
    command to save output could lock up the CLI. This was due to a internal
    failure handling that mistook the abort call as a code-exception. This
    was fixed by distinguishing the handling of CLI-abort-handling and a
    proper code-exception.

    (ENG-22818, RT:39899, PS-34976, CSCvs39997)

  - cli: If a CLI user aborted the commit procedure several times more than
    was defined for the CLI configuration session limit, the configuration
    mode could not be entered due to session limit exceeded.

    (ENG-22689, RT:39769, PS-34845, CSCvs19453)

  - cli: During command line completion in the CLI alternatives would
    sometimes be displayed with prefixes even when not required. This has
    been changed. Prefixes are now only displayed when necessary due to
    ambiguity or when explicitly entered.

    (ENG-22678, RT:39715, RT:39765, PS-34798, PS-34841, CSCvs17574)

  - cli: The CLI Turbo Parser could sometimes break off lines too early,
    causing parsing issues. Now it has an extra check in place so that this
    will not happen again.

    (ENG-22645)

  - cli: The CLI Turbo Parser has been improved to better handle non modeled
    configuration. Also, a bug involving multiple keys on lists has been
    fixed.

    (ENG-22620, RT:39660, PS-34736, CSCvs08529)

  - cli: When starting a new CLI session there was a race condition between
    the sessions seen as active in the backend and what actually existed.
    This meant that data passed to a session might not end up where it was
    intended from other processes. Fixed by syncing the active sessions
    early upon creation of a new CLI session.

    (ENG-22557, RT:39633, PS-34709, CSCvs01845)

  - cli: Combining leaf-list and leafrefs could result in missing values
    during TAB-completion in the CLI. This has been corrected to not miss
    out any values in the list and filter out as many suggestions as
    possible.

    (ENG-22488, RT:38951, PS-34023, CSCvr92470, SR:687494628)

  - cli: When accessing data in the CLI that should result in ambiguous
    commands for the new common data model structure a crash could occur.
    The fix involved recognizing the ambiguousness and returning  error
    instead.

    (ENG-22487)

  - cli: The indentation was wrong in the output of show configuration with
    "no" command to delete leaf from a leaf-list with multiple entries. This
    has now been fixed.

    (ENG-22479, RT:39448, RT:39993, PS-34525, PS-35071, CSCvr90919,
    SR:687762006)

  - cli: Double-subscription for interrupts from one of CLI-internal
    processes caused race condition between that process and the actual
    running command (ping in this case) when handling the interrupt. The
    double-subscription is removed.

    (ENG-22232, RT:38956, PS-34028, CSCvr46217)

  - cli: The tab-completion and execution for RPC/action nodes did not
    present similar results in the CLI. This has been corrected so the
    execution would behave more according to the tab-completion.

    (ENG-21762, RT:38193, PS-33264, CSCvq57911)

  - cli: The tailf:info tag would not present anything useful in the CLI for
    RPC/action-nodes. This has been corrected and can now be added to these
    nodes. Please note that any tailf:info on the mount-point-nodes will not
    be used for the RPC/action-node.

    (ENG-21758, RT:38176, PS-33247, CSCvq56249)

  - cli: A 'must' statement on an action/rpc input parameter of the type
    leafref would not be evaluated in the right transaction during
    auto-completion or execution of the action/rpc.

    (ENG-21394, RT:34325, RT:41164, PS-29393, PS-36229, CSCvq12124)

  - cli: The tailf:cli-incomplete-command annotation did not work properly
    on leaf-list. This has now been fixed.

    (ENG-20531)

  - cli: 'tailf:cli-full-no' annotated on key leafs is now honored when
    displaying C-style configuration diffs.

    (ENG-20033)

  - cli: When combining tailf:cli-list-syntax, leaf-list, sibling leafs and
    omitting the tailf:cli-multi-word option the CLI would still consider
    the tailf:cli-multi-word to be active. This could create faulty
    list-entries in the leaf-list. The CLI has been fixed to check the for
    the tailf:cli-multi-word option and otherwise properly create multiple
    list-entries.

    (ENG-19697, RT:35018, PS-30088)

  - cli: Fix way optimisation for ordered by user lists was made. It's
    showing now commits changes when a modification was made in a deeper
    level of a ordered by user list.

    (ENG-16074, RT:26524, PS-8376)

  - cli: Setting the element '/clispec/$MODE/cmd/callback/table/root' to a
    path to a list (as opposed to a list instance), would lead to an
    internal error when the table was to be displayed in the CLI.

    (ENG-15395, RT:22485, RT:39737, PS-7197, PS-34813)

  - cli: Displaying status and configuration in XML format in the CLI has
    been changed such that it harmonizes with the curly bracket format and
    the Cisco style format when filters and pipe commands are used. The XML
    output is now also correctly indented.

    (ENG-14164, RT:24955, RT:28162, RT:32545, RT:32921, RT:35873, RT:17273,
    RT:31822, PS-7898, PS-8988, PS-28240, PS-28544, PS-30951, PS-22048,
    PS-27754, SR:684342694)

  - cs_trans: Loading configuration data in replace mode did not validate
    mandatory leafs under NP-containers in created instances. This lead to
    inconsistent data being stored in the database and affected all NB
    interfaces.

    (ENG-23987, RT:42285, PS-37384, CSCvu42779, SR:688950166)

  - cs_trans: Fixed bad query result when using maapi_exists() on mandatory
    node has when-false. The transaction engine has been updated to evaluate
    the when-expression on mandatory node for the correct result.

    (ENG-23896, RT:42313, RT:42135, PS-37412, PS-37237, CSCvu25221)

  - cs_trans: Creating a leaf-list element under an unset case lost the item
    but activated the case. Subsequent create operations worked as expected.
    This regression was introduced in ENG-17921.

    (ENG-23850, RT:42056, PS-37157, CSCvu18417)

  - cs_trans: confd_load (without -a) should doing AAA validation on the end
    result even if the format is specified in Juniper format.

    (ENG-23781)

  - cs_trans: abort() is now always invoked when prepare() has been
    interrupted.

    (ENG-23666)

  - cs_trans: CLI show command resulted in an internal error when all the
    elements under a list was hidden by a tailf:hidden YANG extension
    statement.

    (ENG-23412, RT:41109, PS-36175, CSCvt28086)

  - cs_trans: Querying over NETCONF with a filter consisting of a list with
    key of type identityref and there was no xmlns declaration for the
    prefix, ConfD would crash with internal error.

    (ENG-23308)

  - cs_trans: Nodes with when-expression in a mandatory choice was falsely
    validated if a dependent node was changed, even if the choice itself did
    not exist.

    (ENG-23301, RT:40862, PS-35959, CSCvt09456)

  - cs_trans: A subscriber calling cdb_diff_iterate() with
    ITER_WANT_SCHEMA_ORDER did not get a notification for a leaf's default
    value, if the leaf was in a default case and the choice was becoming
    active due to an ancestor being created.

    (ENG-23194, RT:41152, RT:40613, PS-36215, PS-35693, CSCvs95050)

  - cs_trans: Fixed an issue when deactivating/activating a list containing
    a node that has a when-statement and a mandatory node, and
    writable-through-candidate was used.

    (ENG-23184, RT:40558, PS-35637, CSCvs93741)

  - cs_trans: Loading data using "load replace" no longer report mandatory
    leafs in list instances under a nested choice as missing

    (ENG-23119, RT:40521, PS-35600, CSCvs84053)

  - cs_trans: ConfD did not remove data dependent on NP-container existence
    in all scenarios. If an NP-container when-expression turned false the
    dependent data was left in CDB.

    (ENG-23080, RT:40437, PS-35519, CSCvs76689)

  - cs_trans: Resolved an issue where a HA setup could become indefinitely
    blocked for writes, triggered by a slave node connecting to a master
    node.

    (ENG-23064, RT:40478, PS-35560)

  - cs_trans: Corrected a fault where deleting a leaf caused a crash in
    ConfD. The crash occurred when there was a default case containing two
    default leaves, the first default leaf had a when-statement on the
    second default leaf. The crash was caused by deleting the second leaf.

    (ENG-22787, RT:39684, PS-34760, CSCvs33016)

  - cs_trans: Deleting a mandatory leaf in a case whose choice resides
    inside a container case of parent choice and then setting a leaf in a
    sibling case (all in the same transaction) would lead to validation
    failure where ConfD would falsely complain that the mandatory leaf is
    missing even though that case is no longer active.

    (ENG-22727, RT:39837, PS-34914, CSCvs24703)

  - cs_trans: A delete on a nested 'choice', with the top-choice being
    mandatory, incorrectly deleted the whole path of choice:s leading up to
    that nested 'choice'. ConfD now check mandatory choice by choice when
    performing choices deletion.

    (ENG-22641)

  - cs_trans: ConfD wrongly asked for mandatory leaf has when-true, under
    non-existence p-container. Now, If ancestor does not exist, ConfD shall
    not require mandatory nodes of that subtree.

    (ENG-22628, RT:39724, PS-34796, CSCvs10082, SR:687864960)

  - cs_trans: maapi_delete_all(..., MAAPI_DEL_SAFE) used from i.e. "load
    replace" in the CLI could sometimes crash i.e. when attempting to delete
    YANG data nodes that are not writable or callpoints that are not
    registered. The function will no longer attempt to delete unwritable
    YANG data nodes.

    (ENG-22541, RT:39573, PS-34649, CSCvs00251)

  - cs_trans: MAAPI delete on a non-presence container path failed if its
    ancestor was created in the same transaction.

    (ENG-22332, RT:39289, PS-34364)

  - cs_trans: Module and submodule do not share prefix maps now.

    (ENG-21326, RT:37254, PS-32335, CSCvp61728)

  - documentation: Correct econfd:tagval() type.

    (ENG-23678, RT:41719, PS-36808, CSCvt85202)

  - documentation: ConfD-6.7 is tested with Java 7 and 8.
    ConfD-7.x is tested with Java 8 and 11.

    (ENG-23147, RT:40584, PS-35664)

  - documentation: Removed documentation stating that
    tailf:cli-drop-node-name could not be used inside tailf:action.

    (ENG-7025, RT:30265, PS-9961)

  - java-api: ConfIPv4 equals method now returns false rather than throwing
    a NullPointerException if called with null as argument.

    (ENG-23123)

  - java-api: Synchronized maapi operation in MaapiCrypto class to avoid a
    situation where two requests are dispatched on the same socket before
    one of them receives a reply.

    (ENG-23111, RT:40463, PS-35545, CSCvs82815)

  - java-api: Constructing a ConfObjectRef from an XPath resulted in an
    exception when list instances were positioned at root level.
    The reason was that root level nodes weren't checked if they contained
    keys.
    The root level node is now checked if it contains keys as well.

    (ENG-22783, RT:39865, RT:39957, PS-34942, PS-35035, CSCvs31227)

  - json-rpc: Keypaths will now include a prefix when the namespace changes,
    where previously only the root node would have a prefix.
    E.g the path '/foo:foo/foo:bar/fizz:fizz/fizz:buzz' would be returned as
    '/foo:foo/bar/fizz:fizz/buzz' instead of '/foo/bar/fizz/buzz'.

    (ENG-23473)

  - netconf: NETCONF messages with a non UTF-8 encoding used to cause an
    error to be logged in the error log and the connection closed. For hello
    messages the connection is still closed, for other messages a proper
    error response is returned. No errors due to invalid encoding are logged
    to the error log.

    (ENG-23631)

  - netconf: Namespaces are now correctly returned for keys of type
    instance-identifier.

    (ENG-23521, RT:41373, PS-36442, CSCvt48281)

  - netconf: Fixed regression of XML parsing performance of augmented
    choices. This affected the performance of <get-data> parsing.

    (ENG-23324)

  - netconf: The fix for ENG-22909 changed the interpretation of the url
    parameter in source / target of <copy-config>. The path segment was
    interpreted as a relative path for the sftp/ftp protocols to align with
    the OpenSSH sftp(1) client. The change has been reverted and paths are
    now absolute. Users are recommended to run sftp/ftp daemons with support
    for chroot(2) to reduce the risk of exposing their filesystems for
    unintended read/write access.

    (ENG-23145, RT:40529, PS-35608, CSCvs88091)

  - netconf: If an xmlns prefix was used in <get-data>'s <xpath-filter>,
    ConfD would reply with an error.  This bug has been fixed so that valid
    prefixes are accepted.

    (ENG-23117)

  - netconf: The data reply for the NETCONF get-data operation now includes
    the following xmlns string for the ietf-netconf-nmda namespace:
    <data xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-nmda"/>

    (ENG-22872)

  - netconf: Errors corresponding to new api operations in RFC 8639
    (Subscribed Notification) now aligns with the RFC specification.

    (ENG-22823)

  - netconf: When a dynamic subscription is killed, deleted, or if a stream
    is removed the notification 'subscription-terminated' is sent. See RFC
    8639 Section 2.7.3. "subscription-terminated".
    The rpc-error responses for 'delete-subscription' and
    'kill-subscription' are aligned with the RFC 8639 and RFC 8640.

    (ENG-22699)

  - netconf: Subscription state change event subscription-completed will be
    sent when provided stop-time has been reached.

    (ENG-22698)

  - netconf: When all replay events have been sent up to either provided
    stop-time or current time, the subscription state change event
    replay-completed will be sent.

    (ENG-22697)

  - netconf: Fixed an issue where NETCONF copy-config with-transaction-id
    returned old transaction-id in reply message.

    (ENG-22694, RT:39819, PS-34896, CSCvs19559)

  - netconf: Providing incorrect subscription id with operations modify-,
    delete- and kill-subscription now results in a proper error response.

    (ENG-22691)

  - netconf: Notifications now work when a notification includes a choice
    from a different namespace than the notification namespace.

    (ENG-22356, RT:39254, PS-34329, CSCvr72130)

  - python-api: When dealing with a large number of open files and sockets
    the Python API could fail with "ValueError: filedescriptor out of range
    in select()". The API is now using poll() instead of select() which
    supports file descriptors > 1023.

    (ENG-23354, RT:41062, PS-36162, SR:688535507)

  - python-api: Python API for server-side filtering provided only one node
    to the data provider. This has been fixed and the full tagpath is
    available now.

    (ENG-23090)

  - restconf: The error tag for an unexpected query parameter has been
    changed from "malformed-message" to "invalid-value", see RFC 8040
    chapter 4.8 Query Parameters for details.

    (ENG-23852)

  - restconf: A proper HTTP error code (403 Forbidden) is now returned if an
    action is invoked in conflict with existing AAA rules denying access.
    This is valid both for the REST API and the RESTCONF API.

    (ENG-22621, RT:39700, PS-34775, CSCvs08708)

  - restconf: If /confdConfig/restconf/rootResource in confd.conf was
    configured as a nested path, GET requests for the RESTCONF Root Resource
    failed and yielded internal server error.

    (ENG-22143, RT:38638, PS-33710, CSCvr29300)

  - toolchain: If a leaf with default value had its type changed via
    deviation the default value was not validated with the new type. This is
    now fixed.

    (ENG-23596, RT:41515, PS-36591, CSCvt66309)

  - toolchain: If a YANG module with an obsolete "augment" statement where
    the nodes in the "augment" were not obsoleted, were compiled with
    "--max-status deprecated", the nodes in the augment would still be
    added. This bug has been fixed so that the nodes are not added.

    (ENG-23108, RT:40376, PS-35456, CSCvs81838)

  - toolchain: If a YANG module with obsolete nodes in an "augment" were
    compiled with "--max-status deprecated", the obsolete nodes would still
    be added. This bug has been fixed so that the obsolete nodes are not
    added.

    (ENG-23029, RT:40376, PS-35456, CSCvs70634)

  - toolchain: Added option --kill-subscription=<subscription id> to tool
    netconf-console.

    (ENG-22769)

  - toolchain: Tool netconf-console can now handle all command line options
    for the operation establish-subscription.

    (ENG-22669)

  - toolchain: If a deviation module contained multiple deviations of a
    given module, some XPath expression would fail to compile with an
    "Invalid namespace prefix" error.  This fix let these XPath expressions
    be compiled without errors.

    (ENG-22231, RT:38620, RT:39101, PS-33692, PS-34174, CSCvr45880)

  - toolchain: confdc and yanger now validate must expressions in augment
    statements with a "when" statement in YANG 1.1 modules.

    (ENG-22173, RT:38962, PS-34034, CSCvr33900)

  - toolchain: If a deviation tried to delete one of many must statements,
    the selected must statement would not be deleted by the compiler.  This
    bug has been fixed so that the deletion works.

    (ENG-21747, RT:38075, PS-33150, CSCvq51461)

  - xpath: Some expressions with descendant-or-self (or "//" in the short
    form) did not return all matching nodes.  This bug was introduced in
    ConfD 7.1, and is now fixed so that all matching nodes are returned.

    (ENG-22763, RT:39911, PS-34988, CSCvs29035)

  - xpath: An xpath-expression using name(), local-name(), or
    namespace-uri() crashed if they were used on a key. Before the fault was
    removed, it could be observed in the CLI as an internal error.

    (ENG-22630, RT:39688, PS-34764, CSCvs10192)

  - xpath: Validation tailf:dependency statement no longer fails on module
    when the statement is annotated from annotating modules to the
    submodules. The statement contains prefixes that imported by annotating
    modules only.

    (ENG-19766, RT:35076, PS-30146)


ConfD-7.3 [November 29, 2019]
=============================

Deprecated:

  - confd: The ConfD build toolchain is being modernized. This impacts the
    oldest version of glibc which is supported for use on Linux. As of the
    ConfD-7.4 release, the minimum version of glibc supported for Linux will
    be glibc-2.19, except for ConfD built for MIPS n32 and n64 ABIs, where
    the minimum version of glibc supported will be glibc-2.16. Additionally,
    the pre-built version of libconfd included in the distribution will be
    linked to libcrypto from OpenSSL 1.1.1.

    (ENG-22666)

  - python-api: Python 3.4 has been deprecated and will be removed in ConfD
    7.5. You should upgrade your Python environment and make sure everything
    works with Python 3.5 or higher.

    (ENG-22280)

  - rest-api: The legacy REST API is deprecated since ConfD 7.1 (released in
    April 2019) and is scheduled to be removed in ConfD 7.4 (tentative
    release date June 2020).
    Users of the legacy REST API should use the RESTCONF API instead. The
    RESTCONF API is a standardized REST interface as defined in RFC 8040 and
    provides a number of improvements over the proprietary and legacy REST
    interface including the support for auto-generating Swagger/OpenAPI
    documents from YANG. Please see the ConfD User Guide Chapter 24.
    Migrating from REST to the
    RESTCONF API. We understand that this may require some adjustments to
    external systems that are integrated with ConfD, please reach out to
    ask-confd-plm@cisco.com if you have any questions or concerns on this topic.

    (ENG-20521)

Removals:

  - confd: otp_test_engine.so was removed from the ConfD release, as it is
    not needed.

    (ENG-22411, RT:39385, PS-34462, CSCvr80117)

  - cdb: cdb_cli_diff_iterate() has been removed.
    cdb_get_modifications_cli() should be used instead.

    (ENG-22327)

  - cdb: cdb_load_file() and cdb_load_str() and their corresponding
    alternatives in the Python and JAVA APIs have been removed.
    maapi_load_config() can be used as an alternative. As a consequence of
    this removal the confd_load -C flag has been removed, it can in most
    common scenarios be replaced with the flags -l -m -O

    (ENG-21673, RT:22320, PS-7148)

  - json-rpc: Using datastore candidate requires that the 'access' mode for
    Running must be set to writable-through-candidate.
    /confdConfig/datastores/candidate/enabled=true
    /confdConfig/datastores/running/access=writable-through-candidate

    (ENG-20840)

  - python-api: Python 2.7 is no longer supported. It will still be possible
    to use Python 2.7 until the next release, but no support will be given.
    Python 2.7 will be completely removed in ConfD 7.4. Please use Python
    3.5 or higher.

    (ENG-22278)

  - restconf: It is no longer possible to use JSON-RPC for login and then
    use the returned session cookie for RESTCONF requests. This behaviour
    was unsupported and has been broken for a long time and is now removed.

    (ENG-22429)

  - restconf: The deprecated RESTCONF query parameters limit and offset have
    now been removed.

    (ENG-20873)

Non-backwards compatible enhancements:

  - confd: If ConfD's crypto.so is built with OpenSSL version 1.1.1.1 or
    later; ConfD's built-in SSH server supports ssh-ed25519 host keys and
    user keys.

    (ENG-22430, RT:38264, PS-33333)

  - confd: Error handling for externalCommand used for encryption strings
    has changed. If the external command fails during startup, the startup
    will abort. If the command fails during a reload the error will be
    logged and the previously loaded keys will be kept in the system.

    (ENG-21444)

  - c-api: Support for 256 bit encrypted strings was added:
    tailf:aes-256-cfb-128-encrypted-string. Make sure that you add a
    encrypted-strings/AES256CFB128 256 bit encryption key to be able to use
    tailf:aes-256-cfb-128-encrypted-string.

    (ENG-21206)

  - java-api: The Java API is now built with a Java 8 compiler and will
    require a minimum of a Java 8 VM.

    (ENG-20799)

  - java-api: Java 6 & 7 are removed as supported Java versions as there are
    no support of them in the Java community. ConfD is now built with Java
    8.

    (ENG-20208, RT:37926, PS-33000)

Enhancements:

  - confd: Progress trace events outputted in the CLI, that have a start and
    stop, are now printed as one line if they occur right after each other.
    For example, the following two events:
     2019-11-15T14:47:22.100 run dependency-triggered validation...
     2019-11-15T14:47:22.122 run dependency-triggered validation done [0.022
    sec]
    will now be printed as:
     2019-11-15T14:47:22.100 run dependency-triggered validation... done
    [0.022 sec]

    (ENG-22581)

  - confd: Optimized performance of an internal function to look up elements
    of the data model in concurrent access scenarios.

    (ENG-22420)

  - confd: Improved performance of loading, adding, and removing kickers for
    systems that have a lot of kickers on the same node.

    (ENG-22260)

  - confd: Whenever a transaction wants to commit and has to wait for other
    writers, the length of the queue is now logged in the developer log.

    (ENG-22249)

  - confd: ConfD is now built with support for Address Space Layout
    Randomization (ASLR).

    (ENG-22079, RT:38850, RT:38007, PS-33921, PS-33082)

  - confd: Add support for VRF and network namespace to extra IP and Port on
    ConfD.
    (1) Add VRF and network namespace support to extra IP and Port for the
    following subsystems or components:
          (a) IPC
          (b) HA
          (c) CLI
          (d) SNMP agent
          (e) NETCONF
    (2) Extend the following configuration parameters in the confd.conf by
    appending VRF and network namespace parameters as one string value
    separated by | symbol:
          (a) /confdConfig/confdIpcExtraListenIp
          (b) /confdConfig/ha/extraIpPorts
          (c) /confdConfig/cli/ssh/extraIpPorts
          (d) /confdConfig/snmpAgent/extraIpPorts
          (e) /confdConfig/netconf/transport/ssh/extraIpPorts
          (f) /confdConfig/netconf/transport/tcp/extraIpPorts

    (ENG-22069, RT:38729, PS-33802)

  - confd: The diffie-hellman-group14-sha256 and
    diffie-hellman-group18-sha512 key exchange algorithms are now supported
    by the built-in SSH server.

    (ENG-21893, RT:37944, PS-33019)

  - confd: Optimized validation of instance identifiers with
    "require-instance true" that do not have "tailf:path-filters".  Such
    nodes used to be validated at every commit (during the "global
    validation" phase), but are now validated only when their target nodes
    have been modified.

    (ENG-21828, RT:38313, PS-33382, CSCvq72028)

  - confd: The performance of ConfD, when dumping out a big configuration,
    e.g. with NETCONF get-config, on a system with many 'when' statements
    and many top-level nodes, was low in ConfD-7.1 compared to older ConfD
    versions. The performance has now been improved, and expected to be on
    par with older versions.

    (ENG-21723, RT:37994, PS-33069, CSCvq44777)

  - confd: Removed extra when evaluation when reading leaf from an internal
    data provider, for example CDB.

    (ENG-21672)

  - confd: The handling of the instance-identifier YANG type is improved
    when CDB upgrade in phase0.

    (ENG-21227)

  - confd: When in-service upgrade failed due to the validation of a new
    namespace, ConfD only returned 'internal error'. That error message has
    been improved now.

    (ENG-21190, RT:36655, PS-31735, CSCvp56059)

  - confd: Add optimization for leafref handling, that would rewrite XPath
    expression, when the leafref path contains subpath, in which the list's
    key is a leafref, points to the target node inside the same instance.

    (ENG-21146, RT:35156, PS-30227)

  - confd: A new development feature for processing/filtering log files
    using an external command is now available. See the "External Logging"
    section of the "Advanced Topics" chapter of the ConfD user guide for
    details.

    (ENG-20564, RT:36565, RT:36640, RT:35448, RT:37328, PS-31645, PS-31720,
    PS-30522, PS-32407)

  - confd: Add support for VRF and network namespaces to ConfD.
    (1) Add VRF and network namespaces support to following subsystems or
    components:
          (a) IPC
          (b) HA
          (c) SNMP gateway
          (d) Subagents
          (e) CLI
          (f) NETCONF
          (g) SNMP agent
    (2) Add new parameters 'vrf' and 'netns' to each of following
    configuration parameters in the confd.conf:
          (a) /confdConfig/confdIpcAddress
          (b) /confdConfig/ha
          (c) /confdConfig/snmpgw/agent
          (d) /confdConfig/subagents/subagent/ssh
          (e) /confdConfig/subagents/subagent/tcp
          (f) /confdConfig/cli/ssh
          (g) /confdConfig/netconf/transport/ssh
          (h) /confdConfig/netconf/transport/tcp
          (i) /confdConfig/snmpAgent

    (ENG-19833, RT:35146, PS-30217)

  - confd: ConfD implements Network Management Datastore Architecture (NMDA)
    as defined in RFC 8342 and supports the mandatory datastores running,
    intended, and operational, and the optional datastores startup and
    candidate.  The NETCONF and RESTCONF protocol implementations in ConfD
    are also extended to support NMDA as defined in RFC 8526 and RFC 8527
    respectively.
    Current implementation does not support the origin metadata annotation.

    (ENG-18294, RT:34066, PS-29232)

  - c-api: A new C-API function, named 'confd_get_base_type', has been
    introduced. Its purpose is to identify if a type is 'string' in YANG,
    but 'C_BINARY' in C.

    (ENG-21725, RT:38043, RT:36746, PS-33118, PS-31826)

  - c-api: Removed a backwards compatibility support method for passing
    display hint strings towards clients, since the method became obsolete.

    (ENG-21520)

  - c-api: cdb_get_modifications_cli() now supports the new flag
    ITER_WANT_CLI_ORDER. The flag is required to get modifications in CLI
    order if the change was triggered using cdb_trigger_subscription().

    (ENG-20569, RT:33366, PS-28851)

  - cdb: Improved the log message in devel-log when an automatic upgrade
    fails because of the dynamic confd.conf not being available. This
    happens when doing an automatic upgrade and a leaf or leaf-list type is
    changed to string, with the data containing a backslash which might need
    quoting.
    You will be encouraged to do a manual upgrade using a script instead.
    The log entry is : "Cannot read dynamic confdconf while upgrading -
    manual upgrade script needed."

    (ENG-20421, RT:35805, PS-30882)

  - cdb: The notifications of cdb_oper_subscribe() is now logged in
    devel.log

    (ENG-16441, RT:28066, PS-8944)

  - cli: The C-style command "show configuration <path>" now accepts range
    expressions in the <path> argument. This makes it possible to issue
    commands such as "show configuration interface vlan1-3". The same
    support has been added to the "compare running brief <path>" command in
    the J-style CLI.

    (ENG-22317, RT:39270, PS-34345, CSCvr62495)

  - cli: A new pipe target has been added to show commands called "icount".
    It instructs the command to display the number of matching instances.
    For example,
    # show running-config aaa authentication users user | icount
    Found 4 instances.
    # show running-config aaa authentication users user * gid 1000 | icount
    Found 4 instances.
    # show running-config aaa authentication users user a* gid 1000 | icount
    Found 1 instance.
    # show running-config aaa authentication users user a* | select gid 1000
    | icount
    Found 1 instance.

    (ENG-22289)

  - cli: The CLI has been adapted to support NMDA, through the new
    (optional) command 'show operational-state'.

    (ENG-22268)

  - cli: The C-style configuration diff (e.g. show configuration), where the
    change-set would contain lists annotated with diff-dependencies
    (tailf:cli-diff-after) would in some cases take a very long time to
    calculate. This has now been optimized.

    (ENG-21796, RT:38157, PS-33232, CSCvq66028, SR:686987935)

  - cli: A new option has been added to the pattern CLI command parameter
    type called "unhide". It allows a space separated list of hide groups to
    be specified. It will be visible during completion of the parameters.

    (ENG-21767, RT:38139, PS-33214)

  - cli: The C-style configuration diff (eg. show configuration), where the
    change-set would contain lists annotated with diff-dependencies
    (tailf:cli-diff-before/after etc.) would in some cases take a very long
    time to calculate. This has been optimised in those cases where the
    dependency XPath expression would not contain any predicates and/or
    other comparisons/function calls.

    (ENG-21551)

  - cli: Two new confd.conf settings have been added for controlling how
    completion alternatives are displayed. It is called
    /confdConfig/cli/showActionCompletions{true/false}, and
    /confdConfig/cli/actionCompletionsFormat{string}. If set to true then
    all completions related to actions will be shown separately under the
    header configured as actionCompletionsFormat. Default is false.

    (ENG-21392, RT:37446, PS-32525, SR:686647299)

  - cli: When using ordered-by user lists performance in the CLI could
    quickly degrade if a lot of entries exist in that list. The performance
    surrounding has been improved.

    (ENG-21335, RT:36676, PS-31756)

  - cli: Command info texts were added to all the intermediate built-in
    commands which missed them.

    (ENG-19633)

  - examples: A new ConfD example was added. It demonstrates CLI pipe
    command addition - exec callback.

    (ENG-21840)

  - examples: Added Python version of example demonstrating usage of
    get_modifications in cdb subscription
    (cdb_subscription/modifications_python)

    (ENG-21811)

  - ha: When a new node with role "slave" is added, more logging has been
    added to shows what kind of data that is being synced. Look for "HA:
    syncing"

    (ENG-19857, RT:34742, PS-29808, SR:685250845)

  - java-api: A data provider may now choose to return a ConfXMLParam[] from
    the getIteratorObject callback, and a List<ConfXMLParam[]> from the
    getIteratorObjectList callback.

    (ENG-21233, RT:37066, PS-32148)

  - java-api: The logging API has been upgraded from log4j 1.2.17 to log4j2
    2.11.1. There are some fundamental changes between log4j and log4j2
    which includes: Configuration files need to be called log4j2.xml or
    .properties instead of log4j.xml.
    The syntax of said configuration files is different.
    Support for old log4j methods exist through a wrapper, however they are
    deprecated. The core API of log4j2 may be changed in minor releases of
    log4j2, which might require changes in our code.

    (ENG-19895, RT:35238, PS-30309)

  - json-rpc: JSON-RPC action input parameters are intended to be treated in
    a similar fashion as config data. This is accomplished by the parameter
    'action_path' to the operation 'new_trans'.

    (ENG-18324)

  - netconf: Added support for RFC 8639 "Subscription to YANG Notifications"
    and RFC 8640 "Dynamic Subscription to YANG Events and Datastores over
    northbound NETCONF".
    The "ietf-subscribed-notifications" YANG module is exported only to
    NETCONF and compiled with features: encode-xml, replay, xpath, and
    subtree, and also deviated to not support storage of subtree filters in
    the configuration.
    The legacy "create-subscription" RPC from RFC 5277 is still supported.
    An example "netconf_notifications_rfc_8639" has been added, which shows
    how the new RPC operation "establish-subscription" can be used.
    Note that the IETF standard modules ietf-ip.yang, ietf-interfaces.yang,
    and ietf-network-instance.yang, are now included in ConfD, since they
    are imported by ietf-subscribed-notifications.yang.  They are compiled
    with conformance "import".  If an application compiles and implements
    these modules, that version is used and advertised by ConfD.

    (ENG-22486)

  - netconf: The fix for ENG-16113 (NACM fix) led to performance degradation
    in some cases. The performance is now roughly the same as before that
    fix.

    (ENG-22053, RT:38806, PS-33877, CSCvr15505)

  - netconf: A new 'confd.conf' option
    '/confdConfig/defaultHandlingModeAlsoSupported' has been added. Using
    this new option, it is possible to let NETCONF's 'get', 'get-config' and
    'copy-config' requests override ConfD's default handling mode. For now,
    it is only possible to override 'report-all' with 'explicit'.

    (ENG-21612, RT:37649, PS-32727)

  - python-api: The classes 'Subscriber', 'OperSubscriber' and
    'TwoPhaseSubscriber' are moved from the 'experimental' module to the
    'cdb' module, and are now officially supported. Existing code using
    these must be updated with the new location of the classes.

    (ENG-22303)

  - python-api: A new method maagic.List.filter() is added to utilize the
    list filter functionality introduced in ConfD 7.1.

    (ENG-19490, RT:29874, PS-9764)

  - rest-api: REST requests and responses are now audit logged.
    After a basic protocol sanity check the REST request is audit logged
    with HTTP method, path, and version.
    When the request is done and the server sends a response, it is audit
    logged with HTTP method, path, version, and duration.

    (ENG-22322, RT:36798, RT:36935, RT:36514, PS-31879, PS-32017, PS-31594)

  - restconf: RESTCONF requests and responses are now audit logged.
    After a basic protocol sanity check the RESTCONF request is audit logged
    with HTTP method, path, and version.
    When the request is done and the server sends a response, it is audit
    logged with HTTP method, path, version, and duration.

    (ENG-22323, RT:36798, RT:36514, RT:36935, PS-31879, PS-31594, PS-32017)

  - toolchain: The 'netconf-console' script has been adapted to support
    NMDA. Two new options, '--get-data' and '--edit-data' have been added.

    (ENG-22358)

  - toolchain: The compiler 'confdc' will now check that specified YANG
    features actually exist, unless '--ignore-unknown-features' is
    specified.

    (ENG-13019, RT:29176, PS-9435)

  - web-server: A number of fixed HTTP headers can now be configured in the
    confd/ncs.conf file, as well as any arbitrary HTTP header. This can be
    done both in the 'webui' part as well as in the 'restconf' part of the
    configuration, independently.

    Note: The X-Frame-Options header didn't work as it wasn't possible to
    modify its default value. Hence it had to be renamed to x-frame-options,
    which is a backwards incompatible change.

    (ENG-21327)

Non-backwards compatible corrections:

  - confd: When maapi_diff_iterate() was called, it was not specified what
    happened if a list entry was both moved and created, or moved and
    modified. The old behaviour was that if the entry was created and moved,
    the callback was invoked twice, once with MOP_CREATED and once with
    MOP_MOVED_AFTER.  But if the entry was modified and moved, the callback
    was only invoked with MOP_MOVED_AFTER.
    This has now changed so that also in the latter case the callback is
    invoked twice, first with MOP_MODIFIED and then with MOP_MOVED_AFTER.
    The behaviour is now documented in confd_lib_maapi(3).

    (ENG-22478, RT:39426, PS-34503)

  - confd: The NACM tests for NETCONF and XML loading have been optimized
    and modified so that they follow the behaviour in RFC 8341.
    Specifically, access is now always checked for the effective operation,
    rather than the incoming operation.

    (ENG-22421)

  - confd: Encrypted strings that are of types
    tailf:aes-256-cfb-128-encrypted-string,
    tailf:aes-cfb-128-encrypted-string and tailf:des3-cbc-encrypted-string
    starting with "$9$", "$8$" and "$7$" respectively are now rejected if
    entered in the wrong context.

    (ENG-22255)

  - confd: When ConfD decoded base64-encoded values, it would silently
    ignore any character outside the base64-alphabet.  This behaviour is
    illegal according to RFC 4648, and it can lead to surprising effects.
    This bug has been fixed.

    (ENG-22018)

  - confd: ConfD ignored standard length statement in hex-string type. This
    has been corrected now.

    (ENG-21680, RT:37877, PS-32951, CSCvq33373)

  - confd: It was not possible to set a leaf of type binary with a
    tailf:display-hint to a base64 encoded value over NETCONF or RESTCONF.
    This bug has been fixed.

    (ENG-20708, RT:35664, PS-30740)

  - c-api: cdb_set_case() failed if choice contained config false statement.
    This has been corrected now.

    (ENG-21593)

  - cdb: Mixed subscribers can now receive configuration and operational
    change notifications arbitrarily interleaved with each other. This comes
    as a consequence of fixing a crash in diff iteration that could happen
    on mixed overlapping subscriptions where the next notification was
    queued before the subscriber synced the subscription. If this is a
    problem, use separate sockets for operational and configuration
    subscriptions. With this change cdb_sync_subscription_socket() now
    rejects CDB_DONE_PRIORITY for operational notifications as initially
    intended.

    (ENG-21957, RT:38609, PS-33681, CSCvq97822)

  - netconf: Starting with ConfD-7.1, setting the confd.conf parameter
    /confdConfig/netconf/capabilities/ietf-with-defaults/enabled to "false"
    accidentally did not have any effect.  This is now fixed so that if this
    parameter is "false", the ":with-defaults" capability is not advertised.

    (ENG-22539)

  - netconf: NETCONF notifications have been corrected so that they respect
    if augmented modules are not exported.

    (ENG-21504, RT:37595, PS-32672)

  - netconf: The netconf-console command now identifies (and returns exit
    status 1) if the server crashed before returning any result.

    (ENG-21489)

  - netconf: The netconf-console command now differentiates between a
    missing xmllint command (exit status 127) and returned bad XML (exit
    status !=0).

    (ENG-21334)

  - rest-api: A user session is now created for every REST API request that
    passes a basic protocol sanity check. Prior to this change the user
    session was created when it was needed, which lead to that some actions
    could be performed without a trace.
    Some bad requests still do not create a user session, this is a trade
    off to avoid flooding the audit log.

    (ENG-22428)

  - rest-api: Deny unauthorized OPTIONS requests.
    HTTP OPTIONS were allowed for unauthorized requests. This could lead to
    information leaks where an unauthenticated attacker could poke resources
    to check for existence.
    HTTP OPTIONS are now denied if they are not authenticated.

    (ENG-22413, CSCvs16485)

  - restconf: Deny unauthorized OPTIONS requests.
    HTTP OPTIONS were allowed for unauthorized requests. This could lead to
    information leaks where an unauthenticated attacker could poke resources
    to check for existence.
    HTTP OPTIONS are now denied if they are not authenticated.

    (ENG-22363, CSCvs16485)

  - restconf: Requesting a single list item should render the JSON output to
    be wrapped inside a list in the same way as requesting the complete
    (parent) list, see: rfc8040#appendix-B.3.9

    (ENG-22025, RT:38480, RT:39131, PS-33549, PS-34204, CSCvr09504)

  - restconf: A user session is now created for every RESTCONF request that
    passes a basic protocol sanity check. Prior to this change the user
    session was created when it was needed, which lead to that some actions
    could be performed without a trace.
    Some bad requests still do not create a user session, this is trade off
    to avoid flooding the audit log.
    Additionally the deprecated and defunct method of using JSON-RPC to
    login and using that session cookie for RESTCONF requests have been
    removed. See ENG-22429.

    (ENG-19138)

Corrections:

  - confd: A subtree filter on a leaf node in a notification subscription
    did not take effect and the notification was not sent. A correction has
    been made such that a generated event for the leaf node is now filtered
    ok and sent on as a notification.

    (ENG-22603)

  - confd: ConfD would try to set the users groups when executing a sub
    command as root. This has been fixed.

    (ENG-22468, RT:39464, PS-34542, CSCvr89095)

  - confd: An incomplete list iteration using MAAPI left resources allocated
    on the server side as long as the transaction was still alive. This led
    to increased memory usage in the ConfD server. A call to
    maapi_destroy_cursor() now cleans up resources on the server as well as
    the client. For this fix to have any effect, both the client and the
    server need to be updated.

    (ENG-22461, RT:39314, PS-34389, CSCvr87895)

  - confd: Corrected a bug where a mandatory leaf under a choice would not
    be removed when doing a delete on the leaf through the CLI or JSON-RPC.

    (ENG-22316)

  - confd: The cipher AES CFB 128 is now using the EVP interface for all key
    sizes. This means that using that cipher with FIPS mode works as
    expected, where applicable.

    (ENG-22234)

  - confd: There was a bug in NETCONF delete on leafs with when- and
    default-expressions, this bug also affected any other delete with
    "delayed_when" enabled such as maapi_set_delayed_when. For the user it
    looked like the leaf with the when-expression had already been deleted.

    (ENG-22162)

  - confd: Fixed cases where multiple simultaneous write transactions could
    result in unnecessary back-off and log entries saying "the datastore
    running is locked in CDB"

    (ENG-22142)

  - confd: Loading Juniper style files using one of maapi_load_config(),
    "load merge" in the CLI or loading rollback files now honors ordering of
    items when updating ordered-by user lists.

    (ENG-22132, RT:38113, PS-33189, CSCvr25873)

  - confd: If a module had two leaf-lists of leafrefs to different targets,
    tab completion in the CLI would not work. This bug was introduced in 7.1
    and is now fixed.

    (ENG-22075, RT:38860, PS-33931, CSCvr21270)

  - confd: The ConfD installer would fail to report missing libraries when
    run on a system using the BusyBox implementation of the "head" command.
    This has been fixed.

    (ENG-21928)

  - confd: Loading configuration with maapi_load_config() in a read-only
    transaction caused the transaction to crash and print an internal error
    to the error log. maapi_load_config() is now instead returning an
    appropriate error.

    (ENG-21817, RT:38261, PS-33330)

  - confd: If ConfD was abruptly taken down while initializing a NETCONF
    notification stream, it could corrupt the associated stream file in a
    way that made restarting ConfD fail.

    (ENG-21806, RT:38068, RT:38285, PS-33143, PS-33354, CSCvq68405)

  - confd: For some types in a YANG module (leaf-list or typedefs of
    leafrefs), ConfD would trigger a CDB upgrade if the YANG module was
    recompiled, even though it wasn't changed.

    (ENG-21804, RT:38416, RT:38158, PS-33485, PS-33233)

  - confd: When rollback7 was missing in the sequence 0-9, and the user
    tried to rollback 9, only 8 and 9 would be rolled back. Now 0-6 are
    rolled back as well.

    (ENG-21718, RT:37633, PS-32711, CSCvq42394)

  - confd: ConfD leaked memory when wildcards were given in some CLI show
    commands.

    (ENG-21688, RT:37779, PS-32853)

  - confd: Some clients were not prepared for configuration changes
    affecting the log subsystem. Those clients are now prepared for this
    scenario.

    (ENG-21685, RT:37709, PS-32785, CSCvq33976)

  - confd: `xsd:dateTime_string` for NETCONF events are now rendered
    correctly.

    (ENG-21599, RT:37685, PS-32761, CSCvq12812)

  - confd: A leaf with default value having an ancestral when-statement
    re-evaluating to true now have the proper default value instead of a
    resurrected non-default value.

    (ENG-21584)

  - confd: When invoking 'confd --status' to get authorization callbacks
    info, ConfD returned '<Internal error>'.  Now proper callback
    information is returned.

    (ENG-21544, RT:37688, PS-32764, CSCvq07237)

  - confd: When a transaction using candidate, while having running/access
    configured to "read-write", was committed to running. Some
    when-expression evaluation resulted in an incorrect evaluation,
    resulting in an internal error. This was corrected by fixing the faulty
    when-expression evaluation.

    (ENG-21505)

  - confd: A dependency between NETCONF and REST(CONF) was removed making it
    possible to remove the REST component in a stripped ConfD system.

    (ENG-21487, RT:37531, PS-32608, CSCvp93651)

  - confd: If a mandatory action parameter has a "when" expression, when
    modifying a dependent node, ConfD aborted that action due to 'the action
    param is not configured'. This behaviour is corrected now.

    (ENG-21400, RT:37455, PS-32534, CSCvp76406)

  - confd: The ConfD notification did not work if both 'file' and 'syslog'
    were set to 'false'. Notifications are now working for this scenario.

    (ENG-21395, RT:37861, RT:38025, RT:37399, PS-32935, PS-33100, PS-32478,
    CSCvp75137)

  - confd: Fix regression introduced in ConfD 7.1 where delete of must
    statements using deviations did not work.

    (ENG-21339, RT:37350, PS-32429, CSCvp64105)

  - confd: ConfD failed when converting identityref value if the import
    prefix was different from the module prefix. This has been fixed now.

    (ENG-21273, RT:37207, RT:37603, PS-32287, PS-32680, None)

  - confd: When-dependencies escaping multiple lists are now properly
    handled.

    (ENG-21235, RT:39805, RT:30749, RT:37174, PS-34882, PS-27024, PS-32254,
    None)

  - confd: The following two issues have been fixed:
    (1) When a list entry is created, 'set_elem' was not invoked for the
    descendant leaf with a default value. The set_elem callback is now
    invoked.
    (2) When CONFD_DAEMON_FLAG_NO_DEFAULTS is set and a list entry is
    created, 'remove' was invoked for the descendant leaf with a default
    value and a validation statement such as 'must'. The remove callback is
    no longer invoked.

    (ENG-20809, RT:38577, RT:36402, PS-33649, PS-31482)

  - confd: If a tailf:display-hint was used in a submodule that augmented
    another node in the same module, the display-hint would not be applied.
    This bug has been fixed.

    (ENG-20193, RT:35664, PS-30740)

  - confd: Fixed performance degradation of leaf-list validation when the
    leaf-list is of type leafref pointing to a non key leaf.

    (ENG-20022, RT:35422, PS-30496)

  - confd: Leaf with default value and validation popped up as deletion in
    diff_iterate with suppress_default. This behaviour has been corrected
    now.

    (ENG-19977)

  - confd: Conflicts with regards to ordered-by-user lists are now detected.
    If two transactions modify an ordered-by-user list simultaneously the
    last one to commit may have conflicts that are non-resolvable, i.e. the
    transaction must be aborted.

    (ENG-19915, RT:35298, PS-30372, SR:685536295)

  - confd: Subscribers now get delete notifications for default leafs in a
    default case when the case changes.

    (ENG-17921, RT:31991, PS-27863)

  - c-api: Added support for the CLI turbo parser through
    'maapi_load_config_cmds'.

    (ENG-22408, RT:39315, PS-34390, CSCvr78607)

  - c-api: If a MAAPI client closed its socket during a
    maapi_iterate/maapi_diff_iterate session the user session was left
    unterminated. Now ConfD terminates the user session.

    (ENG-22361, RT:39256, PS-34331, CSCvr72333)

  - c-api: The libconfd API library integration with OpenSSL's libcrypto
    used OpenSSL low level cryptography API functions such as non FIPS
    compliant AES_set_encrypt_key(). The libconfd integration with libcrypto
    was rewritten to use OpenSSL's high level EVP API instead.

    (ENG-22176, RT:38945, PS-34017, CSCvr34645)

  - c-api: Passing a path with a superfluous trailing slash to
    confd_cs_node_cd() would trigger an error report from valgrind. This bug
    was introduced in ConfD-7.1 and has now been fixed.

    (ENG-21836, RT:38357, PS-33426)

  - c-api: If ConfD was killed or an unexpected error occurred during shared
    schema loading from C (and Python) the client process could terminate
    with SIGABRT due to an attempt to free a pointer using the wrong free
    function.

    (ENG-21715, RT:37735, PS-32809, CSCvq42206)

  - cdb: Combining config true and config false subscriptions on the same
    subscription socket no longer causes an internal error, if the client
    disconnects while notifications for both types are being delivered. This
    regression has been introduced in ENG-21957.

    (ENG-22469, RT:39496, PS-34574, CSCvr89145)

  - cdb: If an in-service upgrade was interrupted it could in some cases
    crash ConfD, now it aborts the upgrade properly.

    (ENG-22384, RT:39117, PS-34190, CSCvr76077, SR:687580362)

  - cdb: A regression was introduced when ENG-21752 was fixed that caused
    cdb_exists() to return an incorrect response for missing nodes under an
    active case. cdb_exist() now returns false if the node is missing.

    (ENG-22321, RT:39268, PS-34343, CSCvr63878)

  - cdb: Leaves with a default value and a relative when expressions under a
    choice could get the when expression evaluated to false even though it
    should be true. This error was specific to reads using the CDB API.

    (ENG-22174, RT:38784, PS-33857, CSCvr34082)

  - cdb: When there is a CDB subscription in inactive mode
    (/confdConfig/enableInactive set to true, default is false), ConfD
    correctly sends notification for children node when there is a deletion
    on parent node.

    (ENG-22058, RT:38688, PS-33761, CSCvr16348)

  - cdb: cdb_get_modifications_cli() did not generate CLI commands for
    reordered leaf-lists. The algorithm for evaluating the previous state of
    CDB was faulty for moved entries in leaf-lists. CLI commands are now
    generated for such cases.

    (ENG-21986, RT:38641, PS-33713, CSCvr02599)

  - cdb: If a leaf in an ongoing transaction was modified and another
    transaction deleted and committed the same leaf, the first transaction
    would be left in an invalid state leading to corrupt data when
    committed.

    (ENG-21921, RT:38382, PS-33450, CSCvq91943)

  - cdb: If the module containing base identity was not changed while the
    module containing identityref was changed, ConfD crashed when upgrading
    YANG data model with 'undefined_identity' error. This crash has been
    fixed now.

    (ENG-21793, RT:38416, RT:38439, RT:38388, RT:38158, RT:39163, PS-33485,
    PS-33508, PS-33457, PS-33233, PS-34236, CSCvq64547)

  - cdb: cdb_exists() returned 'yes' for node with a false 'when' condition.
    This has been fixed now.

    (ENG-21752, RT:38085, PS-33161, CSCvq53227)

  - cdb: When there is a CDB subscription - cdb_subscriber() on a node under
    a list instance, and that node only exists in some list instances. If
    there is a delete on all list instances, then cdb_diff_iterate() with
    ITER_WANT_ANCESTOR_DELETE call the iteration function for all list
    instances. This has been corrected now. ConfD call the iteration
    function for list instance that has subscribed node only.

    (ENG-18303, RT:32482, PS-28198)

  - cli: The confd_cli program would be likely to crash if it was started
    with a command-line parameter exceeding 2k characters in length. There
    is no longer any limit imposed by the confd_cli program on the size of
    the command-line parameters. The program will terminate with an error
    message if it fails to allocate the required memory and should not crash
    due to the length of the command-line parameters.

    (ENG-22524)

  - cli: When presenting tables of data across multiple nodes the CLI could
    crash if the internal data was using similar prefixes but with different
    namespaces. The fix  makes sure that the crash does not occur and also
    allows this operation to be performed.

    (ENG-22467, RT:39377, PS-34454, CSCvr89079)

  - cli: When processing range expression supplied as a value for a
    leaf-list with tailf:cli-range-list-syntax the boundaries check was
    performed after the range expression was expanded into a full list of
    values. Thus it was possible to exhaust memory by supplying very large
    invalid values for range expressions.
    Now the boundaries check is performed before any other range expression
    processing.

    (ENG-22426, RT:39413, PS-34490, CSCvr82926)

  - cli: Using only the leaf name of boolean leafs as path filters to the
    C-style operational command 'show running-config' when the name of the
    leaf was 'enabled' would not work correctly, even though the confd.conf
    setting '/confdConfig/cli/useShortEnabled' was set to 'false'. This has
    been fixed so that providing only the leaf name as a path filter will
    now work as for other leafs if the above confd.conf setting is set to
    'false'.

    (ENG-22416, RT:39390, PS-34467, CSCvr80277)

  - cli: Completion of a show command for a list instance would take a long
    time if some leaf in the list had a when or must expression that was not
    satisfied. The full list was searched to determine if any instance
    satisfied the expression. This has been changed such that, by default,
    only 50 instances are examined. The old behaviour can be achieved by
    setting the /confdConf/cli/matchCompletionSearchLimit to unbounded. It
    can also be set to 0 for the quickest completion result.

    (ENG-22357)

  - cli: The CLI would bring down the entire node when completion was
    invoked and the list of completion candidates was exactly the width of
    the terminal minus 6 characters (an abnormal node name or key in most
    cases). This has been fixed.

    (ENG-22338)

  - cli: When setting the confd.conf setting
    /confdConf/cli/noEmbeddedComments to true, values containing an
    exclamation mark (in the C-style CLI) would unnecessarily be quoted.
    Now, when setting noEmbeddedComments to true an exclamation marks in the
    value will not trigger quoting.

    (ENG-22301, RT:36788, PS-31869, CSCvr58483)

  - cli: Combining the leaf prompting confd.conf setting with containers in
    the CLI could result in erroneous prompting for non-leaf data nodes.
    This has been fixed.

    (ENG-22200)

  - cli: Auto-completion would in some cases not work correctly on nodes
    annotated with tailf:cli-key-format. This has been fixed.

    (ENG-22198, RT:39009, PS-34081)

  - cli: Leafs with name "disabled" could have been processed as boolean
    with regard to handling useShortEnable option, even if the actual leaf
    type is not boolean. This has been fixed.

    (ENG-22161)

  - cli: Modifying a range of instances of a list where the type of the key
    was a union would in some cases not work as expected depending on the
    order of how the sub-types were declared in the union in the YANG model.
    This has been fixed.

    (ENG-22156, RT:38932, PS-34004)

  - cli: The C-style configuration diff after modifying a leaf annotated
    with tailf:cli-hide-in-submode and tailf:cli-remove-before-change was in
    some cases not correct. This has been fixed.

    (ENG-22152, RT:38571, PS-33643, SR:687224055)

  - cli: CLI commands that ask for input (e.g. for a leaf value) were not
    recorded to audit.log correctly. This has been fixed, so now a CLI
    command that asks for value will be recorded in two lines where the
    first line is typed command, the second line - the value supplied after
    the command asked for input.
    This does not concern callbacks, custom commands provided via CLI spec
    or any external binaries.

    (ENG-21994, RT:36812, RT:38631, PS-31893, PS-33703, CSCvr04525)

  - cli: Curly bracket diffs for leaf-list elements would first remove all
    elements, then insert all elements, including modifications. This has
    changed such that only the changes are displayed, i.e. deleted and added
    entries.

    (ENG-21982, RT:38622, PS-33694, CSCvr01721, SR:687339043)

  - cli: cdb_cli_diff and the command 'show configuration' would display a
    faulty command when a leaf of type boolean with the tailf:cli-boolean-no
    annotation was deleted.

    (ENG-21964, RT:38618, PS-33690)

  - cli: Re-directing a textfile containing a large number of commands to
    the confd_cli executable, while providing the confd_cli option
    '--interactive', would in some cases cause the CLI to hang. This has
    been fixed.
    Note that this fix includes a newer version of the protocol between
    confd_cli and ConfD, which means that older versions of clistart.c (as
    provided in the release) can not be used with this release.

    (ENG-21854, RT:36699, RT:38160, PS-31779, PS-33235, CSCvq78538)

  - cli: The CLI could encounter an "internal error" when an incorrect file
    was used with the "compare file" command in C-style CLI. Now the CLI
    will give a more sensible error message.

    (ENG-21853, RT:38380, PS-33448, CSCvq77967)

  - cli: Executing range expression in the CLI no longer leaks processes
    that never complete.

    (ENG-21812, RT:38270, PS-33339, CSCvq70192)

  - cli: The tab-completion and execution for RPC/action nodes didn't
    present similar results in the CLI. This has been corrected so the
    execution would behave more according to the tab-completion.

    (ENG-21762, RT:38193, PS-33264, CSCvq57911)

  - cli: The tailf:info tag would not present anything useful in the CLI for
    RPC/action-nodes. This has been corrected and can now be added to these
    nodes. Please note that any tailf:info on the mount-point-nodes won't be
    used for the RPC/action-node.

    (ENG-21758, RT:38176, PS-33247, CSCvq56249)

  - cli: Command completion would fail after entering an instance identifier
    value.

    (ENG-21751, RT:38141, PS-33216, CSCvq53220)

  - cli: The initialization of "user" parameter for confd_cmd is updated to
    have "system" as the default value, the output of "confd_cmd -h" is
    updated to indicate this behaviour.

    (ENG-21748, RT:38074, PS-33149)

  - cli: An internal error would be generated when the command 'show commit
    changes XXX' was run and fixed rollback numbering was used.

    (ENG-21742, RT:38055, RT:38225, PS-33130, PS-33297, CSCvq49045)

  - cli: The CLI would not display mandatory leaves with the
    tail:cli-boolean-no annotation when performing completion for the no
    command in C-style.

    (ENG-21717, RT:38013, PS-33088, CSCvq42316)

  - cli: Fix internal error when a param is used before other which makes
    impossible use it.

    (ENG-21693, RT:37943, PS-33018, CSCvq37216)

  - cli: Using the tailf:cli-case-insensitive extension on list keys
    wouldn't always show keys with different upper/lower-cases. This has
    been fixed.

    (ENG-21668, RT:37795, PS-32867, CSCvq27893)

  - cli: The C-style 'show parser dump' command would display an internal
    error if any data model contained an action or RPC having a parameter
    with an tailf:display-when annotation referencing the value of some
    other parameter.

    (ENG-21613, RT:37750, PS-32824, CSCvq16472)

  - cli: The CLI would be restarted when entering ambiguous commands stacked
    with a semicolon in C-style. This has been fixed.

    (ENG-21590, RT:38689, RT:37728, RT:38958, PS-33762, PS-32804, PS-34030,
    CSCvq12232)

  - cli: Deleting a leaf of type boolean with default value "true" and the
    annotation tailf:cli-boolean-no no longer results in the erroneous
    display of "no ..." for that leaf.

    (ENG-21574, RT:36875, PS-31957, CSCvq10490)

  - cli: The configuration diff (as displayed by 'show configuration') after
    re-ordering the instances of an 'ordered-by user' list annotated with
    tailf:cli-show-obu-comments, tailf:cli-sequence-commands and its
    substatement tailf:cli-reset-siblings would in some cases display the
    list in an incorrect order.

    (ENG-21548, RT:37588, PS-32665)

  - cli: When doing "compare running brief" in shared configuration mode in
    Juniper style an internal error was encountered. This has been fixed.

    (ENG-21508, RT:37573, PS-32650, CSCvp98358)

  - cli: The CLI would not provide proper TAB completion for wildcard or
    range expressions in parameters to actions, provided the action
    parameter was a list where the key element was of type "union". This has
    been fixed.

    (ENG-21436)

  - cli: The CLI turbo parser has been corrected, so that it will not delete
    'tailf:cli-prefix-key' leafs without the full path to the list instance
    they belong to.

    (ENG-21401)

  - cli: The CLI would crash on completion of a leaf-list where the type of
    the key was an enumeration. This has been fixed.

    (ENG-21397, RT:39302, PS-34377)

  - cli: The CLI would incorrectly accept a command to set a leaf without a
    value even when leaf prompting was disabled. This has been fixed. A new
    CLI session state command has also been introduced called leaf-prompting
    that can be set to true or false per session.

    (ENG-21361)

  - cli: When the maapi tool (or any other command using MAAPI API) is used
    as an external command to set data, sometimes data was not set in the
    correct internal transaction. This has been corrected.

    (ENG-21290, RT:37229, PS-32310, CSCvp55114)

  - cli: Updated the delete behavior for CLI and JSON-RPC. Does not delete
    nodes if child nodes cannot be deleted due to NACM rules. This includes
    a speed improvement on load configuration where there is a delete on old
    configuration.

    (ENG-21267)

  - cli: The combination of presence container, annotation
    tailf:cli-flatten-container and tailf:cli-reset-container did not work
    together properly. This has now been fixed.

    (ENG-21202, RT:37110, PS-32192)

  - cli: The tailf:cli-diff-delete-before annotation on container/list
    members had not been taken into account when the parent had been
    annotated with tailf:cli-recursive-delete. This is fixed.

    (ENG-21039)

  - cli: Using "tailf:export none" on a YANG module would sometimes still
    expose data nodes within the CLI. This has been fixed.

    (ENG-20819, RT:36635, PS-31715)

  - cli: The extension tailf:display-groups would in certain cases in the
    CLI be visible on the wrong data node or fail to tab-complete. This has
    been fixed.

    (ENG-20780, RT:36403, PS-31483)

  - cli: Running the command "show commit list 0" would display all commits
    instead of no commits. Now it will display an empty list instead.

    (ENG-20104, RT:35582, PS-30656)

  - cli: When calling operational-commands from config-mode in the CLI the
    range-expressions didn't always work as expected. This has been fixed.

    (ENG-19483, RT:33913, PS-29165)

  - cli: Comments in saved configurations would not be attributed correctly
    to "enabled" leaves when re-loaded if the useShortEnabled was set to
    true in the confd.conf file. Comments are now attributed correctly to
    "enabled" leaves when loaded from a saved configuration file.

    (ENG-18063, RT:32132, PS-27972)

  - cli: It was not possible to enter the sub-mode of a container annotated
    with tailf:cli-add-mode or a list, if the only child of the node was an
    action. This has been fixed.

    (ENG-13948, RT:16903, RT:38272, PS-4841, PS-33341)

  - cs_trans: The order of nodes in copy instance does matter when
    performing a CLI copy command. Now, CLI copy command shall succeed
    regardless of the order of nodes.

    (ENG-22473, RT:39469, PS-34547, CSCvr89789)

  - cs_trans: Update delete behavior for CLI/JSON-RPC to handle deletes of
    non-presence containers containing a mix of leafs and choices with case
    statements including more non-presence containers. Deletion of
    non-presence containers could crash write transactions.

    (ENG-22183, RT:38784, PS-33857)

  - cs_trans: A performance regression introduced in ENG-19859 affected CLI
    output generation with large lists. The list traversal only use XPath
    filtering if a filter is given.

    (ENG-22164, RT:38966, PS-34039, CSCvr32111)

  - cs_trans: A commit with transformed entries interrupted by a validation
    hook could in certain cases remove changes from the change set if those
    changes were done to an ordered-by user list.

    (ENG-21956, RT:38220, RT:38554, RT:38993, PS-33292, PS-33626, PS-34065,
    CSCvq97459, SR:Internal)

  - documentation: The audit log configuration documentation now clearly
    states that user actions performed in CLI or on northbound interfaces
    are logged.

    (ENG-22339)

  - documentation: Documentation describing the CLI turbo parser has been
    added.

    (ENG-22331, RT:39298, RT:39424, PS-34373, PS-34501, CSCvr67564)

  - documentation: The ConfD man page is updated with the missing
    preflight-check options.

    (ENG-21878)

  - examples: Add module name prefix to URL resources in RESTCONF
    instructions. Prefixing resources with module name is required by RFC
    8040 RESTCONF Protocol.

    (ENG-21654, RT:38134, PS-33209)

  - java-api: Fixed an issue with Maapi.setValues() giving an error when a
    tag with the hash value between 2^31 and 2^32-1 was used in the provided
    ConfXMLParam structure.

    (ENG-22000)

  - java-api: The equals() methods of Navu nodes would sometimes incorrectly
    return true for two nodes sharing the same position in the schema but
    belonging to different list entries in the data tree. This has been
    fixed, two Navu nodes must now have identical ConfPaths to be considered
    equal.
    An issue where InstancePath.equals() would sometimes incorrectly return
    false has also been fixed.

    (ENG-21424, RT:37442, PS-32521, CSCvp79290, SR:686599746)

  - json-rpc: Transaction changeset involving unhidden groups was formed
    incorrectly.

    (ENG-21716, RT:38790, RT:37980, PS-33863, PS-33055, CSCvq42259)

  - json-rpc: Action calls involving augmented modules lacked namespace
    information.

    (ENG-20640, RT:36317, PS-31396)

  - netconf: A bug in the XML parser would sometimes fail valid requests
    with the error message "... is not a valid prefix". This has been fixed.

    (ENG-22360, RT:35847, RT:38495, RT:38707, RT:38542, PS-30924, PS-33564,
    PS-33780, PS-33612, CSCvr72297)

  - netconf: copy-config operation with-defaults report-all-tagged now
    includes xmlns declaration for the ws prefix used in the result.

    (ENG-21382, RT:37312, PS-32392, CSCvp71161)

  - netconf: Hidden fields were exposed in NETCONF notifications, they are
    no longer.

    (ENG-20917, RT:36736, PS-31816)

  - netconf: Redundant namespaces that could appear in RPC replies (to
    NETCONF filters) have been removed.

    (ENG-19723, RT:35054, PS-30124)

  - python-api: The High Level MAAPI Action will only end user sessions it
    has started itself, when used in a context manager. This means it will
    not cause an 'Error: internal error' when invoked from the CLI.

    (ENG-21438, RT:37501, PS-32578, CSCvp93689)

  - rest-api: ETag header value is now enclosed in quotes conforming to
    RFC7232.

    (ENG-21283, RT:37247, PS-32328, CSCvp53815)

  - restconf: For an unsupported Accept header format, at return of a 406
    Not Acceptable, the correct content format (JSON or XML) is now used,
    based upon the presence of a Content-Type header in the request.

    (ENG-22399, RT:39380, PS-34457, CSCvr77175)

  - restconf: A RESTCONF PATCH request with an invalid key caused internal
    server error.

    (ENG-21898, RT:38466, PS-33535, CSCvq87986, SR:686992500)

  - restconf: Improved error handling of the YANG Patch functionality when
    wrong input is used for the 'operation' and/or 'where' elements.

    (ENG-21851, RT:38304, PS-33373, CSCvq76632)

  - restconf: According to the RFC 8072, a YANG Patch delete operation
    should not contain a value payload.
    This fix handles the case when such a combination exist anyway in a YANG
    Patch request.

    (ENG-21827, RT:38303, PS-33372, CSCvq72016)

  - restconf: Parameter dry-run did not work for YANG Patch requests, but
    with this fix it does work.

    (ENG-21692, RT:37930, PS-33004, CSCvq36041)

  - restconf: Requesting an unsupported encoding from RESTCONF now correctly
    returns a 406 Not Acceptable.

    (ENG-21600, RT:37737, PS-32811, CSCvq14099)

  - toolchain: New yanger behaviour: If there is a typedef leafref with a
    bad path, and there is no node using it, then yanger does not report
    that typedef as error when compiling. Yanger only reports the typedef if
    there is at least one node using it.

    (ENG-21900, RT:36899, RT:38440, PS-31980, PS-33509, CSCvr00001)

  - toolchain: The development tool netconf-console now works with Python
    2.6 again.

    (ENG-21768, RT:38070, PS-33145)

  - toolchain: If a leafref target had a deviation "not-supported", the
    confdc compiler would fail with "internal error".  Now a proper error
    message is returned.

    (ENG-21497, RT:37598, PS-32675, CSCvp93772)

  - toolchain: If a path refers to the top node, yanger reports the error
    'the path refers to top node' when compiling the YANG model.

    (ENG-20279, RT:36026, RT:35674, PS-31105, PS-30750)

  - toolchain: A bug in the YANG compiler has been fixed, preventing
    compilation to crash.

    (ENG-19874)

  - toolchain: If a config true node was deviated to config false, the
    descendant nodes were still config true. This bug has been fixed so that
    the node's descendant nodes are now also config false.

    (ENG-17211, RT:30926, RT:38506, RT:34414, PS-27165, PS-33575, PS-29471)

  - toolchain: 'confdc --mib2yang-std' used to generate invalid YANG modules
    when the DESCRIPTION or DEFVAL in the source MIBs contained backslashes.
    This has been fixed, backslashes are now escaped.

    (ENG-16776, RT:27343, PS-8678)

  - web-server: The 'Content-Type' HTTP header will now also include a
    'charset=UTF-8' part for mime types 'text/*'.

    (ENG-22271)

  - web-server: The Content-Security-Policy HTTP header is now always sent.
    Note that its value may be changed (or turned off) in the confd.conf
    configuration.

    (ENG-22270)

  - web-server: Some unused .xsd files were removed.

    (ENG-21794, RT:38249, PS-33318, CSCvq83494)

  - web-server:  For content types: 'text/*' , 'application/javascript' and
    'application/json' , a 'charset=UTF-8' part will be appended.

    (ENG-20985)

  - web-server: The HTTP 'strictTransportSecurity' header is now always sent
    with the default value (or any other configured value) as specified in
    the confd.conf file. Note: by setting the value to "empty" it will turn
    off the sending of this HTTP header.

    (ENG-20380)

  - web-server: The HTTP 'xFrameOptions' header is now always sent with the
    default value (or any other configured value) as specified in the
    confd.conf file. Note: by setting the value to "empty" it will turn off
    the sending of this HTTP header.

    (ENG-19947)

  - web-server: The HTTP 'xContentTypeOptions' header is now always sent
    with the default value (or any other configured value) as specified in
    the confd.conf file. Note: by setting the value to "empty" it will turn
    off the sending of this HTTP header.

    (ENG-19491)

  - xpath: If a wildcard was used as a tag after a prefix (e.g.
    "/yanglib:*"), it wouldn't match any tags.  This bug has been fixed.

    (ENG-21995, RT:38669, PS-33748, CSCvr05544)

ConfD-7.2 [June 26, 2019]
=========================
Deprecated:

  - CDB: cdb_load_file() has been deprecated and will be removed in
    ConfD-7.3.
    Use maapi_load_config() with MAAPI_CONFIG_OPER_ONLY flag to load only
    operational data and ancestors to operational data nodes.
    This functionality is also available via the -O option to 'confd_load'.

    (ENG-17208)

-   json-rpc: Json-rpc API deprecates the combination of having configured
    the running datastore access to "read-write" while having the candidate
    datastore enabled. From version Confd-7.3 this combination will not be
    allowed for access via the json-rpc api. If candidate is used, the valid
    combination is:
    /confdConfig/datastores/candidate/enabled=true
    /confdConfig/datastores/running/access=writable-through-candidate

    (ENG-20544)

  - python-api: Support for Python 2 (2.7.x) is deprecated and will be
    removed in ConfD-7.3.
    The Python Software Foundation will not support Python 2 past January
    2020 and even today 2.7 receives little to no attention.
    Software written specifically for Python 2 should be migrated to support
    Python 3.

    (ENG-20207)

  - rest-api: The legacy REST API is deprecated since ConfD 7.1 (released in
    April 2019) and is scheduled to be removed in ConfD 7.3 (tentative
    release date November 2019).
    Users of the legacy REST API should use the RESTCONF API instead. The
    RESTCONF API is a standardized REST interface as defined in RFC 8040 and
    provides a number of improvements over the proprietary and legacy REST
    interface including the support for auto-generating Swagger/OpenAPI
    documents from YANG. Please see the ConfD User Guide Chapter 24.
    Migrating from REST to the
    RESTCONF API. We understand that this may require some adjustments to
    external systems that are integrated with ConfD, please reach out to
    ask-confd-plm@cisco.com if you have any questions or concerns on this topic.

    (ENG-20521)

  - restconf: RESTCONF query parameters "limit" and "offset" are deprecated
    and will be removed in ConfD-7.3.
    The query parameters "limit" and "offset" which also exist in the
    REST API could also be used in RESTCONF. However these aren't
    standardized and didn't work as intended. Users of these query
    parameters should use the extension REST Query API instead.

    (ENG-20872)

Enhancements:

  - confd: The internal function for looking up elements in the data model
    was rewritten to consume less memory in 7.1. While the rewrite mostly
    resulted in higher performance there were a few corner cases that became
    slower. This has now been fixed and the overall performance should be
    improved as a result. A new confd.conf setting has been added for
    controlling the level of compression used.
    /confdConfig/compressedSchemaLevel{1..2}. Compression level 1 is the
    most memory efficient, but also significantly more time consuming. Level
    2 is somewhere between compressed and uncompressed in terms of memory
    usage but almost as fast as uncompressed.

    (ENG-21149, RT:37051, PS-32132, CSCvq10626)

  - confd: Optimized some XPath evaluations when traversing large lists.

    (ENG-21122)

  - confd: Added progress trace entries for events when a transaction is
    being applied.

    (ENG-20983, RT:37145, RT:36951, PS-32227, PS-32033)

  - confd: It is now possible to perform a set of checks on a confd.conf
    file using the confd command without starting ConfD. Three new options
    are introduced:
    Usage: confd [--preflight-checks ConfFile] [--exclude-checks Checks] |
                 [--print-checks]
     --preflight-checks ConfFile
         Perform a set of checks on ConfFile without starting ConfD.
         ConfFile is the absolute path to a confd.conf file.
      --exclude-checks Checks
         Do not perform Checks when confd --preflight-check ConfFile
         is used. Checks are separated by space and must be a subset
         of available checks.
      --print-checks
         Print all available preflight checks that are performed when
         confd --preflight-checks ConfFile is used.

    (ENG-20843)

  - confd: A new confdConfig parameter disableSchemaUriForAgents is
    introduced to disable schema URI in the ietf-yang-library:modules-state
    resource response when confdConfig/restconf is enabled.
    confdConfig/disableSchemaUriForAgents is a leaf-list that can be set to
    'netconf' or/and 'rest'. If set to 'netconf' then NETCONF reply will not
    contain schema uri. By default, it is set to not disable schema uri from
    any agent.
    Usage example:
      <disableSchemaUriForAgents>netconf</disableSchemaUriForAgents>
      <disableSchemaUriForAgents>rest</disableSchemaUriForAgents>

    (ENG-20082, RT:35399, PS-30473)

  - confd: Add support for storing TLS data in database. It is possible to
    store one set of private key, certificate, and CA certificates. Support
    for password based encryption (PBE) of the private key is possible. If
    the private key is encrypted, the password must be supplied as well. For
    more details see the ConfD User Guide Chapter 21.4 Storing TLS data in
    database.

    (ENG-20065, RT:35872, PS-30950)

  - confd: The built-in SSH server now supports private key files in OpenSSH
    and PKCS#8 format in addition to the PKCS#1 format.

    (ENG-19837, RT:34881, RT:36299, RT:36351, RT:36777, RT:37615, RT:35242,
    RT:36392, RT:37058, PS-29949, PS-31378, PS-31430, PS-31857, PS-32692,
    PS-30313, PS-31472, PS-32140)

  - confd: ConfD now has the option to run in FIPS mode. See the ConfD user
    guide for information on how to do this.

    (ENG-19300, RT:37401, RT:37417, RT:37619, PS-32480, PS-32496, PS-32696)

  - confd: Augment transaction information to
    'netconf-state/sessions/session'. Operator can use any northbound
    interface to get a list of all user sessions.

    (ENG-18981, RT:31371, PS-27426)

  - cdb: It is now possible to use the cdb debug dump tool to get the
    contents of the .cdb files in XML format by using "confd
    --cdb-debug-dump DIR xml"

    (ENG-21008)

  - cdb: confd --cdb-debug-dump now prints augmented namespaces symbolically
    rather than numerically.

    (ENG-20838)

  - cli: The 'show configuration' command in the C-style CLI, and
    cdb_get_modifications_cli(), would be slow when the data model had a
    large number of when expressions on top-level nodes. This has been
    fixed.

    (ENG-20614, RT:36580, PS-31660)

  - cli: The performance of diff calculation has been improved to cover all
    the identified corner cases such as deleting almost all elements from a
    huge list or adding a big amount of elements into a list.

    (ENG-19688, RT:36676, PS-31756)

  - cli: A new Cisco style CLI parser has been created.
    This is a top-down, depth-first parser that is intended to be a faster
    alternative to the current ConfD CLI while still giving exactly the same
    result in CDB.
    It can be accessed using the format flag 't' for turbo. Example:
    'confd_load -l -F t config.cli'. It can also be used through MAAPI using
    the MAAPI_CONFIG_TURBO_C flag.

    (ENG-18697, RT:33167, PS-28681)

  - cli: A new confd.conf setting has been introduced to control leaf value
    alignment when displaying the configuration in C- and I- style. It is
    called /confdConfig/cli/cConfigAlignLeafValues{true/false}.

    (ENG-18252)

  - documentation: confd_notification_send() documentation updated to
    include a note about it being asynchronous and require the tags to be in
    the same order as in the YANG model.

    (ENG-20738, RT:36508, PS-31588)

  - documentation: Security issues is now presented in the beginning of
    ConfD User Guide instead of as a sub-chapter in Advanced Topics in order
    to make it more visible. Moreover, the Security issues chapter now
    describes SSH key management procedure shortly and refers to the Public
    Key Login chapter for more information.

    (ENG-16077, RT:23388, RT:20115, RT:20194, PS-7453, PS-10527, PS-10530)

  - examples: New security example added describing a) how to use privileged
    ports with ConfD running as non privileged user, b) how to use new
    option --preflight-checks

    (ENG-21542)

  - examples: Example showing confd_cmd and confd_load usage has been added.

    (ENG-21534)

  - examples: YANG models of existing examples (with few standardized
    exceptions) have been updated to conform with RFC 8407 chapter 4.3.1 -
    identifier naming conventions.

    (ENG-20387)

  - java-api: log4j upgraded to version 1.2.17

    (ENG-19934, RT:35379, PS-30453)

  - java-api: MaapiCursor can now be created with an optional XPath filter
    allowing it to traverse a subset of a list.

    (ENG-19809)

  - java-api: A java data provider can now opt in to get a list filter
    passed down to it in order to perform filtering of lists directly in the
    data provider, for better performance. See "Using List Filters" in
    "Operational Data" in the User's Guide, and the javadoc.

    (ENG-19780)

  - java-api: Deprecated container/leaf/leaflist/list methods taking a
    prefix and added new methods taking namespace instead. Also added
    methods to specify a namespace in NavuContainer to be used when
    selecting a child to it and to find the ConfNamespace from a namespace
    id.

    (ENG-5462)

  - netconf: Introduced a new configuration attribute
    /confdConfig/logs/netconfLog/logReplyStatus making it possible to extend
    NETCONF logs with rpc-reply status information. See ConfD User Guide for
    detailed information.

    (ENG-18982, RT:33593, PS-28956)

  - restconf: Support for the non-standard "unhide" query parameter is now
    advertised as a RESTCONF capability.
    The non-standard query parameter "format" which did not work
    as intended is now removed. RESTCONF users should use the
    Accept header.

    (ENG-20717)

  - xpath: Optimize validation by caching the value for the current node, in
    the xpath evaluation phase.

    (ENG-21048)

Non-backwards compatible corrections:

  - c-api: cdb_num_instances() and maapi_num_instances() now only support
    list or leaf-list nodes. If using cdb_num_instances() or
    maapi_num_instances() on non-list/leaf-list nodes, ConfD returns error
    CONFD_ERR_UNAVAILABLE and error message "num_instances() not allowed on
    given node type".

    (ENG-19818, RT:34971, PS-30039)

  - rest-api: HTTP PATCH is not allowed to create a non-existing instance.

    (ENG-21000)

  - toolchain: A "must" statement is not allowed under "choice" in a YANG
    module. This used to be silently ignored, now an error is given.

    (ENG-21067)

Corrections:

  - confd: When wildcards were given in some CLI show commands, ConfD would
    leak some memory.  This bug has been fixed.

    (ENG-21637, RT:37779, PS-32853, CSCvq20683)

  - confd: Package reloads and removals may leave kickers in a state where
    the kick-node of kicker refers to a node that is no longer present in
    the schema. This can cause various user actions to fail if the
    underlying transaction touches a subtree that is monitored by the
    invalid kicker. In this case a log entry is written to the devel.log and
    to ncserr.log about the invalid kicker. The log entry gives some advice
    about how the problem can be handled by the user.

    (ENG-21460, RT:37548, PS-32625)

  - confd: Compiler returns a more descriptive error message on an illegal
    refine statement.

    (ENG-21287, RT:37466, RT:37213, PS-32545, PS-32293, SR:686573229)

  - confd: Compiler returns a more descriptive error message on a bad
    tailf:non-strict-leafref path.

    (ENG-21286, RT:37213, PS-32293, SR:686573229)

  - confd: With optimization of the filtering in the DB it was possible to
    get duplicate list data if unmodified data was left in the current
    transaction. This has been fixed.

    (ENG-21234)

  - confd: Unexpected errors while adding a slave to a master no longer
    causes the system to be left in locked state.

    (ENG-21144, RT:36452, PS-31532)

  - confd: An edit-config RPC with a payload falsifying an augmented
    when-statement now correctly raise an error.

    (ENG-21060, RT:36931, PS-32013)

  - confd: The dependencies of 'when' expressions were not propagated
    correctly through the tree of config data.

    (ENG-20879, RT:35690, PS-30766)

  - confd: If an action or RPC is invoked within a transaction, the input
    parameters are now validated in the context of that transaction. This
    means that for example leafrefs to items created in that transaction are
    accepted as valid (which was previously not the case).

    (ENG-20813)

  - confd: When copy config from XML file, ConfD triggered delete set-hook
    for one list instance 3 times. This has been fixed now. Confd shall
    trigger delete set-hook only once for each list instance.

    (ENG-20681, RT:36446, PS-31526)

  - confd: Augmenting an 'action' to a symlink path causing 'Internal Error'
    when calling action. This has been fixed now.

    (ENG-20668, RT:36404, PS-31484)

  - confd: When a default value is already in use and two write operations
    are requested by a northbound agent that changes the default value and
    then resets the value back to the default value respectively in one
    commit, one of the set-hooks was not invoked. This is fixed by adding
    the missing set-hooks.

    (ENG-20430, RT:35891, PS-30969)

  - confd: Rollback from CLI is no longer affected by other transactions
    creating rollback files while the command is issued.

    (ENG-20404, RT:35743, PS-30819)

  - aaa: NACM rules will not be reloaded from CDB when changes are limited
    to attributes.

    (ENG-21522, RT:37285, PS-32366, CSCvq00606)

  - c-api: CONFD_TRANS_CB_FLAG_FILTERED is no longer ignored for NETCONF
    subfilters.

    (ENG-21430, RT:37459, PS-32538, CSCvp82016)

  - c-api: Added support on string conversion functions to honour
    smiv2:display-hint clause when yang data type is string.

    (ENG-20969, RT:36746, PS-31826)

  - c-api: Fixed an overflow issue for uint64 type on ConfD API's
    confd_str2val function.

    (ENG-20927, RT:36756, PS-31836)

  - c-api: CDB subscription (on container) notification did not send when
    modified on parent list. This has been fixed now.

    (ENG-20336, RT:34250, PS-29368)

  - cdb: Some requests to read data from CDB oper with a filter would lead
    to a crash.  This bug has been fixed.

    (ENG-21291, RT:37354, RT:37248, PS-32433, PS-32329, CSCvp55236)

  - cdb: Write sessions against CDB operational will no longer hang if a
    write occurs during HA synchronization.

    (ENG-21218, RT:36803, PS-31884, CSCvp45643)

  - cdb: Loading upgrade XML files on a model with 'when' expressions will
    no longer fail.

    (ENG-21215, RT:37075, PS-32157, CSCvp45473, SR:686540985)

  - cdb: The CDB operational data was not updated correctly when upgrading.
    This has been fixed now.

    (ENG-21077)

  - cdb: Reading a node under a re-created case from CDB_PRE_COMMIT_RUNNING
    now returns the correct value.

    (ENG-20821, RT:36629, PS-31709)

  - cdb: If base identity moved and/or identity name changed, ConfD failed
    at handling identity in phase0 of CDB upgrading. This has been fixed
    now.

    (ENG-20591, RT:36199, PS-31278)

  - cdb: ConfD now handles schema upgrades from non-presence to presence
    container correctly.

    (ENG-20550, RT:35984, PS-31063)

  - cdb: cdb_set_values() returned CONFD_OK when set value to operational
    data under a nonexistent config list instance. This has now been changed
    to CONFD_ERR_BADPATH with error message "/path/to/list{key} does not
    exist".

    (ENG-20121, RT:35585, PS-30659)

  - cdb: When a CDB subscriber ran 'cdb_set_timeout' in a session started
    with 'cdb_start_session2', the timeout would not always be removed when
    the session ended. When the timeout hit, the socket would be closed.
    Now, when the session is ended, the timeout is removed.

    (ENG-20031, RT:34495, PS-29558)

  - cdb: cdb_is_default(), cdb_get_list() and cdb_exists() did not work
    correctly on leaf-lists when the leaf-list was uninstantiated and had a
    default value.

    (ENG-19262, RT:35888, RT:34359, PS-30966, PS-29414)

  - cdb: Reading default values and checking non-presence container
    existence now check when expressions.

    (ENG-19160, RT:34155, PS-29286)

  - cli: The C-style configuration diff (e.g. show configuration) as a
    result of inserting a new list-instance in a non-empty ordered-by user
    list annotated with tailf:cli-show-long-obu-diffs, and thus changing the
    order of the list, was in some cases incorrect. This has been fixed.

    (ENG-21496, RT:37589, PS-32666, CSCvp93725, SR:686813497)

  - cli: List keys would appear in C-Style CLI configs even when they were
    annotated with 'tailf:cli-ignore-modified'. This has been fixed so that
    these list keys are not shown.

    (ENG-21374, RT:37370, PS-32448, CSCvp73069)

  - cli: A more appropriate error message is shown in the CLI when the user
    is trying to remove a mandatory leaf.

    (ENG-21168, RT:37019, PS-32100)

  - cli: An action or RPC with input parameter of leaf-list type would cause
    'show parser dump' to enter an infinite loop expanding the command with
    repeated leaf-list entry. This has now been fixed.

    (ENG-21162, RT:37052, PS-32133)

  - cli: When displaying configuration changes in curly bracket format
    changes to comments and attributes would not be displayed. This has been
    fixed such that they can be displayed if the "display annotations" and
    the "display tags" pipe targets are present.

    (ENG-21155)

  - cli: Using the tailf:cli-value-display-templates for config=true data
    caused problem when creating rollback files. However, using
    tailf:cli-value-display-templates is discouraged for config=true data.

    (ENG-21153, RT:37040, PS-32121)

  - cli: If the screen length was set to 0, to indicate that no pagination
    should take place, it would be reset to the actual screen length when
    the terminal was resized. This has been fixed such that it remains 0 if
    explicitly set to 0.

    (ENG-21058, RT:36888, PS-31970)

  - cli: The CLI failed with an internal error when displaying a table
    longer than the tableLookAhead setting, and in combination with a
    de-select pipe target.

    (ENG-20925, RT:36790, PS-31871)

  - cli: The wrong completion alternatives were shown after entering the
    values for a leaf-list with the tailf:cli-full-command annotation. This
    has been fixed.

    (ENG-20913, RT:36732, PS-31812)

  - cli: When issuing show commands with selection filters in the CLI list
    instances without any data would still be displayed, when displayed as a
    table.

    (ENG-20912, RT:35690, PS-30766)

  - cli: Fixed a number of potential race conditions in rollback file
    selection.

    (ENG-20909)

  - cli: The CLI would time out with an IDLE TIMEOUT message even when the
    user was typing. The idle timeout would only be reset on TAB/SPACE
    completion or when a command was executed. This has been fixed such that
    the idle timeout is reset whenever the user types.

    (ENG-20837, RT:36662, PS-31742)

  - cli: The CLI could crash when combining NACM rules that block read
    access to specific nodes and also having dependency towards these nodes
    on data that is accessible to the user.

    (ENG-20824, RT:36784, RT:36661, PS-31865, PS-31741)

  - cli: Calculating the output for 'show configuration' in the C-style CLI
    would result in excessive xpath evaluations. This has been fixed such
    that the result of xpath evaluations are cached, reducing the execution
    time.

    (ENG-20817, RT:37388, RT:36492, PS-32467, PS-31572, CSCvp01536)

  - cli: An action or RPC with input parameter of leaf-list type would cause
    'show parser dump' to enter an infinite loop expanding the command with
    repeated leaf-list entry. This has now been fixed.

    (ENG-20672, RT:35364, PS-30438)

  - cli: Custom CLI commands with parameters of type XPath cause the CLI to
    crash during TAB completion with /confdConfig/cli/instanceDescription
    set to false.

    (ENG-20655, RT:36112, PS-31191)

  - cli: If mixing oper data with config data the CLI could incorrectly
    present oper data during TAB-completion in config mode.

    (ENG-20648, RT:36414, PS-31494)

  - cli: Handling of asterisk in list keys has been corrected.

    (ENG-20605, RT:36376, PS-31455)

  - cli: The optimization made in ENG-19149 (speed up the diff calculation
    for the case where almost all elements in a huge list are deleted)
    caused a slow down of calculating diff for adding huge amount of
    elements into a list.

    (ENG-20571, RT:36956, RT:35389, PS-32038, PS-30463)

  - cli: The XML displayed when running the 'show configuration | display
    xml' was not correct when the edits involved an insert into an
    ordered-by user list.

    (ENG-20524, RT:36140, PS-31218)

  - cli: Handling of nodes with tailf:cli-show-no, that the user cannot
    access, has been corrected.

    (ENG-19855, RT:35152, PS-30223)

  - cli: Completion for list keys with non-integer type has been updated to
    produce correct commands.
    Description of the tailf:cli-suppress-range has been corrected.

    (ENG-19776, RT:35142, PS-30213)

  - cli: The pipe target de-select did not work as expected when a
    non-presence container was selected.

    (ENG-19643, RT:34931, PS-29999)

  - cli: Improved security by encoding the parameters passed to OS commands.

    (ENG-18954, RT:33459, RT:35120, PS-28876, PS-30191)

  - cli: The idle timeout would not be honored waiting for the user to
    respond to a MORE prompt. From now on, if the user doesn't respond to a
    MORE prompt in the given timeout the MORE session will be terminated and
    the user returned to the CLI main prompt.

    (ENG-18015, RT:24628, PS-7800)

  - documentation: Descriptions of '/confdConfig/cli/trimDefaultShow' and
    '/confdConfig/cli/trimDefaultSave' parameters have been brought in sync
    with User Guide.

    (ENG-20280, RT:35756, PS-30832)

  - erlang-api: API documentation for transaction, data and validation
    callbacks is corrected.

    (ENG-21161, RT:37057, PS-32138)

  - examples: The custom completion for the history command parameter was
    not displayed correctly in the cli/completion example.

    (ENG-379)

  - java-api: The conf-api-7.1.jar depends on com.tailf.ncs.ns which is not
    included in the jar. This caused an issue that was produced
    automatically by a tool that scans the required packages.
    The dependency has now been removed.

    (ENG-21360, RT:37359, PS-32438, CSCvp66637)

  - java-api: NavuContainer.equals() always returned true for module level
    containers, this has been fixed.

    (ENG-21219)

  - java-api: The convenience method CdbSession.index(String, Object...) did
    not work. This has been fixed.

    (ENG-21090)

  - java-api: SnmpVarbind was not able to handle all ints in the unsigned
    32bit range as OID. This has now been fixed.

    (ENG-20601, RT:36374, PS-31453)

  - java-api: If a service package has a jar that apparently does its own
    classloading, there is a 'ClassNotFound' exception when that service is
    instantiated for the first time. This has now been fixed.

    (ENG-20485, RT:36092, PS-31171)

  - java-api: "MaapiException - not able to parse" seen if sharedCreate was
    called on a list inside of a multi-key list, since the keys were added
    twice. This has now been fixed.

    (ENG-19283, RT:34334, PS-29436)

  - java-api: A bug which caused a disconnect when using synchronous HA
    notifications has been addressed.

    (ENG-19252)

  - java-api: HaException sometimes gave a misleading message and included
    the error code inside the message string. The message has been fixed and
    the error code is now available through the getErrorCode() method.

    (ENG-14103, RT:30204, PS-9936)

  - json-rpc: Intense testing of the JSON-RPC API could provoke the system
    to crash due to not being able to allocate more memory.

    (ENG-21156)

  - json-rpc: An invalid JSON-RPC payload could cause an internal error.
    This has been fixed.

    (ENG-20921)

  - netconf: Enabling authorization callback no longer causes action
    invocation using NETCONF to fail.

    (ENG-21082, RT:36514, PS-31594)

  - netconf: Reading a leaf with tailf:link inside a case will no longer
    return a value if the case the leaf resides in is inactive.

    (ENG-20823, RT:36657, PS-31737)

  - netconf: Previously netconf "replace" operation was failing with
    "data-missing" on a "mandatory" node with "when" statement.
    This has been fixed by ENG-20879.

    (ENG-20650, RT:36401, PS-31481)

  - netconf: Session does not hang forever when terminated in the middle of
    copy-config routine.

    (ENG-20040, RT:34400, PS-29469)

  - netconf: The NETCONF server now correctly honors all NACM rules defined.

    (ENG-16113, RT:26856, RT:32772, RT:34670, RT:35534, PS-25992, PS-28381,
    PS-29736, PS-30609)

  - python-api: Fixed multiple issues with keypath parsing. Most notably,
    empty strings could not be used as keys and space characters were
    sometimes incorrectly interpreted as keys.

    (ENG-21097, RT:36986, PS-32069, CSCvp25395)

  - python-api: The maapi functions get_object(), get_values(), set_object()
    and set_values() no longer crashes when given huge amounts of input
    data.

    (ENG-20790, RT:36579, PS-31659, CSCvp11811, SR:686184098)

  - python-api: It is now possible to read structured values with
    _confd.maapi.get_values().

    (ENG-20680, RT:36439, PS-31519)

  - restconf: If an action was augmented under a top node, it was not
    possible to invoke it. Additionally, when this happened, a stack trace
    was sent instead of an error message because of an unhandled JSON parser
    error. No more stack traces are sent for JSON parser errors, but proper
    error messages, and it is possible to invoke augmented actions under top
    nodes.

    (ENG-20631, RT:36397, PS-31477, SR:686109227)

  - restconf: Empty line between events added according to SSE W3C
    Recommendations. The 'eventTime' field value is quoted properly.

    (ENG-20523)

  - restconf: Now a YANG Patch can handle payload values where key is
    missing. See also correction in ENG-20699.

    (ENG-19899, RT:35280, PS-30352)

  - restconf: Server now responds with correct `400 Bad Request` error when
    receiving invalid JSON.

    (ENG-5700)

  - toolchain: If a leafref target had a deviation "not-supported", the
    confdc compiler would fail with "internal error".  This bug has been
    fixed.

    (ENG-21497, RT:37598, PS-32675, CSCvp93772)

  - toolchain: If an "identity" was marked with "if-feature", and the
    feature was not implemented, the identity would still be present in the
    schema.  This bug has been fixed.

    (ENG-21196, RT:37098, PS-32180)

  - toolchain: If a deviation changed the type of an augmented leaf to use a
    typedef defined in the deviation module, the YANG compiler would fail
    with "internal error". This has been fixed.

    (ENG-20970, RT:37582, RT:36796, PS-32659, PS-31877)

  - toolchain: If a leafref's path had a reference to itself, confdc would
    go into an infinite loop.  This bug has been fixed.

    (ENG-20219, RT:35716, PS-30792)

  - toolchain: 'confdc --mib2yang-std' in some cases generated YANG modules
    with missing imports. This has been fixed.

    (ENG-16806, RT:27343, PS-8678)

  - web-server: An invalid port number in the HTTP Host header, sent by a
    client, could cause an internal error. This has been fixed.

    (ENG-20941)

  - xpath: XPath expressions used to optimize list traversal that span both
    CDB configuration and operational data now returns results as expected.

    (ENG-21483, RT:37593, RT:37404, PS-32670, PS-32483)

  - xpath: when and must expressions from YANG files referencing list keys
    with identities now evaluate properly when the prefix from the module
    imports is different from the module prefix.

    (ENG-21211)


ConfD-7.1 [April 11, 2019]
==========================
Deprecated:

  - json-rpc: Json-rpc API deprecates the combination of having configured
    the
    running datastore access to "read-write" while having the candidate
    datastore enabled. From version Confd-7.3 this combination will not be
    allowed for access via the json-rpc api. If candidate is used, the valid
    combination is:
    /confdConfig/datastores/candidate/enabled=true
    /confdConfig/datastores/running/access=writable-through-candidate

    (ENG-20544)

  - python-api: Support for Python 2 (2.7.x) is deprecated and will be
    removed in ConfD-7.3.
    The Python Software Foundation will not support Python 2 past January
    2020 and even today 2.7 receives little to no attention.
    Software written specifically for Python 2 should be migrated to support
    Python 3.

    (ENG-20207)

  - rest-api: The REST API is deprecated and will be removed in ConfD-7.3.
    Users of the REST API should use the RESTCONF API instead,
    see ConfD User Guide Chapter 24. Migrating from REST to the
    RESTCONF API.

    (ENG-20521)

  - restconf: RESTCONF query parameters "limit" and "offset" are deprecated
    and will be removed in ConfD-7.3.
    The query parameters "limit" and "offset" which also exist in the
    REST API could also be used in RESTCONF. However these aren't
    standardized and didn't work as intended. Users of these query
    parameters should use the extension REST Query API instead.

    (ENG-20872)

Removals:

  - java-api: The NavuCdbXXXSubscribers and all its helper classes have been
    removed.
    Plain CDB subscribers should be used instead.

    (ENG-17530)

  - web-server: Support for the SSL v3 protocol has been removed. TLS v1 is
    no longer supported by default, but can be enabled via
    /confdConfig/webui/transport/ssl/protocols.

    (ENG-19067)

Non-backwards compatible enhancements:

  - confd: When auditLogCommit is enabled, it no longer by default adds
    entries on the form:
        commit thandle <N> <path> default set (<value>)
    The reason for this is that adding this can have a performance impact,
    depending on the data model.
    A new confd.conf parameter, auditLogCommitDefaults has been added, which
    can be set to 'true' to get the old behavior.

    (ENG-20766)

  - confd: When ConfD fails to allocate more memory, exit() is called
    instead of abort(), and no core is generated. This behaviour has now
    been changed. The new default is to call abort(). Which potentially can
    generate a core file if the OS is configured that way. For example with
    "ulimit -c unlimited". When the environment variable CONFD_DUMP is set a
    crash dump file is generated instead. So by setting or unsetting the
    variable different behaviour can be achieved.

    (ENG-20256, RT:35291, RT:35715, RT:35493, PS-30364, PS-30791, PS-30567)

  - confd: Rollback files are now transferred from master to slave HA nodes
    in compressed chunks for efficiency and to prevent timeouts on high
    latency networks. Please note that this change is not backward
    compatible within an HA setup since it is necessary that all nodes in
    the HA cluster include this change to avoid failures when syncing.

    (ENG-19783, RT:34742, PS-29808, SR:685250845)

  - aaa: The AAA check for replay of NETCONF notifications has been
    optimized. This enhancement is non-backwards compatible in a HA setup,
    where slave nodes need to have this fix to be compatible with a master
    node running with this fix.

    (ENG-20179)

  - aaa: Added /confdConfig/aaa/maxPasswordLength, to make it possible to
    reject authentication attempts using very long passwords without
    attempting verification. The default value is 1024.

    (ENG-18876)

  - netconf: The confd.conf settings 'startup', 'candidate' and
    'writable-running' have been obsoleted. If they are present in
    confd.conf they will be ignored. The corresponding capabilities are
    advertised based on the setting under /confdConfig/datastores.
    The confd.conf settings 'transactions', 'forward', 'query', 'inactive'
    have been deprecated. They were all identified with special NETCONF
    capability strings. They are now defined in YANG files and advertised as
    such if the corresponding YANG fxs file is found in the load path
    ('inactive' also needs /confdConfig/enableInactive to be enabled). If
    they are enabled in confd.conf, the old special capability string is
    also advertised.
    The confd.conf setting 'partial-lock' has been deprecated.  The
    corresponding capability string is advertised if its YANG fxs file is
    found in the load path.
    The confd.conf settings 'extensions' and 'with-transaction-id' have been
    obsoleted.  They are advertised if the corresponding YANG fxs file is
    found in the load path.  If they are found in confd.conf they are
    ignored.
    All the YANG fxs files that correspond to these capabilities are present
    by default in ${CONFD_DIR}/etc/confd in the release.   When ConfD is
    deployed, files corresponding to capabilities that shouldn't be
    supported can be removed.

    (ENG-19985)

  - toolchain: tailf:validate for a node with tailf:link was ignored, and
    'must' for such a node was rejected by the compiler. Now both
    tailf:validate and 'must' are allowed, and work as expected.

    (ENG-19689, RT:34962, PS-30030)

  - toolchain: When tailf:validate was used as substatement to 'must',
    causing invocation of the validation callback instead of evaluation of
    the 'must' expression, no dependency analysis was done for the 'must'
    expression, and dependencies for tailf:validate had to be given
    explicitly via tailf:dependency as usual.
    Now dependencies are calculated for the 'must' expression, and used for
    invocation of the validation callback, unless explicit dependencies (or
    tailf:no-dependency) have been given for tailf:validate. The dependency
    calculation will also have the effect that the compiler will report
    problems with the 'must' expression (e.g. references to undefined nodes)
    that were previously ignored in this case.

    (ENG-19505, RT:34055, PS-29233)

  - toolchain: The algorithm that generates integer values for YANG
    identifiers has been modified to generate a different value for
    "java-uninitialized", to avoid the conflict with "nas-enable".

    (ENG-19431)

  - toolchain: If a "must" or "when" statement on a config true node
    contains an XPath expression that refers to config false data, confdc
    will now print a warning, since such expressions cannot be expected to
    work.  See section 7.19.5 of RFC 7950.
    If you want to treat this new warning as a warning even when
    --fail-on-warnings is used,  pass -W YANG_ERR_XPATH_REF_BAD_CONFIG to
    confdc.

    (ENG-17111)

Enhancements:

  - confd: Limit the performance impact introduced when fixed missing when
    evaluation on non presence containers and leafs with default values
    (ENG-20493). For this optimization to take effect all FXS files needs to
    be re-compiled.

    (ENG-20685)

  - confd: Validation of leafrefs and other must expressions have been
    optimized.  When a leafref or a node with a certain class of must
    expressions has been created, the validation time is now O(1) instead of
    O(N), where N is the size of the leafref/must dependency node set.
    The validation performance when a leafref target node has been deleted
    has also been optimized.

    (ENG-20575)

  - confd: Transaction identifiers are now persisted between restarts and
    monotonically increasing, in contrast to previous version when
    transaction identifiers were reset on system restart.

    (ENG-20548)

  - confd:  TransactionId and Hostname are added in the rollback file to
    give possibility to correlate rollback files with development and
    service logs.

    (ENG-19853, RT:32153, PS-27960, SR:684020551)

  - confd: It is now possible to load encryptedStrings keys using an
    external command instead of storing them in confd.conf to allow for use
    with external key management systems. See the ConfD user guide 31.9.1
    for details.

    (ENG-19346, RT:19899, RT:29036, RT:35872, RT:36286, PS-6131, PS-9364,
    PS-30950, PS-31365)

  - confd: Augment transaction information to
    'netconf-state/sessions/session'. Operator can use any northbound
    interface to get a list of all user sessions.

    (ENG-18981, RT:31371, PS-27426)

  - confd: All Tail-f YANG modules now have a license text.

    (ENG-18925)

  - confd: Added configurable XML parser limits under
    /confdConfig/parserLimits effective for NETCONF, RESTCONF etc.

    (ENG-18894, RT:33514, PS-28902)

  - confd: The confd_cfg.yang module has been changed to use a grouping for
    common log configuration parameters.

    (ENG-18842)

  - confd: Added the possibility to configure DSCP for IPC connections via
    /confdConfig/confdIpcDscp.

    (ENG-18840, RT:33443, PS-28865)

  - confd: confd --status namespace and module list entries are sorted on
    url and module name respectively.

    (ENG-18609)

  - confd: The internal runtime representation of data models (loaded fxs
    files) has been modified to consume much less memory. The actual
    improvements depends on data model. Measurements on different models has
    indicated that the new representation consumes in the range of 10% to
    20% of the previous implementation, leading to significant memory
    reduction for systems with large data models.

    (ENG-18567)

  - confd: Added API functions for sending of YANG 1.1 "inline"
    notifications: confd_notification_send_path() for C API, new
    DpNotifStream.send() methods for Java API,
    _confd.dp.notification_send_path() for Python API, and
    econfd:notification_send/4 for Erlang API.

    (ENG-18258, RT:33080, RT:32451, PS-28607, PS-28173)

  - confd: The query API now allows any XPath expression as a sort parameter
    (instead of just paths to leafs). For example "sum(alarms/*)" or
    "alarms/errors + alarms/warnings".

    (ENG-18045)

  - confd: Fixed potential issues related to address space layout
    randomization (ASLR).

    (ENG-17676)

  - confd: Improve validate command to validate the combination of change
    sets made in the config shared and private mode sessions.

    (ENG-17449, RT:30104, PS-9883)

  - confd: Logging of user sessions have been made more explicit so that
    apart from logging authentication/login, creation and termination
    (together with reason) is also logged to the audit log. New logsyms have
    been added for session logging.

    (ENG-16643)

  - aaa: Added tailf:suppress-echo for
    /aaa/authentication/users/user/password, to prevent the password hash
    from being logged when /confdConfig/logs/auditLogCommit was enabled.

    (ENG-18777, RT:35898, RT:33211, PS-30976, PS-28702)

  - c-api: The struct confd_trans_ctx now contains a "traversal-id", which
    can be used by a data provider to keep track of concurrent list
    traversals for a single list in a single transaction.

    (ENG-19560)

  - c-api: It is now possible to give a filter (XPath expression) to a maapi
    cursor when traversing a list,  in order to retrieve only list entries
    that match the filter.

    (ENG-19532)

  - c-api: Henceforth, ConfD daemon accepts and works with IPC connections
    from API libraries that are one major release older. As a special case
    for version 7.1, ConfD daemon was made compatible with libconfd 6.4.
    Thus ConfD-7.1 accepts connections from clients that use libconfd 6.4.x
    API.

    (ENG-19110)

  - c-api: A data provider can now opt in to get a list filter passed down
    to it in order to perform filtering of lists directly in the data
    provider, for better performance. See "Using List Filters" in
    "Operational Data" in the User's Guide.

    (ENG-18652)

  - cdb: confd --cdb-debug-dump now prints augmented namespaces symbolically
    rather than numerically.

    (ENG-20838)

  - cdb: A two-phase subscriber is now able to abort a transaction with the
    error code in_use.

    (ENG-19928, RT:34134, PS-29270)

  - cdb: Upgrade failure due to out of disk space is now handled
    non-destructively and there is no need to restore the database after a
    failed upgrade.

    (ENG-15111, RT:28577, RT:34924, PS-9154, PS-29992)

  - cli: A new CLI YANG extension has been added,
    'tailf:cli-suppress-leafref-in-diff'. Normally, a node of the type
    leafref or alternatively a node annotated with tailf:non-strict-leafref
    will have these dependencies considered when the CLI is generating
    C-style configuration diffs, and place the referring node before or
    after its target, depending on the operation. This extension will
    suppress this behaviour so that these dependencies will not be
    considered.

    (ENG-20118)

  - cli: The CLI now uses xpath expression when accessing data providers.
    These can be sent down to the data provider for more flexibility and
    possible performance optimisation at that level. The expressions are
    auto generated from the input in the CLI and handles the filters, range
    expressions and similar functionality from the CLI.

    (ENG-19859)

  - cli: When pressing CTRL-C during an auto commit, (using a data provider)
    in both I-Style and C-Style CLI, the commit will be aborted. The data
    provider will be notified of this. The flow of this follows the picture
    "ConfD transaction state machine" in "Chapter 7.5, User sessions and
    ConfD Transactions" in the ConfD user guide. That is, abort will happen
    after the prepare phase of the commit.

    (ENG-19841, RT:35202, PS-30273)

  - cli: A new confd.conf setting has been added for controlling how inline
    comments should be treated. It is called
    /confdConfig/cli/noEmbeddedComments{true/false}. If set to 'true' then !
    and # and will be treated as ordinary characters unless they appear
    first on a line, in which case the rest of the line will be considered a
    comment.

    (ENG-19387, RT:34607, PS-29671)

  - cli: The tailf:cli-run-template-enter annotation was not available for
    list nodes when the tailf:cli-suppress-mode was also used. This has been
    changed.

    (ENG-19266, RT:34365, PS-29421)

  - cli: An optimization has been made to speed up the corner case when
    deleting almost all elements in a huge list. The diff calculation for
    that case scales better now.

    (ENG-19149, RT:33347, PS-28828, SR:684526647)

  - cli: Added an option called '/confdConfig/cli/maxLineLength'. If set,
    this option will cause the CLI to abort reading lines at a certain
    (configurable) threshold. The idea is to provide a security mechanism to
    guarantee that the CLI will not keep reading extremely large amounts
    data and run out of memory.

    (ENG-19088, RT:33911, PS-29152)

  - cli: A new confd.conf option, 'confdConfig/cli/waitLockedConfigMode',
    has been added. This setting controls the behaviour when trying to enter
    configure mode while another entity is locking the database, e.g. some
    other commit is in progress or some managed object is locking the
    database. If set to 'true' (default) then the CLI will wait with
    entering configure mode, rendering the CLI unusable until the database
    is unlocked. If set to 'false' the CLI will not wait but instead display
    an error message.

    (ENG-18987, RT:33597, PS-28966)

  - cli: Two new pipe targets have been added when showing operational data.
    They are called 'display local-time' and 'display universal-time'. When
    used any time-date values will be converted into local time (local-time)
    or UTC (universal-time).

    (ENG-18969)

  - cli: When deactivating a leaf-list entry, CLI did not display inactive
    leaf-list entry for show command although deactivating takes effect in
    the CDB. This has now been improved by enabling CLI to display inactive
    leaf-list entry.

    (ENG-18921, RT:32440, PS-28168)

  - cli: The CLI will not directly abort to error messages in case there is
    a subsystem failure or connection timeout. Instead it will try to
    present as much info as possible and push out the error message
    afterwards.

    (ENG-18861, RT:33411, PS-28888)

  - cli: The command 'load merge' worked the same as 'load replace' for
    leaf-list. Now the behaviour of 'load merge' has been extended so that
    the new leaf-list values loaded from a configuration file could be
    merged with the existing leaf-list values depending on the confd.conf
    setting. A new configuration parameter named 'enableLoadMergeLeafList'
    has been added to confd.conf to toggle between the new and old
    behaviours.
    Note that the confd.conf setting
    '/confdConfig/cli/jEnableLoadMergeLeafList' has now been deprecated as
    new the setting works for both J- and C-style CLI.

    (ENG-18749, RT:33273, PS-28747)

  - cli: The 'insert' and 'move' config mode commands now supports
    'ordered-by user' leaf-lists.

    (ENG-18747, RT:33175, PS-28670)

  - cli: The registered DP callbacks for a callpoint are displayed in both
    the confd-state model and confd --status as leaf-list.

    (ENG-18408, RT:32630, PS-28273)

  - cli: Handling of Unicode in the CLI has been improved.

    (ENG-18308, RT:32476, PS-28185)

  - cli: Possibility to turn off the builtin caching mechanism of the CLI
    using a confd.conf setting, /confdConfig/cli/enableCliCache. Default
    behaviour is to have this turned on. Only turn this off for very special
    cases.

    (ENG-18178, RT:32212, PS-28015)

  - cli: A new CLI command option has been added in the J-style CLI for
    loading configuration relative to the edit position. It is invoked in
    configure mode as load <merge|overwrite> <file> [relative]

    (ENG-18081, RT:32270, PS-28045)

  - cli: Combining when-expressions and leaf-lists now recalculates data
    node presentation during TAB/SPACE-completion in the CLI.

    (ENG-16549, RT:23734, PS-7566)

  - cli: Added CLI YANG extension ''tailf:cli-suppress-error-message-value'
    which allows you to suppress the value part of an error message in the
    CLI.

    (ENG-16222, RT:28052, PS-8939)

  - cli: Parameters to commands in clispec-files can now be specified using
    environment variables by using the syntax $(env:varname). For example,
    $(env:HOME) is expanded to the value of the environment variable called
    HOME.

    (ENG-15950)

  - documentation: REST API is deprecated so until it is finally removed
    there will be this REST to RESTCONF migration guide in the
    documentation.

    (ENG-20489, RT:36186, PS-31264)

  - documentation: Improve documentation of syslog messages, with better
    formatting and including the level.

    (ENG-19811)

  - documentation: Fixed various spelling errors.

    (ENG-19695, RT:35023, PS-30094)

  - documentation: Improved documentation on the
    '/clispec/$MODE/cmd/params/param/auditLogHide' Clispec element.

    (ENG-19198, RT:34257, PS-29366)

  - documentation: Security issues is now presented in the beginning of
    ConfD User Guide instead of as a sub-chapter in Advanced Topics in order
    to make it more visible. Moreover, the Security issues chapter now
    describes SSH key management procedure shortly and refers to the Public
    Key Login chapter for more information.

    (ENG-16077, RT:23388, RT:20115, RT:20194, PS-7453, PS-10527, PS-10530)

  - erlang-api: econfd:init_cursor/4 is added which takes a filter (XPath
    expression) used to limit returned entries when traversing a list.

    (ENG-19810)

  - erlang-api: Support for the list filter functionality has been added to
    the erlang API. See "Using List Filters" in "Operational Data" in the
    User's Guide.

    (ENG-19779)

  - erlang-api: The record confd_trans_ctx now contains a "traversal-id",
    which can be used by a data provider to keep track of concurrent list
    traversals for a single list in a single transaction.

    (ENG-19690)

  - erlang-api: The missing function econfd_maapi:get_authorization_info/2
    was added.

    (ENG-19279)

  - examples: Example related to Xpath expressions has been added.

    (ENG-20159)

  - examples: Added small examples that demonstrates how to implement
    external authentication and authorization. The examples try to be self
    contained and focus on the interface between the ConfD and the
    authentication/authorization application and doesn't actually interface
    to a real authentication/authorization service but should be straight
    forward to extend.

    (ENG-20122)

  - examples: new example for error formatting callback -
    "examples.confd/dp/error_formatting"

    (ENG-20015)

  - examples: added Java variant of ConfD example - CDB subscriber and
    getModifications()

    (ENG-19575)

  - examples: Added Example java/13-c_stats_push

    (ENG-19471)

  - examples: Added example python/13-c_stats_push.

    (ENG-19470)

  - examples: Example for external authorization has been added

    (ENG-18957)

  - examples: new ConfD example - data provider API range registration -
    usage of confd_register_range_data_cb()

    (ENG-18950)

  - examples: Example python/11-hooks has been added. The example
    demonstrates how to use set-hook and transaction hook in Python

    (ENG-18880)

  - java-api: MaapiCursor can now be created with an optional XPath filter
    allowing it to traverse a subset of a list.

    (ENG-19809)

  - java-api: A java data provider can now opt in to get a list filter
    passed down to it in order to perform filtering of lists directly in the
    data provider, for better performance. See "Using List Filters" in
    "Operational Data" in the User's Guide, and the javadoc.

    (ENG-19780)

  - java-api: Data providers now support multiple concurrent iterators
    within a single transaction.

    (ENG-19691)

  - java-api: A data provider that receives a SocketTimeoutException will no
    longer shut down its worker thread pool.

    (ENG-19571, RT:34751, PS-29818)

  - json-rpc: "deps" is now available in choice and case entries of
    "get_schema" response.

    (ENG-19712)

  - json-rpc: The JSON-RPC query api now has one more "result_as" type
    called "xpath_expression". When using this result type the XPath
    expression will be evaluated and the result will be returned as a JSON
    type. I.e. "1 + 1" will return 2 (not "2"). However, note that a path
    expression always returns a string regardless of what the YANG datatype
    the path might point to.

    (ENG-19164)

  - json-rpc: "evaluated_when_entry" is now available in choice and case
    entries of "get_schema" response if "evaluate_when_entries" is true.

    (ENG-18815)

  - json-rpc: show_config now supports result_as json2, variant of json
    output that stops on lists and use prefix instead of module name as
    prefix.

    (ENG-18056)

  - netconf: The NETCONF lock RPC has been extended with a parameter
    "wait-time". If this parameter is given, and the lock is already held by
    some other session, the server waits for the specified amount of seconds
    for the lock to be released. If the lock cannot be granted within the
    specified amount of time, a "lock-denied" error is returned.  See the
    YANG module "tailf-netconf-extensions" for details.

    (ENG-20126)

  - netconf: Memory consumption is greatly reduced in some scenarios where
    there is garbage data present in NETCONF messages.

    (ENG-19509, RT:33606, PS-28971)

  - netconf: Added YANG module tailf-netconf-with-transaction-id, which adds
    an input leaf "with-transaction-id" to edit-config, copy-config, commit
    and start-transaction. If this leaf is present, the result will include
    the transaction id, also available at
    /netconf-state/datastores/datastore/transaction-id.

    (ENG-19425, RT:34636, PS-29700)

  - netconf: The performance of NETCONF copy-config to a SFTP URL was
    improved.

    (ENG-19404, RT:34400, RT:34384, PS-29469, PS-29453)

  - netconf: Introduced a new configuration attribute to extend NETCONF logs
    with rpc-reply status information. See ConfD User Guide for detailed
    information.

    (ENG-18982, RT:33593, PS-28956)

  - netconf: ConfD now supports NETCONF Call Home over SSH, as defined in
    RFC 8071. Call Home is supported out-of-the box if ConfD's internal SSH
    server is used. If an external SSH server is used, a small C-program is
    needed to perform the initial setup. An example of such a program for
    OpenSSH is provided under "netconf_call_home/openssh".
    A new MAAPI function maapi_netconf_ssh_call_home() has been added, which
    user-defined code can call when it wants ConfD to call home to a client.

    (ENG-7042, RT:31492, RT:21775, RT:26239, RT:27727, RT:28403, RT:33281,
    PS-27498, PS-6922, PS-8280, PS-8829, PS-9087, PS-28751)

  - python-api: secondary_index and xpath_expr are now available as
    _confd.maapi.init_cursor keyword arguments.

    (ENG-19951)

  - python-api: Added an optional seventh argument to cb_action()
    implementation with confd.dp.Action.action decorator that enables read
    access to data from current read-only transaction.

    (ENG-19821)

  - python-api: Support for the list filter functionality has been added to
    the python API. See "Using List Filters" in "Operational Data" in the
    User's Guide.

    (ENG-19778)

  - python-api: Make it easier to use maagic.List.move() where you had to
    specify the 'to' keys in form of a list with Values. Now you can specify
    the 'to' key in form of a simple list or even a single Python value
    (e.g. the string "key1").

    (ENG-19402, RT:34615, PS-29679)

  - restconf: Support for the non-standard "unhide" query parameter is now
    advertised as a RESTCONF capability.
    The non-standard query parameter "format" which did not work
    as intended is now removed. RESTCONF users should use the
    Accept header.

    (ENG-20717)

  - restconf: Introduced a new configuration attribute to require module
    name in compliance with RFC 8040, section 3.5.3.
    '/confdConfig/restconf/requireModuleName/enabled (boolean) [true]'

    (ENG-20626)

  - restconf: Use X-Forwarded-(Host|Port) for modules-state schema URL.
    If user wants to configure schema URLs dynamically, e.g. being behind a
    reverse-proxy, allow this by configuring schemaServerUrl in confd.conf
    and defining @X_FORWARDED_HOST@ and @X_FORWARDED_PORT@ to configure via
    X-Forwarded-Host and X-Forwarded-Port headers.

    (ENG-20496, RT:36158, PS-31236)

  - restconf: yanger - Add support for remote augment to the yanger RESTCONF
    Swagger plugin.

    (ENG-19959, RT:35908, RT:36167, RT:35065, PS-30986, PS-31245, PS-30135,
    SR:685385943)

  - snmp-gateway: A confdConfig directive, rowCacheMaxSize, has been added
    to the snmpgw configuration.

    (ENG-20454, RT:31217, PS-27522)

  - snmp-gateway: A new log, for debugging the SNMP gateway, has been added.
    This log writes only to file and is configured via
    /confdConfig/logs/snmpGatewayLog.

    (ENG-20056, RT:31217, PS-27522)

  - snmp-gateway: In addition to the previously available 'timeout'
    parameter for snmpgw agents, there is now a 'retries' parameter in
    confdConfig. I.e. /confdConfig/snmpgw/agent/retries, default 0.

    (ENG-18508, RT:32756, PS-28424)

  - toolchain: The development tool netconf-console has been updated to
    support Python 3 and now requires at least Python 2.6.

    (ENG-20677)

  - toolchain: Added support for handling interrupt signal (CTRL-C) when
    waiting for notifications on netconf-console.

    (ENG-19619)

  - toolchain: YANG compiler will issue a warning if both
    tailf:cli-display-separated and tailf:cli-incomplete-command are set on
    a node.
    Also a warning will be issued if tailf:cli-incomplete-command is set on
    an empty presence container.

    (ENG-19309)

  - toolchain: confdc now takes a parameter --max-status current |
    deprecated, that can be used to implement only nodes with the given
    status.

    (ENG-18902)

  - toolchain: Added "confdc --conformance" so that a YANG module can be
    compiled with conformance "import" instead of the default "implement".

    (ENG-18467)

  - web-server: Added the HTTP Strict Transport Security response header to
    the web server to protect users from navigating away from the hosted
    service to an HTTP supported website. This is (for example) to prevent
    malware or phishing attacks.

    (ENG-19492)

  - web-server: JSON-RPC log has been moved from
    /confdConfig/logs/developerLog into a separate log in
    /confdConfig/logs/jsonrpcLog. The format of the log is now more concise.
    The full traffic trace for JSON-RPC/REST/RESTCONF can be enabled from
    /confdConfig/logs/webuiAccessLog/trafficLog. See the confd.conf(5)
    manual page for details.

    (ENG-19083)

  - web-server: Added the X-Content-Type-Options response header to the web
    server. This is a marker used by the server to indicate that the MIME
    (Multipurpose Internet Mail Extensions) types advertised in the
    Content-Type headers should not be changed and be followed.

    (ENG-18576)

  - web-server: Added the X-XSS-Protection response header to the web
    server. This is to prevent pages from loading if they detect an XSS
    (Cross-Site Scripting) attack.

    (ENG-18574)

Non-backwards compatible corrections:

  - confd: Corrected an issue where deleting and creating an operational
    list element in the same transaction, existing descendants to the
    element were not deleted. This applies on only normal transactions, but
    not on operational transactions.

    (ENG-20706)

  - confd: An augmented YANG node with the tailf:cdb-oper {persistent =
    true} could have a volatile operational node as a parent (not
    persistently stored). This implied that the operational data was lost at
    a restart of the system. Now an error is issued at load-time and the
    system is prevented from starting if this is the case.

    (ENG-20098)

  - confd: XML validation did not strictly apply the namespace declarations.
    E.g. the NETCONF server would treat <filter> as a parameter to
    <get-config> and <config> as a parameter to <edit-config> even if the
    "xmlns" attribute for the <filter> and <config> nodes specified a
    different namespace. This has been fixed.

    (ENG-19428)

  - confd: Sending of NETCONF notifications could fail if the schema for the
    notification payload had nodes with the same "local name" augmented from
    multiple modules. This has been fixed.
    The correction is considered non-backwards compatible since the earlier
    incorrect processing of node namespaces may also have allowed sending of
    notifications that did not conform to the schema, and now such
    notifications will be rejected.

    (ENG-19356, RT:34547, PS-29610)

  - confd: Writing a key leaf is now considered as an error. The keys of a
    list are implicitly set when a new list entry is created. It has
    previously been possible to explicitly set a key leaf after it's been
    created with undefined behavior as a result. With this change existing
    implementations of callbacks, transforms, actions etc. that set the key
    leafs explicitly will no longer work.

    (ENG-19305)

  - confd: ConfD did not verify that the data sent with
    confd_notification_send() actually corresponded to a YANG "notification"
    statement. This has been fixed - now an error is logged to devel.log,
    and nothing is sent, if this requirement is not fulfilled.

    (ENG-19114)

  - cdb: When cdb_diff_iterate() was used for the notifications generated by
    cdb_trigger_subscriptions() or cdb_trigger_oper_subscriptions(),
    leaf-list data was always reported as if the flag
    ITER_WANT_LEAF_LIST_AS_LEAF had been passed to cdb_diff_iterate(). This
    has been fixed, i.e. now the default is to report leaf-list data as
    lists, and ITER_WANT_LEAF_LIST_AS_LEAF works as expected.

    (ENG-19964, RT:35394, PS-30468)

  - cdb: Namespace prefix(es) given in the subscription path were not
    reflected in the path reported for the subscriber info in "confd
    --status" or /confd-state. This has been fixed.

    (ENG-15634, RT:28964, PS-9330)

  - cli: Change introduced for how cli-show-templates are displayed when
    issuing CLI show commands containing ranges, has been reverted. The
    problem that was originally addressed by the changes should instead be
    solved by using a conditional expression in the show-template for the
    list instance.
    For more information about expressions in show-template, see
    cli-template-string in the YANG CLI extensions man pages.

    (ENG-20167, RT:35539, PS-30614)

  - cli: Fix issue of CLI 'show running-config' command displays '0' instead
    of the string with range values.

    (ENG-19557, RT:34832, PS-29900)

  - cli: The tailf:cli-value-display-template annotation was used when
    formatting key values for use in completion. This caused the completion
    code to fail. This has been fixed.

    (ENG-18290, RT:32468, RT:35596, PS-28186, PS-30670)

  - cli: It is now possible to annotate a node with both tailf:hidden full
    and tailf:hidden <other>. In this case <other> can be unhidden, but
    since the node is hidden full, it is not accessible over NETCONF and
    RESTCONF.

    (ENG-12918, RT:28721, PS-9213)

  - java-api: In SyslogNotification, the prio and logno fields were
    confused, namely getPrio() method would return the value for logno and
    getLogNo() would return the value for prio. This has been fixed.

    (ENG-20490)

  - json-rpc: JSON-RPC method 'get_trans_changes' shall not show hidden
    nodes.

    (ENG-20286, RT:35636, PS-30712)

  - json-rpc: Corrected flags of get_schema in JSON-RPC.

    (ENG-20035)

  - json-rpc: Corrected the number of reported error in 'validate_commit'
    response, which is the value of 'confdConfig/maxValidationErrors
    (uint32 | unbounded)' config attribute.

    (ENG-18988, RT:33750, PS-29043)

  - netconf: The replayLogCreationTime and replayLogAgedTime generated from
    the built-in replay store now adheres to RFC 5277. Please note that this
    change is backwards incompatible in a HA setup, where slave nodes need
    to have this fix to be compatible with a master node running with this
    fix.

    (ENG-19466, RT:34658, PS-29724)

  - netconf: Implemented 'netconf-capability-change' notification ('NETCONF'
    stream; see RFC 6470 section 2.2). The 'capabilities-changed' error is
    now fired only if capabilities list was effectively changed (capability
    added, modified or deleted; see also RFC 7895 section 2.1.1).

    (ENG-19231, RT:33896, PS-29145)

  - python-api: Using Maagic to create a keyed list entry in an input or
    output section of an action now need the key(s) to be specified in the
    create() call.

    (ENG-18102)

  - rest-api: HTTP PATCH is not allowed to create a non-existing instance.

    (ENG-21000)

  - restconf: Correct the body format of yang-patch-status response message
    in success cases.

    (ENG-20606, RT:36346, PS-31425)

  - restconf: REST/RESTCONF rejects the requests include multiple names in
    one JSON object.

    (ENG-19760, RT:35118, PS-30189)

  - restconf: RESTCONF does not allow PATCH method to create new resource
    instance to compliance with RFC 8040.

    (ENG-18737)

  - restconf: Added 'ietf-restconf' module prefix to top and root resources
    in JSON responses.

    (ENG-18675, RT:33106, PS-28667)

  - restconf: Corrected the 'Allow' header in the response to the 'OPTIONS'
    method.

    (ENG-16723, RT:28114, PS-8965)

  - restconf: Corrected the result of 'fields' query parameter in
    REST/RESTCONF requests.

    (ENG-16163)

  - snmp-agent: When storing SNMPv2-TC::DateAndTime values, these were
    incorrectly interpreted in two ways. Deciseconds were interpreted as
    1/100000s of a second and the minutes portion of negative timezone
    offsets were interpreted as positive offsets. This has been fixed.

    (ENG-18731, RT:33197, PS-28723)

  - toolchain: If --fail-on-warnings were given to confdc, and a YANG module
    was compiled with a file name that didn't match the module name, a
    warning would be printed, but it wasn't treated as an error. This bug
    has been fixed.

    (ENG-19960)

  - toolchain: confdc / yanger no longer accepts "description", "reference",
    and "status" under "input" and "output".

    (ENG-18943)

  - web-server: The 'Server' header is now disabled by default. The Operator
    can set 'Server' header in HTTP response by using
    '/confdConfig/webui/customHeaders' config.

    (ENG-19424, RT:34641, PS-29705)

  - xpath: when and must expressions from YANG files now evaluate properly
    when the prefix from the module imports is different from the module
    prefix.

    (ENG-18103, RT:32274, PS-28061)

Corrections:

  - confd: If an action or RPC is invoked within a transaction, the input
    parameters are now validated in the context of that transaction. This
    means that for example leafrefs to items created in that transaction are
    accepted as valid (which was previously not the case).

    (ENG-20813)

  - confd: There are two modes for a candidate datastore; unhide_inactive
    and hide_inactive. When the confd.conf attribute enableInactive is set
    to true, the mode of read transaction is hide_inactive. The
    authorization state of this transaction was not correctly set after the
    lock operation.
    Setting authorization state of hide_inactive correctly after the lock
    fixes the problem.

    (ENG-20629, RT:36307, PS-31385)

  - confd: In rare circumstances entries in an ordered-by user list could be
    lost. This happened when the list had more than 128 entries, a hash
    collision occurred and the length of the values causing the collision
    was not equal.

    (ENG-20509, RT:36245, PS-31324, SR:686100229)

  - confd: when expressions are now checked on ancestor non presence
    containers on create, get, set and delete operations.

    (ENG-20493, RT:35690, PS-30766)

  - confd: Loading JSON data with a YANG list in a different namespace could
    in some cases confuse the JSON parser and result in an "unknown element"
    error. This has been fixed.

    (ENG-20461)

  - confd: JSON output with instance-identifiers pointing to instances with
    : in their keys no longer fail with internal error.

    (ENG-20298, RT:35853, PS-30931, SR:685908555)

  - confd: Using the leaf-list backwards compatibility flag no longer cause
    a crash when iterating over a list in a subscriber.

    (ENG-20250, RT:35744, PS-30820)

  - confd: Fixed handling case changes in nested choices when parent
    mandatory choice gets implicitly deleted and set back in the same
    transaction that was causing internal errors previously.

    (ENG-20228, RT:35503, PS-30577)

  - confd: Setting single slash as value to a leaf with type union of
    instance-identifier and XPath would cause internal error. This has now
    been fixed.

    (ENG-20109, RT:35576, PS-30650)

  - confd: maapi commands no longer fail with "not unique" error if there is
    a notification with the same name as the top-level element in the path
    when given without a prefix.

    (ENG-20093, RT:35536, PS-30611)

  - confd: If a YANG list had multiple keys where at least one was a string,
    ConfD would not order long strings (longer than 32 characters)
    alphabetically. This bug has been fixed.

    (ENG-20019)

  - confd: Fixed an issue that caused internal errors when cases under a
    nested choice were re-created and an annotation was added to the parent
    container.

    (ENG-19957)

  - confd: Writing an explicit default value to a leaf with default value no
    longer cause dependent when-statements to be evaluated.

    (ENG-19953, RT:35284, PS-30356, SR:685493763)

  - confd: Too much internal memory was used to store data models containing
    the tailf:cli-diff-dependency annotation. This has been fixed.

    (ENG-19847)

  - confd: When a JSON payload had a toplevel data tag, ConfD would reject
    list entries with keys out of order (with a "missing element" error).
    This has been fixed.

    (ENG-19840, RT:34972, PS-30040)

  - confd: tailf:symlink and tailf:link once again work for leaf-lists
    targets.

    (ENG-19817, RT:35190, PS-30261)

  - confd: Tab completion on action parameters with type leafref and nested
    choice would make CLI restart. This has now been fixed.

    (ENG-19771, RT:35132, PS-30203)

  - confd: Better handling when a new slave fails to synchronize with the
    master. Now the slave will be asked to retry performing the
    synchronization.

    (ENG-19650, RT:34752, PS-29819)

  - confd: get-next operations toward an external data provider could
    contain a Keypath which should have been pruned by a corresponding
    when-expression (i.e no get-next operation should have been generated
    for this particular Keypath).

    (ENG-19611, RT:34376, PS-29443)

  - confd: ConfD could fail to rebind the listen socket(s) for IPC if the
    IPC configuration in confd.conf was changed and "confd --reload" was
    done, or if maapi_rebind_listener() was called with CONFD_LISTENER_IPC.
    This has been fixed.

    (ENG-19558)

  - confd: When a node started, and at the same time was given an HA role
    (master/slave/none), there was a risk of deadlock. This has been fixed.

    (ENG-19553, RT:34634, PS-29698)

  - confd: Transaction id and session id are now displayed in CLI progress
    event print-outs when entering a new transaction phase.
    Added notification event class for progress events (with commit progress
    events as subset).

    (ENG-19549, RT:34697, RT:34874, PS-29762, PS-29942)

  - confd: There was a very small risk that a HA master reverted to none
    when connecting with a slave. This has been corrected.

    (ENG-19539, RT:34819, PS-29887)

  - confd: The removal of "stale" entries from the "object cache" for
    external data providers has been optimized.

    (ENG-19494)

  - confd: Loading JSON data with empty containers and namespace changes no
    longer cause invalid "unknown element" errors to be reported.

    (ENG-19473, RT:35557, RT:34952, RT:34673, PS-30632, PS-30020, PS-29739)

  - confd: Re-evaluating a when-expression to true caused enclosed mandatory
    leaves, present in CDB, to incorrectly being marked as unset.

    (ENG-19462, RT:34679, PS-29745)

  - confd: A data structure used for storing locks has been replaced in
    order to avoid a potential crash.

    (ENG-19340, RT:34515, RT:36072, RT:36308, RT:36883, PS-29578, PS-31151,
    PS-31386, PS-31965, SR:685116574)

  - confd: An issue that could result in the system to freeze for large diff
    calculations have been addressed.

    (ENG-19214, RT:32571, PS-28331, SR:684199436)

  - confd: Using CDATA inside PCDATA could cause incorrect validation
    errors. This has been fixed.

    (ENG-19186, RT:34202, PS-29327)

  - confd: "get_attrs" callback could be invoked even if attributes were
    disabled in the configuration. This has been fixed.

    (ENG-19184, RT:31902, RT:35287, RT:34121, RT:34459, RT:35331, PS-27794,
    PS-30359, PS-29272, PS-29521, PS-30405)

  - confd: The processing of the "object cache" for external data providers
    has been optimized to compensate for the performance degradation caused
    by the changed leaf-list implementation.

    (ENG-19178, RT:34121, PS-29272)

  - confd: A config data provider using the backward-compatibility flag
    CONFD_DAEMON_FLAG_LEAF_LIST_AS_LEAF could cause a commit to fail if the
    duration of the WRITE phase exceeded the object cache timeout. This has
    been fixed.

    (ENG-19141, RT:34119, PS-29271)

  - confd: Fixed scenario where kickers could stop working after a HA
    failover.

    (ENG-19117, RT:33682, PS-29062)

  - confd: With multiple levels of choices (where the upper level had a
    default case) and a lower case was deleted, the upper default was not
    reset. This has been fixed.

    (ENG-19116)

  - confd: Improved performance when processing when-expressions.

    (ENG-19058, RT:33871, RT:35291, PS-29125, PS-30364)

  - confd: When /confdConfig/defaultHandlingMode config was set to 'trim' it
    did not filter out default values correctly for 'leaf-lists'. This has
    now been fixed.

    (ENG-19056, RT:33712, PS-29046)

  - confd: If a YANG 1.1 leaf-list with default value(s) was deleted (i.e.
    reset to default) with rollbacks enabled, the subsequent commit would
    fail with "internal error". This has been fixed.

    (ENG-18986, RT:34359, RT:33757, PS-29414, PS-29045)

  - confd: Validation of a leaf-list with a leafref would give incorrect
    results if the type was an externally defined typedef. This has been
    fixed.

    (ENG-18971, RT:33710, PS-29015)

  - confd: Added the possibility to turn off the insertion of newline
    characters in the base64 encoding for the lexical representation of the
    YANG type 'binary', by setting /confdConfig/newlinesInBinaryBase64 to
    "false".

    (ENG-18945, RT:33598, PS-28957)

  - confd: Inactive flag on a non-presence container was not reset upon
    replacing the configuration with the new configuration where the element
    is active. This has been fixed.

    (ENG-18709, RT:32719, PS-28417, SR:684259787)

  - confd: Unsupported SSH keys are skipped by the SSH daemon.

    (ENG-18637, RT:34232, RT:34731, RT:33068, PS-29345, PS-29798, PS-28599)

  - confd: Problems related to `when`,`mandatory` and default values have
    been resolved.  These problems include:
    * A mandatory leaf not being deleted when the `when` expression for an
    enclosing non presence changed value from `true` to `false`
    * Subscription notifications were not delivered when a mandatory leaf
    was deleted
    *  Similar to above the `min-element` for a list was not handled when
    its existence was changed

    (ENG-18543, RT:31641, RT:32744, RT:32899, RT:34179, PS-27610, PS-28375,
    PS-28480, PS-29304, SR:684328368)

  - confd: Fixed a problem where applying a rollback, on configuration
    without having full privileges for all changes, would cause an internal
    error message.

    (ENG-18279, RT:32492, PS-28197)

  - confd: If :inactive was enabled, ConfD would in some cases try to
    validate inactive data. This bug has been fixed.

    (ENG-17970)

  - confd: Mixing when/must expressions with default values could cause the
    default value to overwrite a correct set value. This has been fixed.

    (ENG-17417, RT:31165, RT:33119, RT:30732, PS-27304, PS-28626, PS-27015)

  - confd: Changed the data type accordingly in order to display timezone=0
    in a correct way.

    (ENG-17018, RT:30525, PS-10108)

  - confd: Simultaneous modification of data-nodes belonging to different
    case statements under the same choice by several transactions are now
    detected and marked as conflicting nodes.

    (ENG-16872, RT:29850, PS-9755)

  - confd: Removed dependency between CLI and WebUI, to be able to use the
    CLI if the WebUI is not included.

    (ENG-16706, RT:26687, PS-8438)

  - confd: Having a NACM rule with 'deny' on the 'delete'-operation for
    child nodes to a list, would cause a problem when deleting list
    instances created in one transaction. Doing a delete, through JSON RPC
    or CLI, would result in not deleting all of the created list instances
    as was expected.
    Now the delete is performed and all list instances are removed, if the
    NACM rules permits it.

    (ENG-16638, RT:25735, PS-8135)

  - confd: Fixed a problem where trying to show a hidden node in JSON
    format, in a transaction where the node should be shown using the
    'unhide' option, did not show the content of the node.

    (ENG-16110, RT:25364, RT:33329, PS-8024, PS-28788)

  - confd: Some error messages for invalid NETCONF parameter settings in
    confd.conf gave incorrect paths for related parameters. This has been
    fixed.

    (ENG-2739, RT:28806, PS-26969)

  - aaa: When default action is "deny" and rules are ordered like below:
    allow /a/b/c
    deny /a/b/*
    allow /a/b
    rules processing was incorrect, allowing access to siblings of /a/b/c
    node during completion. This is fixed.
    Note that in presence of module-specific rules access to siblings of
    /a/b/c during completion may be allowed despite "deny" rules, and this
    is not possible to change.
    During traversal all access rights are applied correctly.

    (ENG-19343, RT:34506, PS-29569)

  - aaa: RPC requests would always fail when an authorization callback for
    data authorization had been registered, and the execute access check was
    not filtered out. This has been fixed.

    (ENG-18566, RT:32906, PS-28518)

  - building: confdc now handles deref() of a leafref that doesn't refer to
    a key.

    (ENG-19535, RT:34798, PS-29866)

  - c-api: The C-API library (also used by the Python API) could not handle
    integer-values above 2^31-1 (used when avoiding known hash collisions)
    for the node elements in a hkeypath. This has been fixed.

    (ENG-20020, RT:35467, PS-30541)

  - c-api: An action handler implemented in C or Python could run out of
    stack space if called with a very long list as an input parameter. This
    has been fixed by allocating the temporary memory on the heap.

    (ENG-19314, RT:34485, PS-29548, SR:685128339)

  - c-api: Very long leaf lists could cause stack overflow in some
    configurations. The new behavior use stack for small leaf-lists and heap
    for large ones.

    (ENG-19194, RT:34241, PS-29359)

  - c-api: confd_pp_kpath(), confd_xpath_pp_kpath() and
    confd_format_keypath() now print enum values as strings instead of
    enum<integer> for leaf-list paths.

    (ENG-19014, RT:33758, PS-29066)

  - c-api: Fixed exists() handling in CAPI for keyless lists.

    (ENG-18577, RT:32809, PS-28421)

  - c-api: The "%*x" format modifier for CDB and MAAPI paths would
    concatenate adjacent values of type C_BUF or C_STR. This has been fixed.

    (ENG-17490)

  - c-api: The utility functions confd_max_object_size() and
    confd_next_object_node() produced incorrect results if the "object"
    included a tailf:action or YANG-1.1 'action' or "inline" 'notification'.
    This has been fixed.

    (ENG-2475, RT:29141, RT:29142, PS-9420, PS-9421)

  - cdb: Memory consumption optimization for handling cdb_op deletes in
    operational db.

    (ENG-20603, RT:35715, PS-30791)

  - cdb: ConfD didn't handle schema upgrades from non-presence to presence
    container correctly. This has been fixed.

    (ENG-20550, RT:35984, PS-31063)

  - cdb: Writing operational data to a leaf with a config prefix path
    containing a when-statement now works.

    (ENG-20251, RT:35760, PS-30836)

  - cdb: Reading an unmodified leaf with validation dependencies from
    pre_commit_running now return the correct unmodified value.

    (ENG-20235, RT:35199, PS-30270)

  - cdb: Reading an unmodified leaf with validation dependencies from
    pre_commit_running now return the correct unmodified value.

    (ENG-19950, RT:35199, PS-30270)

  - cdb: cdb_get_modifications could in some situations return extra
    C_XMLBEGIN tag values. This has been fixed.

    (ENG-19395, RT:34554, PS-29618)

  - cdb: A subscription on a leaf having a default value will now generate a
    proper notification on creation or deletion somewhere above in the model
    tree.

    (ENG-19210, RT:34250, PS-29368)

  - cdb: YANG choice with default didn't always work correctly. This has
    been fixed.

    (ENG-19031, RT:33726, PS-29023)

  - cdb: If a YANG 1.1 leaf-list with defaults was created when the defaults
    were "in use", and cdb_diff_iterate() was used with the ITER_WANT_PREV
    and ITER_WANT_LEAF_LIST_AS_LEAF flags, the 'oldv' argument for the
    iter() callback was NULL instead of providing the defaults. This has
    been fixed.

    (ENG-19003, RT:33712, PS-29046)

  - cdb: Fixing scenario where ConfD could crash due to incorrect handling
    of closing the socket for CDB sessions waiting for a lock.

    (ENG-18952, RT:33638, PS-28988)

  - cdb: Reading the top node in a nested choice, without any containers or
    lists in between, would not return the tag in string format but instead
    a hash number. This only occurred when deleting a nested case and in
    pre_commit_running.

    (ENG-18600, RT:32909, PS-28532)

  - cdb: cdb_exists() for a leaf-list element (i.e.
    "/path/to/leaf-list{element-value}") would always return 0, i.e.
    "false". This has been fixed.

    (ENG-18559)

  - cdb: Type empty leafs with validation constraints are now intact after
    upgrade.

    (ENG-18211, RT:32127, RT:32570, PS-27947, PS-28255)

  - cdb: Removing a namespace by deleting a fxs file and restarting will now
    always change the transaction id.

    (ENG-17960, RT:32001, PS-27857)

  - cdb: It was possible to get corrupted data when adding enums from the
    start of the enum definition.

    (ENG-16708)

  - cdb: cdb_get_modifications() now includes key values for operational
    leafs with a configuration list parent.

    (ENG-5813, RT:34557, PS-29621)

  - cli: The CLI would time out with an IDLE TIMEOUT message even when the
    user was typing. The idle timeout would only be reset on TAB/SPACE
    completion or when a command was executed. This has been fixed such that
    the idle timeout is reset whenever the user types.

    (ENG-20837, RT:36662, PS-31742)

  - cli: When combining NACM rules that blocks read access to specific nodes
    and also having dependency towards these nodes on data that is
    accessible to the user the CLI could crash. This has been fixed.

    (ENG-20824, RT:36661, RT:36784, PS-31741, PS-31865)

  - cli: Custom CLI commands with parameters of type XPath would cause the
    CLI to crash during TAB completion if instanceDescription was set to
    false. This has been fixed.

    (ENG-20655, RT:36112, PS-31191)

  - cli: Completion of 'wait-device' commit parameter has been updated so
    that it does not suggest device names that are already entered.

    (ENG-20613)

  - cli: Handling of asterisk in list keys has been corrected.

    (ENG-20605, RT:36376, PS-31455)

  - cli: The annotation tailf:cli-suppress-echo in combination with
    tailf:cli-multi-value resulted in an internal error when a value with
    more than one component was entered in the CLI. This has been fixed.

    (ENG-20563, RT:36303, PS-31381)

  - cli: The XML displayed when running the 'show configuration | display
    xml' was not correct when the edits involved an insert into an
    ordered-by user list. This has been fixed.

    (ENG-20524, RT:36140, PS-31218)

  - cli: When producing a diff in the CLI with a group/user that has
    restricted access to certain data nodes the CLI could crash if the
    modified data had diff-dependency extensions. This has been fixed.

    (ENG-20475, RT:36149, PS-31227)

  - cli: A configuration saved in curly braces format (J-style) would not
    load properly if prefixes were displayed and the tailf:alt-name
    annotation was used. This has been fixed.

    (ENG-20473, RT:36057, PS-31136)

  - cli: A bug which caused lots of spurious error printouts about "unknown
    transaction handler" when executing "show configuration" and similar
    commands has been fixed.

    (ENG-20444)

  - cli: A cli-diff-dependency annotated on a leaf with a default value
    would in some cases not trigger when displaying the configuration diff
    (e.g. 'show configuration') when the leaf had been deleted. This has
    been fixed.

    (ENG-20422)

  - cli: When using aaa-rules to block view but allow create/edit of data
    the J-Style CLI would block all access to the specified data. This has
    been fixed.

    (ENG-20418, RT:35838, PS-30915)

  - cli: Leafs with the tailf:cli-preformatted annotation were not saved
    with quotes in curly braces format. This has been fixed.

    (ENG-20369)

  - cli: When trying to delete elements of a leaf-list and the key had the
    same name as the leaf-list the CLI would sometimes present faulty naming
    information in the diff. This has been fixed.

    (ENG-20355, RT:35931, PS-31009)

  - cli: Support for aborting (CTRL-C) auto-commit of transactions could
    make non-interactive usage of the CLI hang indefinitely. This has been
    fixed so that non-interactive CLI does not enable aborting of
    auto-commit transactions.

    (ENG-20353)

  - cli: Using 'unhide' in the CLI caused an "internal error" message. This
    was due to group names not being handled correctly.

    (ENG-20350)

  - cli: confdc -c <file>.cli would sometimes report an error 'is
    incorrectly quoted' for attributes where the equal sign (=) was followed
    by a space. This bug was introduced in 6.7.3 and has now been fixed. A
    workaround is to remove the space between the equal sign character and
    the quote character.

    (ENG-20332, RT:35895, PS-30973)

  - cli: The time to display the configuration diff (e.g. 'show
    configuration') would in some cases vary significantly depending on if a
    single leaf had been configured or not (in the context of an otherwise
    large configuration diff). This has been fixed.

    (ENG-20243, RT:35679, PS-30755)

  - cli: When the CLI accesses data and applies filters at a much higher
    level the CLI could sometimes crash. This has been fixed.

    (ENG-20242, RT:35531, PS-30606)

  - cli: Handling of action abort is brought in sync with handling of commit
    abort, that is, when an action is not confirmed or user pressed Ctrl-C
    during action execution, an abort message is logged in audit.log.

    (ENG-20202, RT:34672, PS-29738)

  - cli: Configuration diff calculation has been corrected for presence
    containers with cli-flatten-container and cli-compact-syntax extensions.

    (ENG-20131)

  - cli: Handling of node paths that exist in multiple namespaces has been
    corrected.

    (ENG-20096)

  - cli: Using tailf:cli-multi-value and tailf:cli-max-words on a leaf with
    type union could in some cases treat the next sibling node name as part
    of the current value being set. This has now been fixed.

    (ENG-20054, RT:35535, PS-30610)

  - cli: The configuration diff as displayed by the C-style command 'show
    configuration' after changing the value of a node annotated with
    tailf:cli-sequence-commands and tailf:cli-reset-siblings, would in some
    cases be incorrect if this node was also subject to a dependency
    (tailf:cli-diff-set-before). This has been fixed.

    (ENG-20049, RT:35495, RT:35520, PS-30569, PS-30595)

  - cli: Filtering of refcounter- and backpointer-attributes in the CLI
    during diff-creation has been deemed unnecessary and damaging. This has
    been removed and thus fixed.

    (ENG-19955, RT:34680, RT:36040, RT:35821, RT:35117, PS-29746, PS-31119,
    PS-30898, PS-30188)

  - cli: An action with input parameter of list type would cause 'show
    parser dump' to enter an infinite loop expanding the command with
    repeated list entry. This has now been fixed.

    (ENG-19935, RT:35364, PS-30438)

  - cli: If a CLI user was repeatedly sending "configure" command trying to
    enter config mode while all the available concurrent read-write
    configuration sessions were occupied, it could sometimes "steal" a
    configuration session and block out another CLI user that previously
    held the last configuration session. This race condition issue has now
    been fixed.

    (ENG-19918, RT:31915, PS-27803)

  - cli: Handling of delete operation on a leaf with default value and
    tailf:cli-diff-delete-* dependencies has been corrected.

    (ENG-19903)

  - cli: Handling of nodes with tailf:cli-show-no, that the user cannot
    access, has been corrected.

    (ENG-19855, RT:35152, PS-30223)

  - cli: The configuration diff as displayed by 'show configuration' would
    in some cases be incorrect when using diff-dependencies and leafrefs in
    certain interacting combinations in the YANG model. This has been fixed.

    (ENG-19849, RT:34073, PS-29253)

  - cli: Some performance degradation was observed as a consequence of a
    closer reporting of annotations when displaying the configuration in
    Cisco style. It was seen when displaying the configuration, i.e. show
    running-config and when saving the configuration in C-style. The
    implementation of this feature has now been reworked to improve the
    performance.

    (ENG-19835, RT:35129, PS-30200)

  - cli: Trying to delete a list-instance in the C-style CLI (e.g. 'no ...')
    while including a leaf annotated with tailf:cli-hide-in-submode would in
    some cases result in an internal error. This has been fixed.

    (ENG-19804, RT:35169, PS-30240)

  - cli: Error messages related to file operations has been improved,
    containing the file name where it is possible.

    (ENG-19797)

  - cli: In case of a list with tailf:cli-delete-when-empty and
    tailf:cli-suppress-mode extensions, and with the
    tailf:cli-incomplete-command extension at the same time: when deleting
    such a data node, the diff calculation outputs an extra command line to
    add the data node itself even if it does not comply with
    tailf:cli-incomplete-command extension. This is to allow correct
    processing of correct configuration updates that result in such a diff
    while reporting an error if such updates are result of misconfiguration.

    (ENG-19781, RT:35141, PS-30212, SR:685504044)

  - cli: When using lists with multiple keys that also are leafrefs the CLI
    could fail during validation of the TAB-completion and incorrectly
    report an error. This has been fixed.

    (ENG-19759, RT:35095, PS-30166)

  - cli: Invoking an action with parameters augmented from another namespace
    resulted in an internal error. This has now been fixed.

    (ENG-19699)

  - cli: When mixing clispec and ordinary config nodes the CLI could fail in
    finding the config data nodes. This has been fixed.

    (ENG-19675, RT:30853, PS-27118)

  - cli: In case when an action has a list as input, and one leaf in the
    list has 'when' condition referring to another field of the same list
    the condition sometimes was not respected due to incomplete action
    parameters processing. This has been corrected.

    (ENG-19649, RT:34933, PS-30001, SR:684660186)

  - cli: The CLI performed a get_next() when doing completion (when hitting
    TAB or SPACE) even when there was a perfect match for the entered
    instance. This has now been changed such that a get_elem() is first
    attempted, and if the instance exists, no get_next() invocation is
    performed. If a list has a multi-element key, then this optimization is
    only applied to the last element of the key.

    (ENG-19642)

  - cli: The pipe command 'display json' did not work properly if the
    filtering command contained partial keys, range or explicit wildcard (*)
    to filter out list entries. This has now been fixed.

    (ENG-19595)

  - cli: Removed comment about suppressFastShow being experimental. It is no
    longer an experimental option.

    (ENG-19589)

  - cli: ConfD failed to start when checking any dynamic old mode CLI
    commands to mount. This regression has now been fixed.

    (ENG-19585, RT:34879, PS-29947)

  - cli: In the case where several data providers have registered range
    callbacks to a callpoint, and the 'confd.conf' setting
    '/confdConfig/cli/caseInsensitiveKeys' (or the YANG extension
    'tailf:cli-case-insensitive') is used, ConfD would make a 'get_elem'
    call to the wrong data provider. This has been fixed.

    (ENG-19566, RT:34896, PS-29964)

  - cli: Logout session command did not work properly in I-style CLI. This
    regression has now been fixed.

    (ENG-19486, RT:34696, PS-29761)

  - cli: Group information (gids) was not properly transferred to programs
    started through the CLI and the WebUI when the user lacked gids. This
    has been fixed.

    (ENG-19481, RT:34598, PS-29662)

  - cli: When 'useShortEnabled' is set to "true" the CLI completion
    suggestion is based on the value that is set in the configuration.

    (ENG-19479, RT:34713, PS-29779)

  - cli: Commit aborted by user is logged in the audit log file.

    (ENG-19461, RT:34672, PS-29738)

  - cli: Show command would generate an internal error for certain types of
    match filters. This has been fixed.

    (ENG-19452, RT:34194, RT:34730, PS-29323, PS-29797)

  - cli: Tab completion and pattern parsing did not work correctly when the
    tailf:cli-key-format annotation was used to merge multiple key values
    into a single string. Also the confd.conf setting
    /confdConf/cli/allowImplicitWildcard was ignored for cli-key-format
    values when set to false. This has been fixed.

    (ENG-19423, RT:34601, PS-29665)

  - cli: Commands aborted early due to access denied are logged in the audit
    log file.

    (ENG-19304, RT:33679, PS-29007)

  - cli: The templatize command was accidentally included in ios mode. This
    has been fixed.

    (ENG-19255)

  - cli: Programs invoked through the CLI, such as custom CLI commands, or
    startup scripts, were not executed correctly if the TERM variable was
    unset or set to empty. This has been fixed.

    (ENG-19221, RT:34162, PS-29284)

  - cli: The configuration diff as displayed by ex. 'show configuration'
    would in some cases be incorrect if the change-set contained a node of
    the type leafref and a node annotated with the extension
    'tailf:cli-diff-add-after' under the same container parent. This has
    been fixed.

    (ENG-19193, RT:34073, PS-29253)

  - cli: In the case when a container has both tailf:cli-compact-syntax and
    tailf:cli-flatten-container the output of "show" command is finalized
    properly, showing all the data requested.

    (ENG-19154, RT:25687, PS-8120)

  - cli: A container with 'tailf:cli-compact-syntax' and with two children
    (containers), both with 'tailf:cli-flatten-container', would cause a
    faulty diff. This has been corrected.

    (ENG-19146)

  - cli: When loading configuration commands using
    maapi_load_config_commands() and the option MAAPI_CONFIG_NO_BACKQUOTE
    lines ended with a backslash would wrap around to the next line. This
    has been fixed such that it doesn't.

    (ENG-19135, RT:28128, PS-8971)

  - cli: When the "defaultConfirmOption" element was set to "no" and calling
    a command defined in the clispec, in the non-interactive mode, the CLI
    did not automatically provide "yes" in the "confirmText" prompts. This
    has now been fixed.

    (ENG-19120, RT:32573, PS-28258)

  - cli: The configuration diff (as displayed by 'show configuration') after
    re-ordering the instances of a 'ordered-by user' list annotated with
    tailf:cli-show-obu-comments, tailf:cli-sequence-commands and its
    substatement tailf:cli-reset-siblings would in some cases display the
    list in an incorrect order. This has been fixed.

    (ENG-19112)

  - cli: It was not possible to invoke an action from configure mode in the
    C-style CLI (i.e. 'do <action-path>') when the path contained a range
    expression. This has been fixed.

    (ENG-19103, RT:33913, PS-29165)

  - cli: A glitch in the caching mechanism of the CLI could result in
    reduced performance. This has been fixed.

    (ENG-19086)

  - cli: Additional synchronization has been implemented as part of user
    interrupt (Ctrl-C) handling.

    (ENG-19085, RT:33816, PS-29085)

  - cli: The CLI would sometimes present duplicate printouts of data nodes
    with modes. This has been fixed.

    (ENG-19074, RT:33876, PS-29147, SR:684713804)

  - cli: Appending default value to leaf-list did not work properly when
    "/confdConfig/defaultHandlingMode" is set to "explicit". This has now
    been fixed.

    (ENG-19057, RT:33923, RT:33712, PS-29154, PS-29046)

  - cli: Displaying an inline notification defined in a container or list
    that had been augmented from another namespace would result in an
    'internal error'. This has now been fixed.

    (ENG-19055, RT:33080, PS-28607)

  - cli: Using 'describe' in the CLI could cause an "internal error" message
    when used with hidden group names. The 'describe' command is now updated
    to handle this.

    (ENG-19045, RT:33865, PS-29111)

  - cli: When the CLI session limit was reached, SSH login connections did
    not automatically close after timeout. This has now been fixed.

    (ENG-19042, RT:32471, PS-28179)

  - cli: CLI behaviour was inconsistent with regard to cases when clispec
    had defined commands with paths equal to data paths from the YANG model.
    Now this is modified so that commands from clispec take precedence over
    YANG model (and built-in commands) if the input matches clispec command
    exactly. The man page for clispec is also updated to reflect this
    behaviour change.

    (ENG-19027, RT:33703, PS-29032)

  - cli: The memory consumption when showing huge leaf-lists has been
    optimized.

    (ENG-19025, RT:33482, PS-28908)

  - cli: When executing 'show configuration' and piping to display in JSON
    format, CLI aborted with an internal error. This has now been fixed.

    (ENG-19016, RT:33418, PS-28842)

  - cli: Improved security by encoding the parameters passed to OS commands.

    (ENG-18954, RT:33459, RT:35120, PS-28876, PS-30191)

  - cli: The describe command for certain built in commands would fail. This
    has been fixed.

    (ENG-18942, RT:33584, PS-28947)

  - cli: Rollback files were not correct when deleting string values
    containing the sequence \[0-9]+. This has been fixed.

    (ENG-18933)

  - cli: List key traversal would not work for 'case insensitive' keys, when
    the command was defined in clispec, and when
    'confd_register_range_data_cb' was used at the same time. This has been
    fixed.

    (ENG-18926, RT:33456, PS-28875)

  - cli: It was not possible to get sibling nodes of a leaf-list in
    completion if the leaf-list had cli-flat-list-syntax extension set and
    the parent node had cli-sequence-commands extension set. This has been
    fixed. To have proper completion the leaf-list should also have
    cli-disallow-value extension with names of all sibling nodes, see
    updated User Guide.

    (ENG-18915, RT:33560, PS-28935)

  - cli: Configuration files on curly bracket format would not load properly
    if they contained a leaf-list of type instance-identifier, and the last
    character in the instance-identifier was a ]. This has been fixed.

    (ENG-18887)

  - cli: The configuration diff, displayed by 'show configuration', as
    produced by deleting instances in a list annotated with
    'tailf:cli-recursive-delete' while the list contained a container not
    annotated with the above statement, would in some cases be incorrect.
    This has been fixed.

    (ENG-18877)

  - cli: Displaying operational data as a table by running a filtering
    'show' command would in some cases produce a table where the filter was
    not applied correctly. This has been fixed.

    (ENG-18845, RT:33405, PS-28854)

  - cli: Sometimes when setting and unsetting data within a choice the CLI
    would miss out on reporting a delete operation. This has been fixed.

    (ENG-18834)

  - cli: Invoking a callback implementing the function
    maapi_cli_prompt_oneof2(), from the CLI, would cause the user to be
    prompted for a value while the CLI would be unresponsive and hang
    indefinitely. This has been fixed.

    (ENG-18819, RT:33426, PS-28843)

  - cli: Leaf-lists of string type with tailf:cli-range-list-syntax can have
    both integer ranges and string values as part of the same expression,
    e.g. "1-3,t1,t2". The CLI has been fixed in cases where this did not
    work properly.

    (ENG-18800)

  - cli: Presence container with only action children is now considered as
    editable during configuration, as it should be.

    (ENG-18754, RT:32838, PS-28432)

  - cli: When executing "run ..." in configuration mode in a J-style CLI the
    information would not be logged into the audit.log files. This has been
    fixed.

    (ENG-18726, RT:33236, PS-28717)

  - cli: With the new implementation of leaf-list after 'ConfD 6.5', the
    performance of set leaf-list with many instances got much slower in the
    case that there is a when expression inside a non-presence container
    that depends on the leaf-list. This has now been fixed.

    (ENG-18586, RT:32958, PS-28536)

  - cli: The J-Style CLI wouldn't suppress pagination for the pipe-command
    repeat. This has been fixed.

    (ENG-18304, RT:34361, RT:32580, PS-29417, PS-28244)

  - cli: Using the command 'show configuration | display xml' in C-style CLI
    would trigger an internal error. This has been fixed.

    (ENG-18253, RT:32481, PS-28188)

  - cli: XPath parameters to clispec commands would not display properly for
    some XPath expressions. This has been fixed.

    (ENG-17803, RT:31697, PS-27698)

  - cli: The CLI command 'show configuration' would crash with 'internal
    error' in certain cases. This has been fixed.

    (ENG-17745, RT:31685, PS-27651)

  - cli: Behaviour of I-style CLI with regard to usage of "enable" and
    "disable" commands has been made consistent: the "enable" command
    switches from user EXEC mode to privileged EXEC mode, "disable" command
    switches from privileged EXEC mode to user EXEC mode. It is not possible
    to use these commands from config mode, using "do", since it violates
    modes hierarchy.

    (ENG-17588, RT:31452, PS-27487)

  - cli: Handling of hidden actions from clispec, sharing mount point with
    actions from data model has been corrected.

    (ENG-17387, RT:31148, PS-27275)

  - cli: Restricting the amount of possible CLI sessions below the current
    amount of connected sessions using an action callback in an I-style CLI,
    could cause the CLI to crash. This has been fixed.

    (ENG-17215, RT:30920, PS-27169)

  - cli: When sending the ctrl-v escape code to enter a verbatim/quote
    character in the CLI and then sending the paste-buffer the CLI could
    hang. This has been fixed.

    (ENG-16762, RT:32004, RT:30445, PS-27870, PS-10058, SR:683308927)

  - cli: Fixed incorrect case conversion which caused internal error when
    'caseInsensitiveKeys' and 'allowAbbrevKeys' config options are enabled.

    (ENG-16681, RT:28598, PS-9165)

  - cli: Handling of leaves with tailf:cli-drop-node-name in submode has
    been corrected.

    (ENG-16597, RT:30855, RT:29903, PS-27116, PS-9777)

  - cli: A proper error is now returned when the maapi.cli_diff_cmd()
    function is called with invalid transaction id.

    (ENG-16518, RT:28442, PS-9100)

  - cli: The 'help' command now performs pagination correctly, showing all
    the output in pages.

    (ENG-16413, RT:29784, PS-9731)

  - cli: Sometimes when evaluating the most relevant errors to present in
    the CLI the wrong error would be displayed. This has been fixed.

    (ENG-15174, RT:28682, PS-9197)

  - cli: The CLI would not remove duplicates when prompting for a leafref
    leaf value. This has been fixed.

    (ENG-15114, RT:28621, PS-9173)

  - cli: The pipe command 'display json' did not handle filters on keys in
    lists properly, if filtering with a non-existing key, explicit wildcard,
    or implicit wildcard. This has now been fixed.

    (ENG-14211, RT:22197, RT:32661, RT:33275, RT:24525, PS-7096, PS-28316,
    PS-28770, PS-7767)

  - cli: Namespaces that were not exported to any northbound interface were
    still visible in the CLI if they were not rooted at the top level, for
    example elements augmented into an exported namespace. This has been
    fixed.

    (ENG-5723, RT:15205, RT:34221, RT:36502, PS-20874, PS-29339, PS-31582)

  - documentation: Even though 'pyang' is delivered in the product, it is no
    longer supported.
    Thus the related chapter 'The pyang tool' has been removed.
    A reference to external 'pyang' documentation has also been added.

    (ENG-20440)

  - documentation: Corrected supported methods of 'unhide' query param for
    REST API.

    (ENG-20312, RT:30188, PS-9924)

  - documentation: Descriptions of '/confdConfig/cli/trimDefaultShow' and
    '/confdConfig/cli/trimDefaultSave' parameters have been brought in sync
    with User Guide.

    (ENG-20280, RT:35756, PS-30832)

  - documentation: Autogenerated documentation now includes all of the
    exported data types and functions from econfd.erl.

    (ENG-20021, RT:35485, PS-30559)

  - documentation: Fixed a broken link in the HA/API chapter.

    (ENG-19901)

  - documentation: Added reference to the RESTCONF Token authentication in
    the Admin Guide, from the RESTCONF chapter.

    (ENG-19718, RT:35020, PS-30090)

  - documentation: Clarify that the contents of the NETCONF trace is not
    filtered in any way and that it may contain potentially sensitive
    information.

    (ENG-19454)

  - documentation: Default values in confd.conf man page that had diverged
    from the defaults in confd_cfg.yang has been updated to match the YANG
    module.

    (ENG-18716, RT:33048, PS-28570)

  - documentation: Note and README file is added regarding the yang files
    implemented internally.

    (ENG-17782, RT:28371, PS-9077)

  - documentation: Corrected the description of the append_list_entry JSON
    API method.

    (ENG-16220, RT:29003, PS-9349)

  - documentation: Corrected <reset-query> examples in ConfD User Guide.

    (ENG-16138, RT:30106, PS-9885)

  - documentation: A note regarding sorting of the uncommitted rows has been
    added.

    (ENG-15856, RT:28002, PS-8925)

  - documentation: Broken references have been fixed in the User Guide.

    (ENG-14995, RT:28676, PS-26964)

  - java-api: The string representation of a ConfKey is now quoted when it
    contains a % character.

    (ENG-20101)

  - java-api: A bug which caused a disconnect when using synchronous HA
    notifications has been addressed.

    (ENG-19252)

  - java-api: An internal error could occur in some cases when working with
    strings containing unicode characters in the Java API. This has been
    fixed.

    (ENG-18974, RT:33842, RT:33617, PS-29105, PS-28977)

  - java-api: If executing an action from a REST API, and the action
    callback threw an exception, the REST request got an error including the
    stack trace.
    This has been changed so that the stack trace will no longer be
    propagated in this case.

    (ENG-18694, RT:33040, PS-28567, SR:684401755)

  - java-api: When invoking ConfValue.getValueByString() with the path to a
    "leaf-list of enum" or "enum" type node, and a string not matching any
    of the enums, a NullPointerException was thrown.
    Now a MaapiException is given instead, saying that the string-to-enum
    conversion failed instead.

    (ENG-18645, RT:33000, PS-28608)

  - java-api: Calling NavuNode.getName() on root caused a
    ArrayIndexOutOfBoundsException to be thrown. This has been fixed.

    (ENG-18317, RT:32563, PS-28254)

  - java-api: A NullPointerException was thrown when reading empty oper data
    list. This has been fixed.

    (ENG-16598)

  - java-api: HaException sometimes gave a misleading message and contained
    its error code inside the message string. The message has been fixed and
    the error code is now available through the getErrorCode() method.

    (ENG-14103, RT:30204, PS-9936)

  - json-rpc: An invalid JSON-RPC payload could cause an internal error.
    This has been fixed.

    (ENG-20921)

  - json-rpc: The format of empty children in 'case' for 'get_schema' method
    has been corrected. Empty children should be an empty array - [] instead
    of the empty string "".

    (ENG-20453)

  - json-rpc: The get_leafref_values method in JSON-RPC for leafrefs in list
    keys (with multiple keys) would not give the expected response. This has
    been fixed.

    (ENG-19924, RT:35304, PS-30378)

  - json-rpc: Lists were returned on the root node of the result, if the
    lists parent container was otherwise empty. This has been fixed.

    (ENG-19913)

  - json-rpc: Restrict confirm-commit only to the context of;
    1. Candidate datastore, and
    2. running/access set to writable-through-candidate, and
    3. configure-mode set to exclusive or shared

    (ENG-18978, RT:30912, PS-27126)

  - json-rpc: When an AAA rule <rpc-name>*<rpc-name> was set to permit a
    user or group to execute any RPC, JSON-RPC invocation still resulted in
    "Permission denied". This has been corrected.

    (ENG-18723, RT:33046, PS-28701)

  - netconf: When a SSH NETCONF client was abruptly killed, the TCP
    connection was not closed properly. This has been fixed.

    (ENG-19832, RT:34681, RT:35369, PS-29747, PS-30443)

  - netconf: The session number is now present again in the NETCONF trace
    file.

    (ENG-19533, RT:34772, PS-29839)

  - netconf: When a TCP NETCONF client was abruptly killed, the NETCONF
    session was not removed properly. This has been fixed.

    (ENG-19442, RT:34681, RT:35369, RT:34523, PS-29747, PS-30443, PS-29586)

  - netconf: A create/delete operation on a list key is now allowed only if
    the parent (list-) level is also a create/delete operation.

    (ENG-19162, RT:33880, PS-29126)

  - netconf: When an edit-config was received with an element with operation
    "remove", and the element had child elements in the payload, the NETCONF
    server would return a 'data-missing' error. This bug has been fixed.

    (ENG-19132, RT:33881, PS-29127)

  - netconf: If the NETCONF server received a message with bad framing
    according to RFC 6242, it would in some cases not close the session.
    This bug has been fixed.

    (ENG-18963, RT:33522, PS-28924)

  - netconf: In some cases fragmented data wasn't handled correctly which
    could cause a NETCONF session to hang unresponsive. This has been fixed.

    (ENG-18595, RT:32891, PS-28514)

  - netconf: When a NETCONF notification subscription was set up, without
    stopTime, or with a stopTime in the future, and if a new notification
    was generated at the exact point in time when the replay server had
    finished traversing the replay store files, but had not yet turned the
    stream out of "replay mode", the new notification was stored in the
    replay store without being sent to the subscriber. This has been fixed.

    (ENG-15844, RT:27970, RT:28566, PS-8913, PS-26962)

  - netconf: If an XPath filter selects nodes in an user-ordered list, the
    selected list entries were not always returned in the right order.  This
    bug has been fixed.

    (ENG-3953, RT:20052, PS-6196)

  - python-api: Accessing 'uinfo' and 'groups' from a
    _confd.dp.AuthorizationCtxRef, or 'groups', 'logno' and 'reason' from a
    _confd.dp.AuthCtxRef no longer crashes the Python VM.

    (ENG-20338, RT:35916, PS-30994)

  - python-api: Converting paths to string now allows for longer strings
    than 2048 characters.

    (ENG-20329, RT:35357, PS-30431)

  - python-api: Subscriber instances without should_post_iterate() now run
    post_iterate() as the documentation states.

    (ENG-20194)

  - python-api: When using maagic.Action to call an action the maagic.Action
    class could, in some cases, fail to convert the resulting tag value
    array to an in-memory maagic object. This has been fixed.

    (ENG-20091)

  - python-api: Multiple Python 3 specific memory leaks plugged.

    (ENG-19936, RT:35241, PS-30312)

  - python-api: _confd.pp_kpath(), _confd.pp_kpath_len() and
    _confd.xpath_pp_kpath() no longer truncate paths longer than 2048 bytes.

    (ENG-19933, RT:35357, PS-30431)

  - python-api: The confd.dp.Action.action decorator now reuses the IP
    address and path arguments in addition to the previous port argument
    when connecting through MAAPI.

    (ENG-19752)

  - python-api: _confd.Value.as_decimal64() no longer truncates the returned
    value to 32bit.

    (ENG-19680, RT:34950, PS-30018)

  - python-api: If the cb_move_after() data callback was implemented,
    calling maapi.Maapi.move_ordered() or maagic.List.move() with MOVE_AFTER
    or MOVE_BEFORE the process would hang indefinitely. This has been fixed.

    (ENG-19536, RT:34096, PS-29254)

  - python-api: When reading a non-empty leaf with maagic, an unnecessary
    get_elem() call was made to the data providers. This has been fixed.

    (ENG-19267, RT:34298, PS-29385)

  - python-api: An action callback handler implemented using the
    confd.dp.Action.action decorator, called without transaction, did
    unnecessarily start a new user session. This has been fixed.

    (ENG-19228, RT:34302, PS-29388)

  - python-api: The 'dp.Action.action' decorator didn't always use the
    correct port when connecting to ConfD. This has been fixed.

    (ENG-18895, RT:33542, PS-28927)

  - rest-api: Strings occurring in error messages in JSON format were not
    properly quoted when they contained special characters like newline and
    linefeed. This has been fixed.

    (ENG-18865, RT:32936, PS-28509, SR:684368961)

  - rest-api: Do not allow actions defined under non existent list entries
    to be invoked.

    (ENG-18617, RT:33040, PS-28567, SR:684401755)

  - rest-api: Changed so that we do not invoke unhide callback for action.

    (ENG-16585, RT:30188, PS-9924)

  - rest-api: Rollback functionality for the candidate datastore in the REST
    API did not work in some cases. This has been fixed.

    (ENG-16088, RT:28578, PS-9155)

  - restconf: Fields of YANG Patch does not have to be in any specific
    order.

    (ENG-20699)

  - restconf: The RESTCONF performance has been improved compared to the
    corresponding NETCONF operation.

    (ENG-20674, RT:36348, PS-31427)

  - restconf: Rollbacks were not possible with running
    writable-through-candidate. This has been fixed.

    (ENG-20553)

  - restconf: REST/RESTCONF query failed to produce JSON output.

    (ENG-20076, RT:35543, PS-30618)

  - restconf: Spurious XML tags, belonging to empty containers, could occur
    in the output of a query. This has been fixed.

    (ENG-20075, RT:35543, PS-30618, SR:685700044)

  - restconf: Now a YANG Patch can handle payload values where key is
    missing. See also correction in ENG-20699.

    (ENG-19899, RT:35280, PS-30352)

  - restconf: Disallow DELETE operation on list level (in accordance with
    RFC 8040).

    (ENG-19750, RT:35088, PS-30158)

  - restconf: When retrieving 'config false' data, any enclosing list key is
    now also included in the replied content.

    (ENG-19166, RT:34064, PS-29321)

  - restconf: Improved user session handling and AAA checks for RESTCONF
    Event Notifications.

    (ENG-19139)

  - restconf: Fixed timeout problem when stopping ConfD while having open
    RESTCONF event notification connections.

    (ENG-18538)

  - restconf: Lost a closing tag if a data provider that did not
    consistently return the first element, when requested repeatedly, was
    used.

    (ENG-18505, RT:32504, PS-28215)

  - restconf: Streaming connections are now terminated gracefully when a
    content generator process exits abnormally.

    (ENG-18350, RT:33324, RT:32596, PS-28780, PS-28319)

  - restconf: Corrected the validation of the "content" query parameter
    which is only valid on data and datastore resources.

    (ENG-14099)

  - restconf: Refactored handling parameters when updating/creating items
    via RESTCONF. Now if an element has value null/"null"/[null] it is no
    longer ignored by the system, and instead processed correctly, with both
    existence and type checks. Making the system respond with correct
    response codes.

    (ENG-7171, RT:30230, PS-9947)

  - snmp-agent: If an SNMPv2-Trap-PDU or InformRequest-PDU with proper
    credentials was received by the SNMP Agent, it would permanently occupy
    a space in a 32 item long queue. I.e. if more than 32 such PDUs were
    received, the Agent would become non-responsive. The Agent can handle
    this now.

    (ENG-19554, RT:34733, PS-29800)

  - snmp-agent: Removed stdout printouts on SNMP logs.

    (ENG-18896, RT:33047, PS-28933)

  - snmp-agent: While processing getnext requests, the SNMP agent would
    invoke data providers several times on the same keypath, for keypaths
    having no value in nested lists. This has been fixed.

    (ENG-18683, RT:32236, PS-28029)

  - toolchain: The YANG compiler allowed that 'if-feature' evaluation
    removed all 'enum' or 'bit' statements in an 'enumeration' or 'bits'
    type definition, even though the resulting module was invalid. This has
    been fixed - now an error is generated in this case.

    (ENG-19339, RT:34505, PS-29568)

  - toolchain: The YANG compiler would allow a deviation to remove a leaf
    that was a list key, even though the deviated module was invalid (since
    the 'key' statement specified a leaf that didn't exist anymore) and
    caused a crash at load time. This has been fixed - now such deviations
    are rejected by the compiler.

    (ENG-19122, RT:34072, PS-29230)

  - toolchain: The tailf:display-when statement that is valid for
    tailf:action was not accepted by the compiler for YANG 1.1 'action'.
    This has been fixed.

    (ENG-19047, RT:33864, PS-29110)

  - toolchain: The order of union member types was reversed when compiling a
    YANG-1.1 module, which could cause incorrect member selection when the
    type definitions overlapped. This has been fixed.

    (ENG-19017, RT:33701, PS-29030)

  - web-server: An invalid port number in the HTTP Host header, sent by a
    client, could cause an internal error. This has been fixed.

    (ENG-20941)

  - web-server: X-Frame-Options was missing for files served from a custom
    login directory even if enabled. This has been fixed.

    (ENG-19450, RT:34650, PS-29716)

  - web-server: If the ChaCha20-Poly1305 cipher suite is available from
    system OpenSSL - it is not picked by WebUI for use, due to
    implementation incompatibilities between OpenSSL and OTP.

    (ENG-18745)

  - web-server: Static resource serving now verifies the HTTP method used.

    (ENG-18596, RT:32391, PS-28122)

  - xpath: derived-from() and derived-from-or-self() now handles identity
    strings without a prefix.

    (ENG-20204)
