<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
      
      <title>Error Recovery with Commit Queue -  - NSO 5.7 User Guide</title>
      <meta name="generator" content="DocBook XSL Stylesheets V1.78.1" />
      <link rel="home" href="index.html" title="NSO 5.7 User Guide" />
      <link rel="up" href="user_guide.devicemanager.commit-queue.html" title="Commit Queue" />
      <link rel="prev" href="ch03s23s04.html" title="Configuring Commit Queue in a Cluster Environment" />
      <link rel="next" href="ch03s23s06.html" title="Commit Queue Tuning" />
      <meta xmlns="" name="Section-title" content="Error Recovery with Commit Queue" /><script xmlns="" type="text/javascript">
      //The id for tree cookie
      var treeCookieId = "treeview-10290";
      var language = "en";
      var w = new Object();
      //Localization
      txt_filesfound = 'Results';
      txt_enter_at_least_1_char = "You must enter at least one character.";
      txt_browser_not_supported = "JavaScript is disabled on your browser. Please enable JavaScript to enjoy all the features of this site.";
      txt_please_wait = "Please wait. Search in progress...";
      txt_results_for = "Results for: ";
    </script><link xmlns="" rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
      <link xmlns="" rel="stylesheet" type="text/css" href="common/css/positioning.css" />
      <link xmlns="" rel="stylesheet" type="text/css" href="common/jquery/theme-redmond/jquery-ui-1.8.2.custom.css" />
      <link xmlns="" rel="stylesheet" type="text/css" href="common/jquery/treeview/jquery.treeview.css" /><style xmlns="" type="text/css">
      
      #noscript{
      font-weight:bold;
      background-color: #55AA55;
      font-weight: bold;
      height: 25spx;
      z-index: 3000;
      top:0px;
      width:100%;
      position: relative;
      border-bottom: solid 5px black;
      text-align:center;
      color: white;
      }
      
      input {
      margin-bottom: 5px;
      margin-top: 2px;
      }
      .folder {
      display: block;
      height: 22px;
      padding-left: 20px;
      background: transparent url(common/jquery/treeview/images/folder.gif) 0 0px no-repeat;
      }
      span.contentsTab {
      padding-left: 20px;
      background: url(common/images/toc-icon.png) no-repeat 0 center;
      }
      span.searchTab {
      padding-left: 20px;
      background: url(common/images/search-icon.png) no-repeat 0 center;
      }
      
      /* Overide jquery treeview's defaults for ul. */
      .treeview ul {
      background-color: transparent;
      margin-top: 4px;
      }		
      #webhelp-currentid {
      /* background-color: #D8D8D8 !important; */
      background-color: #D8D8D8;
      }
      .treeview .hover { color: black; }
      .filetree li span a { text-decoration: none; font-size: 12px; color: #517291; }
      
      /* Override jquery-ui's default css customizations. These are supposed to take precedence over those.*/
      .ui-widget-content {
      border: 0px; 
      background: none; 
      color: none;     
      }
      .ui-widget-header {
      color: #e9e8e9;
      border-left: 1px solid #e5e5e5;
      border-right: 1px solid #e5e5e5;
      border-bottom: 1px solid #bbc4c5;
      border-top: 4px solid #e5e5e5;
      border: medium none;
      background: #F4F4F4; /* old browsers */
      background: -moz-linear-gradient(top, #F4F4F4 0%, #E6E4E5 100%); /* firefox */
      background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#F4F4F4), color-stop(100%,#E6E4E5)); /* webkit */    
      font-weight: none;
      }
      .ui-widget-header a { color: none; }
      .ui-state-default, .ui-widget-content .ui-state-default, .ui-widget-header .ui-state-default { 
      border: none; background: none; font-weight: none; color: none; }
      .ui-state-default a, .ui-state-default a:link, .ui-state-default a:visited { color: black; text-decoration: none; }
      .ui-state-hover, .ui-widget-content .ui-state-hover, .ui-widget-header .ui-state-hover, .ui-state-focus, .ui-widget-content .ui-state-focus, .ui-widget-header .ui-state-focus { border: none; background: none; font-weight: none; color: none; }
      
      .ui-state-active, .ui-widget-content .ui-state-active, .ui-widget-header .ui-state-active { border: none; background: none; font-weight: none; color: none; }
      .ui-state-active a, .ui-state-active a:link, .ui-state-active a:visited { 
      color: black; text-decoration: none; 	
      background: #C6C6C6; /* old browsers */
      background: -moz-linear-gradient(top, #C6C6C6 0%, #D8D8D8 100%); /* firefox */
      background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#C6C6C6), color-stop(100%,#D8D8D8)); /* webkit */
      -webkit-border-radius:15px; -moz-border-radius:10px;
      border: 1px solid #f1f1f1;
      }    
      .ui-corner-all { border-radius: 0 0 0 0; }
      
      .ui-tabs { padding: .2em;}
      .ui-tabs .ui-tabs-nav li { top: 0px; margin: -2px 0 1px; text-transform: uppercase; font-size: 10.5px;}
      .ui-tabs .ui-tabs-nav li a { padding: .25em 2em .25em 1em; margin: .5em; text-shadow: 0 1px 0 rgba(255,255,255,.5); }
      /**
      *	Basic Layout Theme
      * 
      *	This theme uses the default layout class-names for all classes
      *	Add any 'custom class-names', from options: paneClass, resizerClass, togglerClass
      */
      
      .ui-layout-pane { /* all 'panes' */ 
      background: #FFF; 
      border: 1px solid #BBB; 
      padding: 05x; 
      overflow: auto;
      } 
      
      .ui-layout-resizer { /* all 'resizer-bars' */ 
      background: #DDD; 
      top:100px
      } 
      
      .ui-layout-toggler { /* all 'toggler-buttons' */ 
      background: #AAA; 
      } 
      
    </style>
      <!--[if IE]>
	<link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
	<![endif]--><script xmlns="" type="text/javascript" src="common/browserDetect.js">
         <!----></script><script xmlns="" type="text/javascript" src="common/jquery/jquery-1.7.2.min.js">
         <!----></script><script xmlns="" type="text/javascript" src="common/jquery/jquery.ui.all.js">
         <!----></script><script xmlns="" type="text/javascript" src="common/jquery/jquery.cookie.js">
         <!----></script><script xmlns="" type="text/javascript" src="common/jquery/treeview/jquery.treeview.min.js">
         <!----></script><script xmlns="" type="text/javascript" src="common/jquery/layout/jquery.layout.js">
         <!----></script><style type="text/css">
      
      #header {
      /* background: url("../images/header-bg.png") scroll top left repeat-x #4d8c83; */
      background: transparent;
      }
      #leftnavigation {
      /* background-color: #ededed!important; */
      background-color: transparent;
      }
      #navheader {
      visibility: hidden;
      }
      #webhelp-currentid {
      /* background-color: #D8D8D8 !important; */
      background-color: #FFFFFF; /*but must be changed in main.js as well*/
      }
      .filetree span.file {
      /* background: url(images/file.gif) 0 0 no-repeat; */
      background: initial;
      }
      .filetree span.folder, .filetree span.file {
      padding: 1px 0 1px 7px;
      display: block;
      }

      /* borrowed from cisco: clientlib.css */
      .footer {
      margin: 28px 30px 0 15px;
      font-size: 80%;
      line-height: 120%;
      border-top: 1px solid #ccc;
      padding-top: 7px;
      color: #999;
      }
      .footer #footer-legal{display:inline;padding-bottom:18px}
      #framework-footer{margin:0;padding:0 0 15px 0;min-width:900px;width:100%}
      .footer a,.footer a:visited{color:#999}

      /* from ccimr.css */
      a:active  { color: #3366CC}
      a:hover   { color: #3366CC}
      a:link    { color: #3366CC}
      a:visited { color: #3366CC}

      #header img {
      float: left;
      margin-left: 20px;
      margin-top: 0px;
      }

      #header h1 {
      color: #336666;
      margin-top: 4px;
      }
      #content h1, #content h2 {
      color: #336666;
      }
      .title {
      color: #336666;
      }
      p, pre {
      margin-left: 0.1in;
      }
      p, ul, ol, li {
        font-size: 95%;
        font-family: Arial, Helvetica, sans-serif;
        margin-top: 1px;
      }
      body {
        font: 80.5% Arial, Helvetica, sans-serif;
      }
      ol {
      display: block;
      list-style-type: decimal;
      -webkit-margin-before: 1em;
      -webkit-margin-after: 1em;
      -webkit-margin-start: 0px;
      -webkit-margin-end: 0px;
      -webkit-padding-start: 40px;
      border: 1;
      }
    </style></head>
   <body>
      <noscript>
         <div id="noscript">JavaScript is disabled on your browser. Please enable JavaScript to enjoy all the features of this site.</div>
      </noscript>
      <div id="header"><a href="index.html"><img style="margin-right: 2px; width: 110; height: 73; padding-right: 25px; padding-top: 8px" align="right" src="common/images/logo.gif" alt="Cisco Systems, Inc." /></a><h1>NSO 5.7 User Guide<br />Commit Queue
         </h1>
         <div id="navheader">
            <!---->
            <table class="navLinks">
               <tr>
                  <td><a id="showHideButton" href="#" onclick="myLayout.toggle('west')" class="pointLeft" tabindex="5" title="Hide TOC tree">Sidebar
                                                    </a></td>
                  <td><a accesskey="p" class="navLinkPrevious" tabindex="5" href="ch03s23s04.html">Prev</a>
                                                             |
                                                             <a accesskey="u" class="navLinkUp" tabindex="5" href="user_guide.devicemanager.commit-queue.html">Up</a>
                                                         |
                                                         <a accesskey="n" class="navLinkNext" tabindex="5" href="ch03s23s06.html">Next</a></td>
               </tr>
            </table>
         </div>
      </div>
      <div id="content">
         <div class="sect2">
            <div xmlns="" class="titlepage">
               <div>
                  <div>
                     <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="d0e5946"></a>Error Recovery with Commit Queue
                     </h3>
                  </div>
               </div>
            </div>
            <p>
                       The goal of the commit queue is to increase the transactional
                       throughput of NSO while keeping an eventual consistency
                       view of the database. This means no matter if changes
                       committed through the commit queue originate as pure device
                       changes or as the effect of service manipulations the effects
                       on the network should eventually be the same as if performed
                       without a commit queue no matter if they succeed or not. This
                       should be applicable to a single NSO node as well as
                       NSO nodes in an LSA cluster.
                     
            </p>
            <p>
                       Depending on the selected <code class="sgmltag-element">error-option</code>
                       NSO will store the reverse of the original transaction
                       to be able to undo the transaction changes and get back
                       to the previous state. This data is stored in the
                       <code class="sgmltag-element">/ncs:devices/commit-queue/completed</code> tree
                       from where it can be viewed and invoked with the
                       <span class="command"><strong>rollback</strong></span> action. When invoked the data will
                       be removed.
                     
            </p>
            <div class="example"><a id="user_guide.devicemanager.commit-queue-completed-items"></a><p class="title"><strong>Example 25. Viewing completed queue items</strong></p>
               <div class="example-contents"><pre class="screen">ncs# <strong class="userinput"><code>show devices commit-queue completed | notab</code></strong>
devices commit-queue completed queue-item 9494446997
 when      2015-02-09T16:48:17.915+00:00
 succeeded false
 devices   [ ce0 ce1 ce2 ]
 failed ce0
  reason "Failed to connect to device ce0: closed"
devices commit-queue completed queue-item 9494530158
 when      2015-02-09T16:48:17.915+00:00
 succeeded false
 devices   [ ce0 ]
 failed ce0
  reason "Deleted by user"</pre></div>
            </div><br class="example-break" /><p>
                       The error option can be configured under
                       <code class="code">/ncs:devices/global-settings/commit-queue/error-option</code>.
                       Possible values are: <span class="emphasis"><em>continue-on-error</em></span>,
                       <span class="emphasis"><em>rollback-on-error</em></span> and
                       <span class="emphasis"><em>stop-on-error</em></span>. The
                       <span class="emphasis"><em>continue-on-error</em></span> value means that the
                       commit queue will continue on errors. No rollback data will be
                       created. The <span class="emphasis"><em>rollback-on-error</em></span> value means that
                       the commit queue item will roll back on errors. The commit queue
                       will place a lock on the failed queue item, thus blocking
                       other queue items with overlapping devices to be executed.
                       The <span class="command"><strong>rollback</strong></span> action will then automatically be
                       invoked when the queue item has finished its execution.
                       The lock will be removed as part of the rollback.
                       The <span class="emphasis"><em>stop-on-error</em></span> means that the commit
                       queue will place a lock on the failed queue item, thus blocking
                       other queue items with overlapping devices to be executed.
                       The lock must then either manually be released when the error
                       is fixed or the <span class="command"><strong>rollback</strong></span> action under
                       <code class="sgmltag-element">/devices/commit-queue/completed</code> be invoked.
                       The <span class="command"><strong>rollback</strong></span> action is as:
                       
            </p>
            <div class="example"><a id="user_guide.devicemanager.commit-queue-rollback"></a><p class="title"><strong>Example 26. Execute rollback action</strong></p>
               <div class="example-contents"><pre class="screen">ncs(config)# <strong class="userinput"><code>devices commit-queue completed queue-item 9494446997 rollback</code></strong></pre></div>
            </div>
            <p><br class="example-break" />
                       The error option can also be given as a commit parameter.
                     
            </p>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
               <h3 class="title">Note</h3>
               <p>
                            To guarantee service integrity NSO checks for
                            overlapping service or device modifications against the items
                            in the commit queue and returns an error if such exists.
                            If a service instance does a shared set on the same data as
                            a service instance in the queue actually changed,
                            the reference count will be increased but
                            no actual change is pushed to the device(s). This will
                            give a false positive that the change is actually deployed
                            in the network. The <span class="emphasis"><em>rollback-on-error</em></span> and
                            <span class="emphasis"><em>stop-on-error</em></span> error
                            options will automatically create a queue lock on the
                            involved services and devices to prevent such a case.
                          
               </p>
            </div>
            <p>
                       In a clustered environment, different parts of the resulting
                       configuration change set will end up on different lower nodes.
                       This means on some nodes the queue item could succeed and on
                       others it could not.
                     
            </p>
            <p>
                       The error option in a cluster environment will originate on
                       the upper node. The reverse of the original transaction will be
                       committed on this node and propagated through the cluster down
                       to the lower nodes. The net effect of this is the state of the
                       network will be the same as before the original change.
                     
            </p>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
               <h3 class="title">Note</h3>
               <p>
                            As the error option in a cluster environment will originate
                            on the upper node, any configuration on the lower nodes will
                            be meaningless.
                          
               </p>
            </div>
            <p>
                       When NSO is recovering from a failed commit, the
                       rollback data of the failed queue items in the cluster, is
                       applied and committed through the commit queue. In the
                       rollback the no-networking flag will be set on the commits
                       towards the failed lower nodes or devices to get CDB
                       consistent with the network. Towards the successful nodes or
                       devices the commit is done as before. This is what the
                       <code class="sgmltag-element">rollback</code> action in
                       <code class="code">/ncs:devices/commit-queue/completed/queue-item</code>
                       does.
                     
            </p>
            <div class="example"><a id="user_guide.devicemanager.commit-queue.error-recovery.single-node"></a><p class="title"><strong>Example 27. Error recovery in a single node deployment</strong></p>
               <div class="example-contents">
                  <div class="figure"><a id="d0e6041"></a><p class="title"><strong>Figure 2. </strong></p>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="319">
                              <tr>
                                 <td align="center"><img src="pics/dm-cq-error-recovery-single-node1.png" align="middle" width="319" /></td>
                              </tr>
                           </table>
                        </div>
                     </div>
                  </div><br class="figure-break" /><div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           <p>
                                            TR1; service <span class="emphasis"><em>s1</em></span> creates
                                            <span class="emphasis"><em>ce0:a</em></span> and <span class="emphasis"><em>ce1:b</em></span>.
                                            The nodes <span class="emphasis"><em>a</em></span> and <span class="emphasis"><em>b</em></span>
                                            are created in CDB. In the changes of the queue item,
                                            CQ1, <span class="emphasis"><em>a</em></span> and <span class="emphasis"><em>b</em></span>
                                            are created.
                                          
                           </p>
                        </li>
                        <li class="listitem">
                           <p>
                                            TR2; service <span class="emphasis"><em>s2</em></span> creates
                                            <span class="emphasis"><em>ce1:c</em></span> and <span class="emphasis"><em>ce2:d</em></span>.
                                            The nodes <span class="emphasis"><em>c</em></span> and
                                            <span class="emphasis"><em>d</em></span> are created in CDB. In the
                                            changes of the queue item, CQ2, <span class="emphasis"><em>c</em></span>
                                            and <span class="emphasis"><em>d</em></span> are created.
                                          
                           </p>
                        </li>
                        <li class="listitem">
                           <p>
                                            The queue item from TR1, CQ1, starts to execute. The
                                            node <span class="emphasis"><em>a</em></span> cannot be created on the
                                            device. The node <span class="emphasis"><em>b</em></span> was
                                            created on the device but that change is reverted as
                                            <span class="emphasis"><em>a</em></span> failed to be created.
                                          
                           </p>
                        </li>
                     </ol>
                  </div>
                  <div class="figure"><a id="d0e6106"></a><p class="title"><strong>Figure 3. </strong></p>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="319">
                              <tr>
                                 <td align="center"><img src="pics/dm-cq-error-recovery-single-node2.png" align="middle" width="319" /></td>
                              </tr>
                           </table>
                        </div>
                     </div>
                  </div><br class="figure-break" /><div class="orderedlist">
                     <ol class="orderedlist" start="4" type="1">
                        <li class="listitem">
                           <p>
                                            The reverse of TR1, rollback of CQ1, TR3, is committed.
                                          
                           </p>
                        </li>
                        <li class="listitem">
                           <p>
                                            TR3; service <span class="emphasis"><em>s1</em></span> is applied with the
                                            old parameters. Thus the effect of TR1 is
                                            reverted. Nothing needs to be pushed towards the
                                            network, so no queue item is created.
                                          
                           </p>
                        </li>
                        <li class="listitem">
                           <p>
                                            TR2; as the queue item from TR2, CQ2, is not the same
                                            service instance and has no overlapping data on the
                                            <span class="emphasis"><em>ce1</em></span> device, this queue item
                                            executes as normal.
                                          
                           </p>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><br class="example-break" /><div class="example"><a id="user_guide.devicemanager.commit-queue.error-recovery.lsa"></a><p class="title"><strong>Example 28. Error recovery in an LSA cluster</strong></p>
               <div class="example-contents">
                  <div class="figure"><a id="d0e6129"></a><p class="title"><strong>Figure 4. </strong></p>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="496">
                              <tr>
                                 <td align="center"><img src="pics/dm-cq-error-recovery-lsa1.png" align="middle" width="496" /></td>
                              </tr>
                           </table>
                        </div>
                     </div>
                  </div><br class="figure-break" /><div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           <p>
                                            NSO1:TR1; service <span class="emphasis"><em>s1</em></span> dispatches the
                                            service to NSO2 and NSO3 through the queue item
                                            NSO1:CQ1. In the changes of NSO1:CQ1,
                                            NSO2:<span class="emphasis"><em>s1</em></span> and
                                            NSO3:<span class="emphasis"><em>s1</em></span> are created.
                                          
                           </p>
                        </li>
                        <li class="listitem">
                           <p>
                                            NSO1:TR2; service <span class="emphasis"><em>s2</em></span> dispatches the
                                            service to NSO2 through the queue item NSO1:CQ2. In the
                                            changes of NSO1:CQ2, NSO2:<span class="emphasis"><em>s2</em></span> is
                                            created.
                                          
                           </p>
                        </li>
                        <li class="listitem">
                           <p>
                                            The queue item from NSO2:TR1, NSO2:CQ1, starts to execute. The
                                            node <span class="emphasis"><em>a</em></span> cannot be created on the
                                            device. The node <span class="emphasis"><em>b</em></span> was
                                            created on the device but that change is reverted as
                                            <span class="emphasis"><em>a</em></span> failed to be created.
                                          
                           </p>
                        </li>
                        <li class="listitem">
                           <p>
                                            The queue item from NSO3:TR1, NSO3:CQ1, starts to
                                            execute. The changes in the queue item is committed
                                            successfully to the network.
                                          
                           </p>
                        </li>
                     </ol>
                  </div>
                  <div class="figure"><a id="d0e6170"></a><p class="title"><strong>Figure 5. </strong></p>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="496">
                              <tr>
                                 <td align="center"><img src="pics/dm-cq-error-recovery-lsa2.png" align="middle" width="496" /></td>
                              </tr>
                           </table>
                        </div>
                     </div>
                  </div><br class="figure-break" /><div class="orderedlist">
                     <ol class="orderedlist" start="5" type="1">
                        <li class="listitem">
                           <p>
                                            The reverse of TR1, rollback of CQ1, TR3, is committed
                                            on all nodes part of TR1 that failed.
                                          
                           </p>
                        </li>
                        <li class="listitem">
                           <p>
                                            NSO2:TR3; service <span class="emphasis"><em>s1</em></span> is applied
                                            with the old parameters. Thus
                                            the effect of NSO2:TR1 is reverted. Nothing needs to be
                                            pushed towards the network, so no queue item is created.
                                          
                           </p>
                        </li>
                        <li class="listitem">
                           <p>
                                            NSO1:TR3; service <span class="emphasis"><em>s1</em></span> is applied
                                            with the old parameters. Thus
                                            the effect of NSO1:TR1 is reverted. A queue item is
                                            created to push the transaction changes to the lower
                                            nodes that didn't fail.
                                          
                           </p>
                        </li>
                        <li class="listitem">
                           <p>
                                            NSO3:TR3; service <span class="emphasis"><em>s1</em></span> is applied
                                            with the old parameters. Thus the effect of NSO3:TR1
                                            is reverted. Since the changes in the
                                            queue item NSO3:CQ1 was successfully committed to the
                                            network a new queue item NSO3:CQ3 is created to revert
                                            those changes.
                                          
                           </p>
                        </li>
                     </ol>
                  </div>
               </div>
            </div><br class="example-break" /><p>
                       If for some reason the rollback transaction would fail
                       there are, depending on the failure, different techniques
                       to reconcile the services involved:
                       
            </p>
            <div class="itemizedlist">
               <ul class="itemizedlist" style="list-style-type: disc; ">
                  <li class="listitem">
                     <p>
                                      Make sure the commit queue is blocked to not interfere
                                      with the error recovery procedure.
                                      Do a sync-from on the non-completed device(s) and then
                                      re-deploy the failed service(s) with the
                                      <code class="sgmltag-element">reconcile</code> option to reconcile original data,
                                      i.e., take control of that data. This option
                                      acknowledges other services controlling the same data. The
                                      reference count will indicate how many services control the
                                      data. Release any queue lock that was created.
                                    
                     </p>
                  </li>
                  <li class="listitem">
                     <p>
                                      Make sure the commit queue is blocked to not interfere
                                      with the error recovery procedure.
                                      Use un-deploy with the no-networking option on the
                                      service and then do sync-from on the non-completed
                                      device(s). Make sure the error is fixed and then
                                      re-deploy the failed service(s) with the
                                      <code class="sgmltag-element">reconcile</code> option. Release any queue lock
                                      that was created.
                                    
                     </p>
                  </li>
               </ul>
            </div>
            <p>
                     
            </p>
         </div><script type="text/javascript" src="common/main.js">
            <!----></script><script type="text/javascript" src="common/splitterInit.js">
            <!----></script><div class="footer" id="footer-legal">
            <div class="footer-legal framework-footer-cq">
               <div id="framework-footer">
                  <div id="footer-legal"><a href="http://www.cisco.com/web/siteassets/legal/terms_condition.html">Terms &amp; Conditions</a> |
                                 <a href="http://www.cisco.com/web/siteassets/legal/privacy.html">Privacy Statement</a> |
                                 <a href="http://www.cisco.com/web/siteassets/legal/privacy.html#cookies">Cookie Policy</a> |
                                 <a href="http://www.cisco.com/web/siteassets/legal/trademark.html">Trademarks</a></div>
               </div>
            </div>
         </div>
      </div>
      <div id="sidebar">
         <div id="leftnavigation" style="padding-top:3px;">
            <div id="tabs">
               <ul style="visibility: hidden;"></ul>
               <div id="treeDiv"><img src="common/images/loading.gif" alt="loading table of contents..." id="tocLoading" style="display:block;" /><div id="ulTreeDiv" style="display:none">
                     <ul id="tree" class="filetree">
                        <li><span class="file"><a href="ncs.ug.introduction.html" tabindex="1">NSO Introduction</a></span><ul>
                              <li><span class="file"><a href="ch01s01.html" tabindex="1">
                                           The Orchestration Challenge</a></span></li>
                              <li><span class="file"><a href="ch01s02.html" tabindex="1">
                                           How NSO Addresses the Orchestration Challenge</a></span></li>
                              <li><span class="file"><a href="ch01s03.html" tabindex="1">High-Availability and Clustering</a></span></li>
                           </ul>
                        </li>
                        <li><span class="file"><a href="ug.ncs.cli.html" tabindex="1">The NSO CLI </a></span><ul>
                              <li><span class="file"><a href="ch02s01.html" tabindex="1">CLI Quick Start</a></span></li>
                              <li><span class="file"><a href="ch02s02.html" tabindex="1">Overview</a></span><ul>
                                    <li><span class="file"><a href="ch02s02s01.html" tabindex="1">Two CLI modes</a></span></li>
                                    <li><span class="file"><a href="ch02s02s02.html" tabindex="1">Operational mode</a></span></li>
                                    <li><span class="file"><a href="ch02s02s03.html" tabindex="1">Configure mode</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ch02s03.html" tabindex="1">Starting the CLI</a></span><ul>
                                    <li><span class="file"><a href="ch02s03s01.html" tabindex="1">Basics</a></span></li>
                                    <li><span class="file"><a href="ch02s03s02.html" tabindex="1">Two CLI styles</a></span></li>
                                    <li><span class="file"><a href="ch02s03s03.html" tabindex="1">Starting the CLI in an overloaded system</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ch02s04.html" tabindex="1">Modifying the configuration</a></span></li>
                              <li><span class="file"><a href="ch02s05.html" tabindex="1">Command output processing</a></span><ul>
                                    <li><span class="file"><a href="ch02s05s01.html" tabindex="1">Count the Number of Lines in the Output</a></span></li>
                                    <li><span class="file"><a href="ch02s05s02.html" tabindex="1">Search for a String in the Output</a></span></li>
                                    <li><span class="file"><a href="ch02s05s03.html" tabindex="1">Saving the Output to a File</a></span></li>
                                    <li><span class="file"><a href="ug.ncs.cli.regexp.html" tabindex="1">Regular expressions</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ch02s06.html" tabindex="1">Displaying the configuration</a></span></li>
                              <li><span class="file"><a href="ch02s07.html" tabindex="1">Range expressions</a></span></li>
                              <li><span class="file"><a href="ch02s08.html" tabindex="1">Command history</a></span></li>
                              <li><span class="file"><a href="ch02s09.html" tabindex="1">Command line editing</a></span><ul>
                                    <li><span class="file"><a href="ch02s09s01.html" tabindex="1">Moving the cursor:</a></span></li>
                                    <li><span class="file"><a href="ch02s09s02.html" tabindex="1">Delete characters:</a></span></li>
                                    <li><span class="file"><a href="ch02s09s03.html" tabindex="1">Insert recently deleted text:</a></span></li>
                                    <li><span class="file"><a href="ch02s09s04.html" tabindex="1">Display previous command lines:</a></span></li>
                                    <li><span class="file"><a href="ch02s09s05.html" tabindex="1">Capitalization:</a></span></li>
                                    <li><span class="file"><a href="ch02s09s06.html" tabindex="1">Special:</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ch02s10.html" tabindex="1">Using CLI completion</a></span></li>
                              <li><span class="file"><a href="ch02s11.html" tabindex="1">Comments, annotations and tags</a></span></li>
                              <li><span class="file"><a href="ch02s12.html" tabindex="1">CLI messages</a></span></li>
                              <li><span class="file"><a href="ch02s13.html" tabindex="1">ncs.conf settings</a></span></li>
                              <li><span class="file"><a href="ch02s14.html" tabindex="1">CLI Environment</a></span></li>
                              <li><span class="file"><a href="ch02s15.html" tabindex="1">Commands</a></span><ul>
                                    <li><span class="file"><a href="ch02s15s01.html" tabindex="1">Operational mode commands</a></span><ul>
                                          <li><span class="file"><a href="ch02s15s01.html#d0e1850" tabindex="1">Invoke an action</a></span></li>
                                          <li><span class="file"><a href="ch02s15s01.html#d0e1888" tabindex="1">Builtin commands</a></span></li>
                                       </ul>
                                    </li>
                                    <li><span class="file"><a href="ch02s15s02.html" tabindex="1">Configure mode commands</a></span><ul>
                                          <li><span class="file"><a href="ch02s15s02.html#d0e2392" tabindex="1">Configure a value</a></span></li>
                                          <li><span class="file"><a href="ch02s15s02.html#d0e2440" tabindex="1">Builtin commands</a></span></li>
                                       </ul>
                                    </li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ch02s16.html" tabindex="1">Customizing the CLI</a></span><ul>
                                    <li><span class="file"><a href="ch02s16s01.html" tabindex="1">Adding new commands</a></span></li>
                                    <li><span class="file"><a href="ch02s16s02.html" tabindex="1">File access</a></span></li>
                                    <li><span class="file"><a href="ch02s16s03.html" tabindex="1">Help texts</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ch02s17.html" tabindex="1">Quoting and escaping scheme</a></span><ul>
                                    <li><span class="file"><a href="ch02s17s01.html" tabindex="1">Canonical quoting scheme</a></span></li>
                                    <li><span class="file"><a href="ch02s17s02.html" tabindex="1">Escape backslash handling</a></span></li>
                                    <li><span class="file"><a href="ch02s17s03.html" tabindex="1">Octal numbers handling</a></span></li>
                                 </ul>
                              </li>
                           </ul>
                        </li>
                        <li><span class="file"><a href="user_guide.devicemanager.html" tabindex="1">The NSO Device Manager</a></span><ul>
                              <li><span class="file"><a href="user_guide.devicemanager.introduction.html" tabindex="1">Introduction</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.device-tree.html" tabindex="1">The Managed Device Tree</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.ned-packages.html" tabindex="1">The NED Packages</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.starting-ncs.html" tabindex="1">Starting the NSO Daemon</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.sync.html" tabindex="1">Synchronizing Devices</a></span><ul>
                                    <li><span class="file"><a href="ch03s05s01.html" tabindex="1">Partial sync-from</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="user_guide.devicemanager.configuring-devices.html" tabindex="1">Configuring Devices</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.connection-mgmt.html" tabindex="1">Connection Management</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.authgroups.html" tabindex="1">Authentication Groups</a></span><ul>
                                    <li><span class="file"><a href="ch03s08s01.html" tabindex="1">Caveats</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="user_guide.devicemanager.pooling.html" tabindex="1">Device Session Pooling</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.session_limits.html" tabindex="1">Device Session Limits</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.tracing.html" tabindex="1">Tracing Device Communication</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.cheap-synch-check.html" tabindex="1">Checking Device Configuration</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.comparing.html" tabindex="1">Comparing Device Configurations</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.initialize-device.html" tabindex="1">Initialize Device</a></span><ul>
                                    <li><span class="file"><a href="user_guide.devicemanager.initialize-from-other.html" tabindex="1">From other</a></span></li>
                                    <li><span class="file"><a href="user_guide.devicemanager.initialize-with-template.html" tabindex="1">By Template</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ncs.user_guide.devicemanager.device.templates.html" tabindex="1">Device Templates</a></span><ul>
                                    <li><span class="file"><a href="ch03s15s01.html" tabindex="1">Tags</a></span></li>
                                    <li><span class="file"><a href="ch03s15s02.html" tabindex="1">Debug</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="user_guide.devicemanager.state.html" tabindex="1">Oper State and Admin State</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.source.html" tabindex="1">Configuration Source</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.capas.html" tabindex="1">Capabilities, Modules and Revision Management</a></span><ul>
                                    <li><span class="file"><a href="ch03s18s01.html" tabindex="1">Discovery of a NETCONF Device</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="user_guide.devicemanager.candidate.html" tabindex="1">Configuration Datastore Support</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.action_proxy.html" tabindex="1">Action Proxy</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.device_groups.html" tabindex="1">Device Groups</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.policies.html" tabindex="1">Policies</a></span></li>
                              <li><span class="file"><a href="user_guide.devicemanager.commit-queue.html" tabindex="1">Commit Queue</a></span><ul>
                                    <li><span class="file"><a href="ch03s23s01.html" tabindex="1">Commit Queue Scheduling</a></span></li>
                                    <li><span class="file"><a href="ch03s23s02.html" tabindex="1">Viewing and Manipulating the Commit Queue</a></span></li>
                                    <li><span class="file"><a href="ch03s23s03.html" tabindex="1">Commit Queue in a Cluster Environment</a></span></li>
                                    <li><span class="file"><a href="ch03s23s04.html" tabindex="1">Configuring Commit Queue in a Cluster Environment</a></span></li>
                                    <li id="webhelp-currentid"><span class="file"><a href="ch03s23s05.html" tabindex="1">Error Recovery with Commit Queue</a></span></li>
                                    <li><span class="file"><a href="ch03s23s06.html" tabindex="1">Commit Queue Tuning</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ch03s24.html" tabindex="1">NETCONF Call Home</a></span></li>
                              <li><span class="file"><a href="ch03s25.html" tabindex="1">Notifications</a></span><ul>
                                    <li><span class="file"><a href="ch03s25s01.html" tabindex="1">An Example Session</a></span></li>
                                    <li><span class="file"><a href="ch03s25s02.html" tabindex="1">Subscription Status</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ch03s26.html" tabindex="1">SNMP Notifications</a></span></li>
                              <li><span class="file"><a href="ch03s27.html" tabindex="1">Inactive configuration</a></span></li>
                           </ul>
                        </li>
                        <li><span class="file"><a href="ug.ssh_keys.html" tabindex="1">SSH Key Management</a></span><ul>
                              <li><span class="file"><a href="ug.ssh_keys.general.html" tabindex="1">General</a></span></li>
                              <li><span class="file"><a href="ug.ssh_keys.server.html" tabindex="1">NSO as SSH Server</a></span><ul>
                                    <li><span class="file"><a href="ch04s02s01.html" tabindex="1">Host Keys</a></span></li>
                                    <li><span class="file"><a href="ch04s02s02.html" tabindex="1">Publickey Authentication</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ug.ssh_keys.client.html" tabindex="1">NSO as SSH Client</a></span><ul>
                                    <li><span class="file"><a href="ug.ssh_keys.client.host_keys.html" tabindex="1">Host Key Verification</a></span><ul>
                                          <li><span class="file"><a href="ug.ssh_keys.client.host_keys.html#d0e6504" tabindex="1">Verification level</a></span></li>
                                          <li><span class="file"><a href="ug.ssh_keys.client.host_keys.html#d0e6556" tabindex="1">Connection to a Managed Device</a></span></li>
                                          <li><span class="file"><a href="ug.ssh_keys.client.host_keys.html#d0e6639" tabindex="1">Connection to an NSO Cluster Node</a></span></li>
                                       </ul>
                                    </li>
                                    <li><span class="file"><a href="ug.ssh_keys.client.publickey.html" tabindex="1">Publickey Authentication</a></span><ul>
                                          <li><span class="file"><a href="ug.ssh_keys.client.publickey.html#d0e6679" tabindex="1">Private Key Selection</a></span></li>
                                          <li><span class="file"><a href="ug.ssh_keys.client.publickey.html#d0e6698" tabindex="1">Connection to a Managed Device</a></span></li>
                                          <li><span class="file"><a href="ug.ssh_keys.client.publickey.html#d0e6759" tabindex="1">Connection to an NSO Cluster Node</a></span></li>
                                       </ul>
                                    </li>
                                 </ul>
                              </li>
                           </ul>
                        </li>
                        <li><span class="file"><a href="ch05.html" tabindex="1">Managing Network Services</a></span><ul>
                              <li><span class="file"><a href="ch05s01.html" tabindex="1">Overview</a></span></li>
                              <li><span class="file"><a href="ch05s02.html" tabindex="1">A Service Example</a></span></li>
                              <li><span class="file"><a href="ch05s03.html" tabindex="1">Running the example</a></span></li>
                              <li><span class="file"><a href="ch05s04.html" tabindex="1">Service-Life Cycle Management</a></span><ul>
                                    <li><span class="file"><a href="ch05s04s01.html" tabindex="1">Service Changes</a></span></li>
                                    <li><span class="file"><a href="ch05s04s02.html" tabindex="1">Service Impacting out-of-band changes</a></span></li>
                                    <li><span class="file"><a href="ch05s04s03.html" tabindex="1">Service Deletion</a></span></li>
                                    <li><span class="file"><a href="ch05s04s04.html" tabindex="1">Viewing service configurations</a></span></li>
                                    <li><span class="file"><a href="ch05s04s05.html" tabindex="1">Using Commit queues</a></span></li>
                                    <li><span class="file"><a href="ch05s04s06.html" tabindex="1">Un-deploying Services</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ch05s05.html" tabindex="1">Advanced Services Orchestration</a></span><ul>
                                    <li><span class="file"><a href="ch05s05s01.html" tabindex="1">RFM service plans</a></span></li>
                                    <li><span class="file"><a href="ch05s05s02.html" tabindex="1">Service progress monitoring</a></span></li>
                                 </ul>
                              </li>
                           </ul>
                        </li>
                        <li><span class="file"><a href="ug.alarmmgr.html" tabindex="1">The Alarm Manager</a></span><ul>
                              <li><span class="file"><a href="ug.alarmmgr.intro.html" tabindex="1">Alarm Manager Introduction</a></span></li>
                              <li><span class="file"><a href="ug.alarmmgr.alarms.html" tabindex="1">Overview of the alarm concepts</a></span></li>
                              <li><span class="file"><a href="ug.alarmmgr.model.html" tabindex="1">The Alarm Model</a></span></li>
                              <li><span class="file"><a href="ch06s04.html" tabindex="1">Alarm handling</a></span></li>
                           </ul>
                        </li>
                        <li><span class="file"><a href="ug.scripting_using.html" tabindex="1">Plug-and-play scripting</a></span><ul>
                              <li><span class="file"><a href="ch07s01.html" tabindex="1">Introduction</a></span></li>
                              <li><span class="file"><a href="ch07s02.html" tabindex="1">Script storage</a></span></li>
                              <li><span class="file"><a href="ch07s03.html" tabindex="1">Script interface</a></span></li>
                              <li><span class="file"><a href="ch07s04.html" tabindex="1">Loading of scripts</a></span></li>
                              <li><span class="file"><a href="ch07s05.html" tabindex="1">Command scripts</a></span><ul>
                                    <li><span class="file"><a href="ch07s05s01.html" tabindex="1">Command section</a></span></li>
                                    <li><span class="file"><a href="ch07s05s02.html" tabindex="1">Param section</a></span></li>
                                    <li><span class="file"><a href="ch07s05s03.html" tabindex="1">Full command example</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ch07s06.html" tabindex="1">Policy scripts</a></span><ul>
                                    <li><span class="file"><a href="ch07s06s01.html" tabindex="1">Policy section</a></span></li>
                                    <li><span class="file"><a href="ch07s06s02.html" tabindex="1">Validation</a></span></li>
                                    <li><span class="file"><a href="ch07s06s03.html" tabindex="1">Full policy example</a></span></li>
                                 </ul>
                              </li>
                              <li><span class="file"><a href="ch07s07.html" tabindex="1">Post-commit scripts</a></span><ul>
                                    <li><span class="file"><a href="ch07s07s01.html" tabindex="1">Post-commit section</a></span></li>
                                    <li><span class="file"><a href="ch07s07s02.html" tabindex="1">Full post-commit example</a></span></li>
                                 </ul>
                              </li>
                           </ul>
                        </li>
                        <li><span class="file"><a href="ug.ncs.complrep.html" tabindex="1">Compliance reporting</a></span><ul>
                              <li><span class="file"><a href="ch08s01.html" tabindex="1">Introduction</a></span></li>
                              <li><span class="file"><a href="ch08s02.html" tabindex="1">Creating compliance
                                           report definitions</a></span></li>
                              <li><span class="file"><a href="ch08s03.html" tabindex="1">Running compliance reports</a></span></li>
                           </ul>
                        </li>
                        <li><span class="file"><a href="ncsnwe.packages.html" tabindex="1">NSO Packages</a></span><ul>
                              <li><span class="file"><a href="ch09s01.html" tabindex="1">Overview</a></span></li>
                              <li><span class="file"><a href="ch09s02.html" tabindex="1">Listing Packages</a></span></li>
                           </ul>
                        </li>
                        <li><span class="file"><a href="ug.lifecycle.html" tabindex="1">
                                     Life-cycle Operations - how to manipulate existing services and
                                     devices
                                   </a></span><ul>
                              <li><span class="file"><a href="ch10s01.html" tabindex="1">
                                             Commit flags and device &amp; service actions
                                           </a></span></li>
                              <li><span class="file"><a href="ch10s02.html" tabindex="1">Commit Flags</a></span></li>
                              <li><span class="file"><a href="ch10s03.html" tabindex="1">Device Actions</a></span></li>
                              <li><span class="file"><a href="ch10s04.html" tabindex="1">Service Actions</a></span></li>
                           </ul>
                        </li>
                        <li><span class="file"><a href="ncsnwe.webui.html" tabindex="1">The Web User Interface</a></span><ul>
                              <li><span class="file"><a href="ch11s01.html" tabindex="1">Overview</a></span></li>
                              <li><span class="file"><a href="ch11s02.html" tabindex="1">Using the Web UI</a></span></li>
                              <li><span class="file"><a href="ch11s03.html" tabindex="1">Transactions and Commit</a></span></li>
                           </ul>
                        </li>
                        <li><span class="file"><a href="ug.netsim.html" tabindex="1">The Network Simulator</a></span><ul>
                              <li><span class="file"><a href="ug.netsim.overview.html" tabindex="1">Overview</a></span></li>
                              <li><span class="file"><a href="ug.netsim.using.html" tabindex="1">Using Netsim</a></span></li>
                              <li><span class="file"><a href="ug.netsim.using_confd_tools.html" tabindex="1">Using ConfD Tools with Netsim</a></span></li>
                              <li><span class="file"><a href="ug.netsim.learnmore.html" tabindex="1">Learn more</a></span></li>
                           </ul>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </body>
</html>